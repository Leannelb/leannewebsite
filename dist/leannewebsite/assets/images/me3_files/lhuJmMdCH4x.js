if (self.CavalryLogger) { CavalryLogger.start_js(["Mk638"]); }

__d("ChatAnimatedGifs",["URI"],(function(a,b,c,d,e,f){__p&&__p();var g={shouldHideBody:function(a){__p&&__p();if(!a.has_attachment)return!1;for(var b=0;b<a.attachments.length;b++){var c=a.attachments[b];if(c.preview_url){c=g.getRawUrlFromSafeUrl(c.preview_url);if(a.body==c)return!0}}return!1},getRawUrlFromSafeUrl:function(a){return new(b("URI"))(a).getQueryData().url}};e.exports=g}),null);
__d("ChatBubble.react",["cx","BootloadedComponent.react","DOMDimensions","EmojiOnlyMessage.react","ErrorBoundary.react","JSResource","MercuryConfig","MercuryMessageBody.react","MercuryMessageRenderLocations","MessageReplyPermissions","MessengerMathUtils","MessengerSupportedEmojiUtils","React","ReactDOM","joinClasses","messengerCustomColorUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;var h=2;c=b("React").createClass({displayName:"ChatBubble",_boxWidth:0,_repliedToMessageRef:null,propTypes:{attachments:a.node,body:a.string,className:a.string,customColor:a.string,customLike:a.object,isEmojiLike:a.bool,isFromViewer:a.bool,maxWidth:a.number.isRequired,message:a.object,metaRanges:a.array,onReplyToMessage:a.func,ranges:a.array,threadCustomColor:a.string,threadID:a.string},getInitialState:function(){return{emojis:undefined,bubbleWidth:null}},componentDidMount:function(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var a=this.props.body||"";a=b("MessengerSupportedEmojiUtils").getEmojiOnlyContents(a);a&&a.length&&this.setState({emojis:a})}this._restyleBubble(this.props)},componentDidUpdate:function(a){(a.maxWidth!==this.props.maxWidth||a.body!==this.props.body||!a.attachments&&this.props.attachments)&&this._restyleBubble(a)},render:function(){__p&&__p();var a=this.props,c=a.attachments,d=a.body;d=d===void 0?"":d;var e=a.className,f=a.maxWidth;a=babelHelpers.objectWithoutProperties(a,["attachments","body","className","maxWidth"]);a=Object.assign({},a);delete a.customColor;delete a.customLike;delete a.isEmojiLike;delete a.isFromViewer;delete a.message;delete a.metaRanges;delete a.ranges;delete a.threadCustomColor;delete a.threadID;return b("React").createElement("div",babelHelpers["extends"]({},a,{className:b("joinClasses")("_5w1r"+(this.state.emojis?"":" _3_om")+(this.state.emojis?" _31xx":"")+(((a=this.props)==null?void 0:(a=a.message)==null?void 0:(a=a.replied_to_message)==null?void 0:(a=a.message)==null?void 0:a.body)&&!b("MercuryConfig").SM3BD?" _1vmy":""),e),ref:"bubble",style:{maxWidth:f,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:d.length>=15?"break-word":"inherit"}}),b("React").createElement("div",{className:"_4gx_",ref:"inner"},this._renderContent(),c))},_renderContent:function(){if(!this.props.body||this.props.isEmojiLike)return null;var a={},c=null;this.state.emojis?c=b("React").createElement(b("EmojiOnlyMessage.react"),{contents:this.state.emojis}):(c=b("React").createElement(b("MercuryMessageBody.react"),{body:this.props.body,ranges:this.props.ranges,metaRanges:this.props.metaRanges,threadID:this.props.threadID,customLike:this.props.customLike,threadCustomColor:this.props.threadCustomColor,isFromViewer:this.props.isFromViewer,renderLocation:b("MercuryMessageRenderLocations").CHAT}),this.props.customColor&&(a=b("messengerCustomColorUtils").customBubbleStyle(this.props.customColor,a)));var d=this.props.message&&this.props.message.replied_to_message&&b("MessageReplyPermissions").bubbleContainsRepliedToMessage(this.props.message.replied_to_message,!!this.state.emojis)?b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("RepliedToMessageContent.react").__setRef("ChatBubble.react"),bootloadPlaceholder:b("React").createElement("div",null),isFromViewer:this.props.isFromViewer,isLinkified:!0,isMessengerUI:!1,repliedToMessageData:this.props.message&&this.props.message.replied_to_message,threadID:this.props.threadID,ref:this._setRepliedToMessageRef,replyInOneBubble:!0})):null;return b("React").createElement("div",{className:"_1aa6"+(this.state.emojis?" _31xy":"")+(this.props.message&&this.props.message.isSelected?" _1yok":"")+(d?" _6e7o":""),ref:"contentWrapper",style:a},d,d?"\n":null,b("React").createElement("span",{className:"_5yl5",ref:"content"},c))},_restyleBubble:function(a){__p&&__p();if(this.props.attachments||this.props.body!=null&&b("MessengerMathUtils").isMathBlock(this.props.body.trim())){this.setState({bubbleWidth:null});return}var c=b("ReactDOM").findDOMNode(this.refs.bubble);if(a.maxWidth!==this.props.maxWidth||b("DOMDimensions").getElementDimensions(c).width>this.props.maxWidth){a=this.props.maxWidth;this.setState({bubbleWidth:a},this._shrinkBubble);return}this._shrinkBubble()},_shrinkBubble:function(){__p&&__p();var a=b("ReactDOM").findDOMNode(this.refs.bubble);if(!a)return;a=b("DOMDimensions").getElementDimensions(a).width;var c=b("ReactDOM").findDOMNode(this.refs.content),d=b("DOMDimensions").getElementDimensions(c).width;if(this._repliedToMessageRef){var e=b("ReactDOM").findDOMNode(this._repliedToMessageRef);e=b("DOMDimensions").getElementDimensions(e).width;d=Math.max(e,d)}e=c?d+b("DOMDimensions").measureElementBox(b("ReactDOM").findDOMNode(this.refs.contentWrapper),"width",!0,!1,!1):0;c=e+h;d>0&&c<this.props.maxWidth&&a-c-this.getBoxWidth()>0&&this.setState({bubbleWidth:c})},contentWraps:function(){var a=b("ReactDOM").findDOMNode(this.refs.content);if(!a)return!1;var c=a.getClientRects();a=b("DOMDimensions").getElementDimensions(a).height;return c&&c.length>1&&c[0].height<a},_setRepliedToMessageRef:function(a){this._repliedToMessageRef=a},getBoxWidth:function(){this._boxWidth||(this._boxWidth=b("DOMDimensions").measureElementBox(b("ReactDOM").findDOMNode(this.refs.bubble),"width",!0,!0,!1));return this._boxWidth}});e.exports=c}),null);
__d("ChatCodePasteUtils",["cx","BanzaiODS","ChatBubble.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=/`{3,}/,i=3,j=/^\s+/,k=/\s+$/;function a(a){return!!(a&&a.search(h)!==-1&&a.split("\n").length>1)}function l(a,b){__p&&__p();var c=0;if(b-2>=0){c+=a[b-2].trim().length;var d=a[b-2].match(k);d&&(c+=d[0].length)}b-1>=0&&(c+=a[b-1].length+2*i);d=a[b].match(j);d&&(c+=d[0].length);return c}function m(a,b,c){if(a)return a.map(function(a){return Object.assign(Object.assign({},a),{offset:a.offset-b})}).filter(function(a){return 0<=a.offset&&a.offset<c});else return a}function c(a,c,d,e,f){__p&&__p();a=a.split(h);var g=[],i=0;for(var j=0;j<a.length;j+=2){var k=a[j].trim();if(k&&k.length>0){i+=l(a,j);var n=d?m(d,i,k.length):d;g.push(b("React").createElement("div",{key:j,className:"_1e-x _n4o"},b("React").createElement(b("ChatBubble.react"),{body:k,customColor:f||undefined,className:"clearfix _5wdf",maxWidth:c,ranges:n||undefined,threadID:e||undefined})))}if(j+1<a.length&&a[j+1]){k=a[j+1].split("\n");n=k[0].replace(/[^a-zA-Z]+/g,"");k=k.slice(1).join("\n");b("BanzaiODS").bumpEntityKey("chat_code_paste","render_bubble");g.push(b("React").createElement("div",{key:j+1,className:"_1e-x _n4o"},b("React").createElement("div",{ref:"bubble",className:"_3_om _4yng _5wdf"},b("React").createElement("div",{style:{maxWidth:c},ref:"syntaxTarget"+j,className:"language-"+n},k))))}}return g}e.exports={containsCodeBlock:a,getCodeAndMessageBubbles:c}}),null);
__d("ChatTabBlinking",["cx","CSS","FantaTabActions","clearInterval","gkx","setIntervalAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?1200:600,i="highlightTitle";a={_blinkMap:{},_interval:null,_isHighlighting:!1,blinkTab:function(a,b){this._blinkMap[a]||(this._blinkMap[a]={view:b,elem:b.getTabElem()}),this.checkInterval()},unblinkTab:function(a){if(this._blinkMap[a]){var c=this._blinkMap[a].elem;c&&(b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?setTimeout(function(){b("FantaTabActions").unhighlightNewMessage(a)}):b("CSS").removeClass(c,i));delete this._blinkMap[a]}this.checkInterval()},checkInterval:function(){var a=Object.keys(this._blinkMap).length;a>0?this._interval||(this._interval=b("setIntervalAcrossTransitions")(this._toggleBlinkHighlight.bind(this),h)):this._interval&&(b("clearInterval")(this._interval),this._interval=null)},_toggleBlinkHighlight:function(){__p&&__p();var a=this;this._isHighlighting=!this._isHighlighting;var c=function(c){if(Object.prototype.hasOwnProperty.call(a._blinkMap,c)){var d=a._blinkMap[c],e=d.elem;d=d.view;e&&e.parentNode&&!d.isFocused()&&!d.isHovered()?b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?a._isHighlighting?setTimeout(function(){b("FantaTabActions").highlightNewMessage(c)}):setTimeout(function(){b("FantaTabActions").unhighlightNewMessage(c)}):b("CSS").conditionClass(e,i,a._isHighlighting):a.unblinkTab(c)}};for(var d in this._blinkMap)c(d)}};e.exports=a}),null);
__d("ChatCloseButton.react",["cx","fbt","Link.react","React","TrackingNodes","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.CLOSE_BUTTON),c=h._("Press Esc to close"),d=h._("Close tab"),e="_4vu4";return b("React").createElement(b("Link.react"),{"aria-label":this.props.active?c:d,className:b("joinClasses")(this.props.className,"close","button",e),"data-ft":a,"data-hover":"tooltip","data-tooltip-content":this.props.active?c:d,"data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown})};function a(){i.apply(this,arguments)}a.propTypes={onClick:c.func,onKeyUp:c.func,onMouseDown:c.func,active:c.bool};a.defaultProps={active:!1};e.exports=a}),null);
__d("ChatCollapsedLogMessageGroup.react",["cx","fbt","Link.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={collapsed:!0},b}a.prototype.render=function(){var a=h._("See latest activity"),c=h._("See less activity");return b("React").createElement("div",{className:"_5w0o"},b("React").createElement(b("Link.react"),{className:"_4ea1",onClick:function(){return this.setState({collapsed:!this.state.collapsed})}.bind(this)},this.state.collapsed?a:c),this.state.collapsed?null:b("React").createElement("div",null,b("React").createElement("div",{className:"_2zsu"}),this.props.children,b("React").createElement("div",{className:"_2zsu"})))};e.exports=a}),null);
__d("ChatDateBreak.react",["cx","React","formatDate","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){"use strict";return this.props.date.getTime()!==a.date.getTime()};a.prototype.render=function(){"use strict";var a=b("formatDate")(this.props.date,{today:"g:ia",withinWeek:"D g:ia",thisYear:"M jS, g:ia",older:"m/d/Y g:ia"});return b("React").createElement("time",{className:b("joinClasses")(this.props.className,"_5w-5")},b("React").createElement("span",{className:"_5w-6"},a))};function a(){"use strict";h.apply(this,arguments)}a.propTypes={date:c.instanceOf(Date).isRequired};e.exports=a}),null);
__d("ChatMessage.react",["csx","cx","fbt","BootloadedComponent.react","ChatAnimatedGifs","ChatBubble.react","ChatCodePasteUtils","CSS","EmojiLikeUtils","FluxContainer","ImmutableObject","JSResource","Locale","MercuryAttachment","MercuryDisplayTimeFilterMessageRenderer","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercuryTimestamp","MessengerDecorator","MessengerInnerDecorators.react","MessengerMessage.bs","MessengerVideoAutoplayStore","MNCommerceMessageType","React","ReactDOM","TooltipData","XUISpinner.react","convertMIGColorToFIGColor","immutable","isRTL","joinClasses","setImmediate"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.state={isVisible:!1,isHighlighted:!1},this.$2=function(){return this.setState({hovered:!0})}.bind(this),this.$3=function(){return this.setState({hovered:!1})}.bind(this),b}a.getStores=function(){return[b("MessengerVideoAutoplayStore")]};a.calculateState=function(a,c){return{isVisible:b("MessengerVideoAutoplayStore").isVisible(c.message.thread_id,c.message.message_id)}};a.prototype.componentDidMount=function(){b("CSS").conditionClass(b("ReactDOM").findDOMNode(this),"_2cnu",this.isOneLine())};a.prototype.isOneLine=function(){var a=this.props.message;return b("MessengerMessage.bs").isInbound(a)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps()};a.prototype.shouldComponentUpdate=function(a,b){var c=a.message!==this.props.message,d=!1,e=!1,f=this.props.thread;if(f)d=f.custom_like_icon!==a.thread.custom_like_icon,e=f.solid_color!==a.thread.solid_color;else if(a.thread)return!0;return c||d||e||b.isVisible!==this.state.isVisible||b.isHighlighted!==this.state.isHighlighted};a.prototype.render=function(){__p&&__p();var a=this.props.message,c=b("MercuryAttachment").get(a).length>0,d=b("MessengerMessage.bs").isInbound(a),e=b("MercuryIDs").isGroupChat(a.thread_id),f=b("MercuryErrorInfo").hasErrorStatus(a);c="_5wd4"+(d?" _1nc7":"")+(d?"":" _1nc6")+(c?" _2_-t":"")+(d&&e?" _5ysy":"")+(f?" _1zcs":"")+(this.state.isHighlighted?" _6iuj":"");var g=this.props.isFromViewer,h=[],i=a,j=this.props.thread?b("convertMIGColorToFIGColor")(this.props.thread.solid_color):"";i&&b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(i)&&h.push(a.render(i,g,{customColor:j}))});d=b("MercuryAttachment").get(a).filter(function(a){return!b("MercuryAttachment").isBubblePreferred(a)});e=this.$1("outside",d);return b("React").createElement("div",{className:b("joinClasses")(this.props.className,c),onMouseEnter:this.$2,onMouseLeave:this.$3},b("React").createElement("div",{className:b("joinClasses")("._1dlq","_h8t")},h,this.$4(e)),d.some(function(a){return b("MercuryAttachment").isShareAttachment(a)})?b("React").createElement(b("MessengerInnerDecorators.react"),{message:a,isFromViewer:g||!1,hovered:this.state.hovered,messageProps:this.props,forGameChat:this.props.forGameChat}):b("React").createElement("div",{className:"_40qi"}),this.$5())};a.prototype.$4=function(a){var c=this.props.message,d={},e=b("MessengerMessage.bs").isOutbound(c);if(e||this.props.needsTimestampTooltip){var f=i._("{time}",[i._param("time",b("MercuryTimestamp").getPreciseTimestamp(c.timestamp))]);Object.assign(d,b("TooltipData").propsFor(f,e?"right":"left"))}if(c.is_filtered_content)return b("React").createElement("div",babelHelpers["extends"]({className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:"inner"},d),b("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(c));f=c.body&&c.body!==""?b("isRTL")(c.body):b("Locale").isRTL();return b("React").createElement("div",babelHelpers["extends"]({className:"_5wd9"+(f?" direction_rtl":"")+(f?"":" direction_ltr")+" clearfix",ref:"inner"},d),this.$6(!a),a)};a.prototype.$5=function(){var a=this.props.message;return a.is_filtered_content||!b("MessengerMessage.bs").hasError(a)?null:b("React").createElement("div",{className:"_3ry4",ref:"undertext"},b("React").createElement(b("MercuryMessageError.react"),{className:"_5wda clearfix",message:a,ref:"status"}),this.$7())};a.prototype.$7=function(){return this.props.message.is_spoof_warning?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("MercurySpoofWarning.react").__setRef("ChatMessage.react"),authorID:this.props.message.author,className:"_5wdb"}):null};a.prototype.$8=function(){return b("React").createElement("div",{style:{padding:"20px",text_align:"center",background:"white"}},b("React").createElement(b("XUISpinner.react"),null))};a.prototype.$1=function(a,c){__p&&__p();if(this.props.message.commerce_message_type===b("MNCommerceMessageType").RIDE_INTENT)return null;var d=this.props.message,e=this.props.thread?this.props.thread.custom_like_icon:null,f=a=="inside"?"attachmentsInside":"attachmentsOutside",g=this.props.thread?b("convertMIGColorToFIGColor")(this.props.thread.solid_color):"",h=[],i=[];a==="outside"&&d&&b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(d,this.props.isFromViewer)&&(h.push(a.render(d,this.props.isFromViewer,this.props,this.state.hovered)),i.push(a.getAdditionalClassNames()))}.bind(this));if(c.length>0){var j=b("React").createElement(b("MessengerInnerDecorators.react"),{className:"_1z_2",message:d,isFromViewer:this.props.isFromViewer||!1,hovered:this.state.hovered,messageProps:this.props,forGameChat:this.props.forGameChat});return b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:this.$8(),bootloadLoader:b("JSResource")("MercuryAttachments.react").__setRef("ChatMessage.react"),className:b("joinClasses")((a==="outside"?"_3e7u":"")+(d.body?" _16ys":"")+(g?" _3al":"")+" _n4o"+(h?" _1a6y":""),i),attachments:c,customLike:e,customColor:g,forGameChat:this.props.forGameChat,isChat:!0,afterDecorators:h,innerDecorators:j,isVisible:this.state.isVisible,maxWidth:this.props.maxBubbleWidth,message:d,onUnwrap:this.$9,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:f})}return null};a.prototype.$6=function(a){__p&&__p();var c=this.props,d=c.isFromViewer,e=c.message;c=c.thread;var f=e.body,g=b("MercuryAttachment").get(e).filter(function(a){return b("MercuryAttachment").isBubblePreferred(a)});g=this.$1("inside",g);var h=[],i=[],j=e;j&&(a&&b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(j,d)&&(h.push(a.render(j,d,this.props)),i.push(a.getAdditionalClassNames()))}.bind(this)),b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(j,d)&&i.push(a.getAdditionalClassNames())}));var k=i.join(" ");b("ChatAnimatedGifs").shouldHideBody(e)&&(f="");var l=e.ranges;e.profile_ranges&&e.profile_ranges.length&&(l=(l||[]).concat(e.profile_ranges.map(function(a){return babelHelpers["extends"]({},a,{url:"/"+a.id})})));var m=b("ChatCodePasteUtils").containsCodeBlock(f);return(f||g)&&!b("EmojiLikeUtils").isEmojiLike(e)?b("React").createElement("div",{className:b("joinClasses")(k,"_1e-x _n4o")},m?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",{style:{height:22}}),bootloadLoader:b("JSResource")("ChatCodeBubble.react").__setRef("ChatMessage.react"),body:f,maxWidth:this.props.maxBubbleWidth,ranges:l,threadID:e.thread_id,customColor:c&&d?b("convertMIGColorToFIGColor")(c.solid_color):""}):b("React").createElement("div",{className:"_3_bl"},b("React").createElement("div",{className:"_3_bp"}),b("React").createElement(b("ChatBubble.react"),{attachments:g,body:f,className:"_5wdf",isEmojiLike:!1,isFromViewer:this.props.isFromViewer,onReplyToMessage:this.props.onReplyToMessage,metaRanges:e.meta_ranges,message:e,maxWidth:this.props.maxBubbleWidth,ranges:l,ref:"bubble",threadID:e.thread_id,customLike:e.customLike,customColor:c&&d?b("convertMIGColorToFIGColor")(c.solid_color):"",threadCustomColor:c&&b("convertMIGColorToFIGColor")(c.solid_color)})),a?b("React").createElement(b("MessengerInnerDecorators.react"),{className:"_1z_2",message:e,isFromViewer:this.props.isFromViewer||!1,hovered:this.state.hovered,messageProps:this.props,forGameChat:this.props.forGameChat}):null,h):null};a.prototype.highlightMessage=function(){this.setState({isHighlighted:!1}),b("setImmediate")(function(){return this.setState({isHighlighted:!0})}.bind(this))};a.propTypes={forGameChat:c.bool.isRequired,message:c.object.isRequired,maxBubbleWidth:c.number.isRequired,onAttachmentLoad:c.func,onStickerClick:c.func,participants:c.instanceOf(b("immutable").Map).isRequired,readReceipts:c.instanceOf(b("immutable").OrderedMap).isRequired,thread:c.instanceOf(b("ImmutableObject")),needsTimestampTooltip:c.bool};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("ChatMessageGroup.react",["cx","fbt","ChatDateBreak.react","ChatMessage.react","CurrentUser","Image.react","ImmutableObject","MercuryConfig","MercuryIDs","MercuryTimestamp","MessengerParticipants.bs","MessengerTextWithEmoticons.react","QE2Logger","React","ReactDOM","WorkForeignEntityType","gkx","immutable"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("immutable").OrderedMap;c=b("React").PropTypes;var i=new(b("ImmutableObject"))({name:"",href:"#",image_src:""});d=b("React").createClass({displayName:"ChatMessageGroup",propTypes:{activeMessageID:c.string,author:c.string,forGameChat:c.bool,hasDateBreak:c.bool,isCanonical:c.bool,isFromViewer:c.bool,isPageMessage:c.bool,isOnline:c.bool,maxBubbleWidth:c.number,messages:c.instanceOf(b("immutable").List).isRequired,readReceipts:c.instanceOf(a).isRequired,onAttachmentLoad:c.func,onStickerClick:c.func,persona:c.object,thread:c.instanceOf(b("ImmutableObject")),threadID:c.string},getInitialState:function(){return{participants:{}}},componentDidMount:function(){b("QE2Logger").logExposureForUser("messenger_growth_tombstone"),this._subscription=this._computeParticipants()},shouldComponentUpdate:function(a,c){return this.props.isOnline!==a.isOnline||this.props.activeMessageID!==a.activeMessageID||this.props.isFromViewer!==a.isFromViewer||!b("immutable").is(this.props.messages,a.messages)||this.state.participants!==c.participants||!b("immutable").is(this.props.thread,a.thread)},componentDidUpdate:function(a){a=j(this.props);!this._subscription&&!a.every(function(a){return this.state.participants[a]}.bind(this))&&(this._subscription=this._computeParticipants())},componentWillUnmount:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription)},render:function(){return b("React").createElement("div",{className:"_4tdt"+(this.props.isFromViewer?" _ua0":"")+(this.props.isFromViewer?"":" _ua1")+(this._hasSeenHeadsAtBottom()?" _3lil":"")},this._renderProfileColumn(),b("React").createElement("div",{className:"_ua2"},this._renderName(),b("React").createElement("div",{className:"_4tdv"},this._renderMessages())))},_needsProfileColumn:function(){if(!b("gkx")("AT4vZBWyiZL1KZrir2lJt4vVNMIYu8sDbA3PtNwJWZh5seJSYZeYdmCgqH3wgiUS4PfslnEPm3wz9jSsjDINBCSy"))return!0;if(!this.props.isCanonical)return!0;if(this.props.persona)return!0;var a=this.state.participants[this.props.author];return a&&a.type==="page"?!0:!1},_renderProfileColumn:function(){__p&&__p();var a;if(this.props.isFromViewer||!this._needsProfileColumn())return null;var c=this.state.participants[this.props.author]||i,d=c.name,e=c.image_src;this.props.persona&&(d=this.props.persona.name,e=this.props.persona.profile_picture_url);d=h._("{name} {time}",[h._param("name",d),h._param("time",b("MercuryTimestamp").getPreciseTimestamp(this.props.messages.last().timestamp))]);e=e?b("React").createElement(b("Image.react"),{src:e}):null;var f=b("MercuryConfig").GDWC&&this.props.isOnline;a=b("CurrentUser").isWorkUser()&&((a=c)!=null?(a=a.work_foreign_entity_info)!=null?a.type:a:a)===b("WorkForeignEntityType").FOREIGN;return b("React").createElement("div",{className:"_31o4 _3njy"},b("React").createElement("a",{"aria-label":d,className:"_4tdw","data-hover":"tooltip","data-tooltip-content":d,"data-tooltip-position":"left",href:this.props.persona?null:c.href,ref:"link"},e),a?b("React").createElement("div",{className:"_4rwx _4rwy"}):f?b("React").createElement("div",{className:"_sce"}):null)},_renderName:function(){__p&&__p();if(this.props.isCanonical&&!this.props.persona||this.props.isFromViewer)return null;var a=this.state.participants[this.props.messages.first().author];if(!a)return null;if(this.props.messages.first().replied_to_message)return null;var c=a.short_name;if(this.props.thread&&this.props.thread.custom_nickname){a=b("MercuryIDs").getUserIDFromParticipantID(a.id);this.props.thread.custom_nickname[a]&&(c=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:this.props.thread.custom_nickname[a]}))}if(this.props.persona){a=this.state.participants[this.props.messages.first().author];c=a?h._("{persona name} from {page name}",[h._param("persona name",this.props.persona.name),h._param("page name",a.short_name)]):this.props.persona.name}return b("React").createElement("div",{className:"_4tdx"},c)},_renderMessages:function(){var a=this.props.messages.size,c=[];this.props.messages.forEach(function(d,e,f){var g=d.message_id===this.props.activeMessageID;g&&!(e===0&&this.props.hasDateBreak)&&c.push(b("React").createElement(b("ChatDateBreak.react"),{date:new Date(d.timestamp),key:"db:"+d.message_id}));c.push(b("React").createElement(b("ChatMessage.react"),{forGameChat:!!this.props.forGameChat,isFromViewer:this.props.isFromViewer,key:d.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:d,participants:b("immutable").Map(this.state.participants),readReceipts:this.props.readReceipts,ref:d.message_id,nextTimestamp:this._getNextTimestamp(f,a,e),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,thread:this.props.thread,needsTimestampTooltip:!this._needsProfileColumn()}))}.bind(this));return c},_hasSeenHeadsAtBottom:function(){var a=this.props,b=a.messages,c=a.nextTimestamp;a=a.readReceipts;var d=b.last().timestamp,e=0;a.forEach(function(a){return a>=d&&a<c&&++e===2?!1:null});return e===2},_getNextTimestamp:function(a,b,c){return c<b-1?a.get(c+1).timestamp:this.props.nextTimestamp},getMessageElement:function(a){return b("ReactDOM").findDOMNode(this.refs[a])},getMessage:function(a){return this.refs[a]},_computeParticipants:function(){__p&&__p();var a=j(this.props),c={},d=[];a.forEach(function(a){var e=b("MessengerParticipants.bs").getNow(a);c[a]=e;e||d.push(a)});this.setState({participants:c});return d.length>0?b("MessengerParticipants.bs").getMulti(d,function(b){var a=this.state.participants;d.forEach(function(c){a[c]=b[c]});this._subscription=null;this.setState({participants:a})}.bind(this)):null}});function j(a){var b=[a.author];a.readReceipts.forEach(function(a,c){b.push(c)});return b}e.exports=d}),null);
__d("MercuryMessageRendererUtils",["cx","invariant","HovercardLink","MercuryViewer","MessengerTextWithEmoticons.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a={getLinkToParticipant:function(a,c){var d=a.fbid,e=b("HovercardLink").constructEndpoint({id:d});c=c&&c.custom_nickname&&c.custom_nickname[d];c&&(c=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:c}));d=c?c:a.name;return a.href?b("React").createElement("a",{className:"_5wzt",href:a.href,"data-hovercard":e},d):d},moveCurrentUserToFront:function(a){a===void 0&&(a=[]);a||h(0);var c=a.indexOf(b("MercuryViewer").getID());if(c>0){c=a.filter(function(a){return a!==b("MercuryViewer").getID()});return[b("MercuryViewer").getID()].concat(c)}return a}};e.exports=a}),null);
__d("MercuryLogMessageRenderer",["cx","fbt","invariant","ix","Bootloader","CSS","CurrentUser","Image.react","MercuryAttachmentViewer","MercuryLogMessageType","MercuryMessageRendererUtils","MercuryViewer","MessagingSourceEnum","MessengerAdminGroupUtils","MessengerLightweightActionUtils","MessengerParticipants.bs","MessengerState.bs","MessengerTextWithEmoticons.react","React","ReactDOM","TooltipLink.react","UserAgent","convertMIGColorToFIGColor"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();a={renderText:function(a,c,d,e){__p&&__p();c=c||b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),a.thread_id);if(b("MessengerLightweightActionUtils").isLWAMessage(a)){e(b("MessengerLightweightActionUtils").getCollapsedLWAText(a));return}switch(a.log_message_type){case b("MercuryLogMessageType").SUBSCRIBE:var f=a.author;a.log_message_data||i(0);var g=a.log_message_data.added_participants;g||i(0);f=g.length===1&&f===g[0];g=c&&b("MessengerAdminGroupUtils").isWorkGroupSyncedChat(c)&&b("MessengerAdminGroupUtils").isWorkSyncedChatThreadMemberSyncMessage(a);f||g?b("Bootloader").loadModules(["MercuryJoinableMessageRenderer"],function(b){b.renderText(a,c,e)},"MercuryLogMessageRenderer"):m(a,e);break;case b("MercuryLogMessageType").UNSUBSCRIBE:b("MessengerAdminGroupUtils").isJoinableThread(c)?b("MessengerAdminGroupUtils").isGroupChat(c)?A(a,e):s(a,e):r(a,e);break;case b("MercuryLogMessageType").THREAD_NAME:c&&b("MessengerAdminGroupUtils").isWorkGroupSyncedChat(c)&&b("MessengerAdminGroupUtils").isWorkSyncedChatThreadCreationMessage(a)?v(a,e):c&&b("MessengerAdminGroupUtils").isJoinableThread(c)?b("MessengerAdminGroupUtils").isGroupChat(c)?B(a,c,e):t(a,c,e):w(a,c,e);break;case b("MercuryLogMessageType").THREAD_IMAGE:c&&b("MessengerAdminGroupUtils").isJoinableThread(c)?b("MessengerAdminGroupUtils").isGroupChat(c)?C(a,c,e):x(a,c,e):y(a,c,e);break;case b("MercuryLogMessageType").WALLPAPER:z(a,e);break;case b("MercuryLogMessageType").GENERIC_ADMIN_TEXT:var h=b("convertMIGColorToFIGColor")(c&&c.solid_color);b("Bootloader").loadModules(["MercuryXMATRenderer"],function(b){e(b.renderText(h,a,d))},"MercuryLogMessageRenderer");break;default:b("Bootloader").loadModules(["MercurySpecialLogMessageRenderer"],function(b){b.renderText(a,e)},"MercuryLogMessageRenderer");break}},renderIcon:function(a){return b("React").createElement(b("Image.react"),{className:k(a.log_message_type,a.log_message_data),src:j("99239")})},renderLegacy:function(a,c,d,e){k(e.log_message_type,e.log_message_data).split(" ").forEach(function(c){return c&&b("CSS").addClass(a,c)}),this.renderText(e,null,!1,function(a){b("ReactDOM").render(b("React").createElement("span",null,a),c)}),this.renderAttachmentLegacy(d,e)},renderAttachmentLegacy:function(a,c){if(c.log_message_type===b("MercuryLogMessageType").THREAD_IMAGE){c.log_message_data||i(0);var d=c.log_message_data.image;d&&d.preview_url&&(b("ReactDOM").render(b("React").createElement(b("Image.react"),{className:"_z6a",onClick:function(){return l(d)},src:d.preview_url}),a),b("CSS").show(a))}}};e.exports=a;function k(a,c){c=!!(c&&c.answered);return"_5wzu"+(a===b("MercuryLogMessageType").SUBSCRIBE?" _5wzj":"")+(a===b("MercuryLogMessageType").UNSUBSCRIBE?" _5wzk":"")+(a===b("MercuryLogMessageType").THREAD_NAME?" _5wzl":"")+(a===b("MercuryLogMessageType").THREAD_IMAGE?" _5wzm":"")+(a===b("MercuryLogMessageType").VIDEO_CALL&&c?" _5wzn":"")+(a===b("MercuryLogMessageType").VIDEO_CALL&&!c?" _5wzo":"")+(a===b("MercuryLogMessageType").PHONE_CALL&&c?" _5wzp":"")+(a===b("MercuryLogMessageType").PHONE_CALL&&!c?" _5wzq":"")+(a===b("MercuryLogMessageType").SERVER_ERROR?" _5wzr":"")+(a?"":" _2r5l")}function l(a){b("MercuryAttachmentViewer").bootstrapWithConfig({src:a.preview_url,endpoint:a.url,fbid:a.metadata.fbid,dimensions:a.metadata.dimensions,disablePaging:!0},null)}function m(a,c){__p&&__p();a.log_message_data||i(0);var d=b("MercuryMessageRendererUtils").moveCurrentUserToFront(a.log_message_data.added_participants);d||i(0);switch(d.length){case 1:n(a,c,d);break;case 2:o(a,c,d);break;case 3:p(a,c,d);break;default:q(a,c,d);break}}function n(a,c,d){var e=[a.author,d[0]];b("MessengerParticipants.bs").getMulti(e,function(e){a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]]))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author]))])):c(h._("{actor} added {subscriber1}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]]))]))})}function o(a,c,d){var e=[a.author].concat(d);b("MessengerParticipants.bs").getMulti(e,function(e){a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1} and {subscriber2}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]]))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you and {subscriber2}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]]))])):c(h._("{actor} added {subscriber1} and {subscriber2}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]]))]))})}function p(a,c,d){var e=[a.author].concat(d);b("MessengerParticipants.bs").getMulti(e,function(e){a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1}, {subscriber2} and {subscriber3}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]])),h._param("subscriber3",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[2]]))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you, {subscriber2} and {subscriber3}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]])),h._param("subscriber3",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[2]]))])):c(h._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[0]])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[1]])),h._param("subscriber3",b("MercuryMessageRendererUtils").getLinkToParticipant(e[d[2]]))]))})}function q(a,c,d){var e=[a.author].concat(d);b("MessengerParticipants.bs").getMulti(e,function(e){function f(a){var c=b("React").createElement("div",null,a.map(function(a){return b("React").createElement("div",null,a.name)}));return b("React").createElement(b("TooltipLink.react"),{alignH:"center",position:"above",tooltip:c},h._({"*":"{num} more"},[h._param("num",a.length,[0])]))}var g=d.map(function(a){return e[a]});a.author===b("MercuryViewer").getID()?c(h._("You added {subscriber1}, {subscriber2} and {more_people}.",[h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(g[0])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(g[1])),h._param("more_people",f(g.slice(2)))])):d[0]===b("MercuryViewer").getID()?c(h._("{actor} added you, {subscriber2} and {more_people}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(g[1])),h._param("more_people",f(g.slice(2)))])):c(h._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e[a.author])),h._param("subscriber1",b("MercuryMessageRendererUtils").getLinkToParticipant(g[0])),h._param("subscriber2",b("MercuryMessageRendererUtils").getLinkToParticipant(g[1])),h._param("more_people",f(g.slice(2)))]))})}function r(a,c){__p&&__p();var d=[a.author];a.log_message_data||i(0);var e=a.log_message_data.removed_participants;e||i(0);var f;e.length===1&&(f=e[0],d.push(f));b("MessengerParticipants.bs").getMulti(d,function(d){var e=d[a.author];d=d[f];a.author===b("MercuryViewer").getID()?!f||f===a.author?c(h._("You left the conversation.")):c(h._("You removed {name} from the conversation.",[h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))])):!f||f===a.author?c(h._("{actor} left the conversation.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):f===b("MercuryViewer").getID()?c(h._("{actor} removed you from the conversation.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):c(h._("{actor} removed {name} from the conversation.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e)),h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))]))})}function s(a,c){__p&&__p();var d=[a.author];a.log_message_data||i(0);var e=a.log_message_data.removed_participants;e||i(0);var f;e.length===1&&(f=e[0],d.push(f));b("MessengerParticipants.bs").getMulti(d,function(d){var e=d[a.author];d=d[f];a.author===b("MercuryViewer").getID()?!f||f===a.author?c(h._("You left the room.")):c(h._("You removed {name} from the room.",[h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))])):!f||f===a.author?c(h._("{actor} left the room.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):f===b("MercuryViewer").getID()?c(h._("{actor} removed you from the room.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):c(h._("{actor} removed {name} from the room.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e)),h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))]))})}function t(a,c,d){__p&&__p();a.log_message_data||i(0);var e=a.log_message_data.name,f="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(a.author===b("MercuryViewer").getID())if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("You named the room: {name}.",[h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("You removed the room name."));else b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("{actor} named the room: {name}.",[h._param("actor",a),h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("{actor} removed the room name.",[h._param("actor",a)]))})}function u(a,c,d,e,f){a.author===b("MercuryViewer").getID()?f(h._("You named the group {thread_name}. Your group is also on Facebook.",[h._param("thread_name",b("React").createElement("span",{className:e},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:d})))])):b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);f(h._("{actor} named the group {thread_name}. Your group is also on Facebook.",[h._param("actor",a),h._param("thread_name",b("React").createElement("span",{className:e},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:d})))]))})}function v(a,c){a.log_message_data||i(0);a=a.log_message_data.name;var d="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(a){c(h._("You can now chat to {name} on Workplace Chat.",[h._param("name",b("React").createElement("span",{className:d},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:a})))]));return}}function w(a,c,d){__p&&__p();a.log_message_data||i(0);var e=a.log_message_data.name,f="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(e&&a.tags&&a.tags.indexOf(b("MessagingSourceEnum").EVENT_UPCOMING_BUMP)!==-1)d(h._("The group has been named {name}.",[h._param("name",b("React").createElement("span",{className:f},b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e})))]));else if(e&&a.tags&&a.tags.indexOf(b("MessagingSourceEnum").GROUPSYNC_NAMING)!==-1)u(a,c,e,f,d);else if(a.author===b("MercuryViewer").getID())if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("You named the conversation: {name}.",[h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("You removed the conversation name."));else b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("{actor} named the conversation: {name}.",[h._param("actor",a),h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("{actor} removed the conversation name.",[h._param("actor",a)]))})}function x(a,c,d){a.author===b("MercuryViewer").getID()?(a.log_message_data||i(0),a.log_message_data.image?d(h._("You changed the room picture.")):d(h._("You removed the room picture."))):b("MessengerParticipants.bs").get(a.author,function(e){e=b("MercuryMessageRendererUtils").getLinkToParticipant(e,c);a.log_message_data||i(0);a.log_message_data.image?d(h._("{actor} changed the room picture.",[h._param("actor",e)])):d(h._("{actor} removed the room picture.",[h._param("actor",e)]))})}function y(a,c,d){a.tags!==undefined&&a.tags.indexOf(b("MessagingSourceEnum").EVENT_UPCOMING_BUMP)!==-1?d(h._("The conversation picture has been set.")):a.author===b("MercuryViewer").getID()?(a.log_message_data||i(0),a.log_message_data.image?d(h._("You changed the conversation picture.")):d(h._("You removed the conversation picture."))):b("MessengerParticipants.bs").get(a.author,function(e){e=b("MercuryMessageRendererUtils").getLinkToParticipant(e,c);a.log_message_data||i(0);a.log_message_data.image?d(h._("{actor} changed the conversation picture.",[h._param("actor",e)])):d(h._("{actor} removed the conversation picture.",[h._param("actor",e)]))})}function z(a,c){a.author===b("MercuryViewer").getID()?c(h._("You changed the wallpaper.")):b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a);c(h._("{actor} changed the wallpaper.",[h._param("actor",a)]))})}function A(a,c){__p&&__p();var d=[a.author];a.log_message_data||i(0);var e=a.log_message_data.removed_participants;e||i(0);var f;e.length===1&&(f=e[0],d.push(f));b("MessengerParticipants.bs").getMulti(d,function(d){var e=d[a.author];d=d[f];a.author===b("MercuryViewer").getID()?!f||f===a.author?c(h._("You left the chat.")):c(h._("You removed {name} from the chat.",[h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))])):!f||f===a.author?c(h._("{actor} left the chat.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):f===b("MercuryViewer").getID()?c(h._("{actor} removed you from the chat.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e))])):c(h._("{actor} removed {name} from the chat.",[h._param("actor",b("MercuryMessageRendererUtils").getLinkToParticipant(e)),h._param("name",b("MercuryMessageRendererUtils").getLinkToParticipant(d))]))})}function B(a,c,d){__p&&__p();a.log_message_data||i(0);var e=a.log_message_data.name,f="_5wzs"+(b("UserAgent").isBrowser("Chrome")?" _4fbd":"");if(a.author===b("MercuryViewer").getID())if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("You named the chat {name}.",[h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("You removed the chat name."));else b("MessengerParticipants.bs").get(a.author,function(a){a=b("MercuryMessageRendererUtils").getLinkToParticipant(a,c);if(e){var g=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:e});d(h._("{actor} named the chat {name}.",[h._param("actor",a),h._param("name",b("React").createElement("span",{className:f},g))]))}else d(h._("{actor} removed the chat name.",[h._param("actor",a)]))})}function C(a,c,d){a.author===b("MercuryViewer").getID()?(a.log_message_data||i(0),a.log_message_data.image?d(h._("You changed the chat picture.")):d(h._("You removed the chat picture."))):b("MessengerParticipants.bs").get(a.author,function(e){e=b("MercuryMessageRendererUtils").getLinkToParticipant(e,c);a.log_message_data||i(0);a.log_message_data.image?d(h._("{actor} changed the chat picture.",[h._param("actor",e)])):d(h._("{actor} removed the chat picture.",[h._param("actor",e)]))})}}),null);
__d("MercuryLogMessage.react",["cx","fbt","DOM","DOMDimensions","Event","EventReminderRequestHelper","FantaDropdownMenuWebDriverTestIDs","MercuryLogMessageRenderer","MercuryLogMessageType","MessagingGenericAdminTextType","React","ReactDOM","ShimButton.react","cancelAnimationFrame","emptyFunction","formatDate","joinClasses","requestAnimationFrame","requireWeak"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j=266;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={messageText:null,showEventReminderFlyout:!1},this.$4=function(){this.$5()}.bind(this),this.$9=function(){var a;a=(a=this.props.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_id:a:a:a;!this.state.showEventReminderFlyout&&a?b("EventReminderRequestHelper").fetchEventReminder(this.props.thread.thread_id,a,function(){this.$1&&this.setState({showEventReminderFlyout:!0})}.bind(this)):this.setState({showEventReminderFlyout:!1})}.bind(this),this.$11=function(a){a!==this.state.showEventReminderFlyout&&this.setState({showEventReminderFlyout:a})}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=!0,this.UNSAFE_componentWillReceiveProps(this.props)};a.prototype.componentWillUnmount=function(){this.$1=!1,this.$2&&b("cancelAnimationFrame")(this.$2)};a.prototype.$3=function(){return b("React").createElement(b("ShimButton.react"),{form:"link",onClick:this.$4},h._("Show previous messages."))};a.prototype.$5=function(){var a=this.props.loadMoreMessages&&this.props.loadMoreMessages();if(!this.$1)return;if(a)this.setState({messageText:this.$3()});else{a=h._("Couldn't find previous messages.");this.setState({messageText:a})}};a.prototype.UNSAFE_componentWillReceiveProps=function(a){if(a.message.log_message_type===b("MercuryLogMessageType").SERVER_ERROR)return;b("MercuryLogMessageRenderer").renderText(a.message,a.thread,a.isLastOfType,function(a){this.$1&&this.setState({messageText:a})}.bind(this))};a.prototype.shouldComponentUpdate=function(a,b){return this.state.messageText!=b.messageText||a.maxWidth!==this.props.maxWidth||this.state.showEventReminderFlyout!==b.showEventReminderFlyout};a.prototype.componentDidUpdate=function(){this.$6();if(!this.refs.attachment)return;b("MercuryLogMessageRenderer").renderAttachmentLegacy(this.refs.attachment,this.props.message);b("DOM").scry(this.refs.wrap,"img").forEach(function(a){var c=b("Event").listen(a,"load",function(){this.$6(),c.remove()}.bind(this))}.bind(this))};a.prototype.render=function(){return b("React").createElement("div",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,"_5ye6"),ref:"wrap",style:babelHelpers["extends"]({},this.props.style,this.$7()),title:b("formatDate")(new Date(this.props.message.timestamp),"g:ia")}),b("React").createElement("div",{className:"_5ye7"},b("MercuryLogMessageRenderer").renderIcon(this.props.message),b("React").createElement("span",{"data-testid":b("FantaDropdownMenuWebDriverTestIDs").LOG_MESSAGE_TEXT},this.state.messageText)),b("React").createElement("div",{className:"_5ye8",ref:"attachment"},this.$8()))};a.prototype.$8=function(){__p&&__p();var a;if(this.props.thread&&!this.props.thread.lightweight_event||!this.props.message.log_message_data)return null;if(!this.props.event||!this.props.event.exists)return null;a=(a=this.props.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_time:a:a:a;if(!a)return null;typeof a==="string"&&(a=parseInt(a,10));if(a<=Math.floor(Date.now()/1e3))return null;var c;b("requireWeak")("Link.react",function(a){c=a});var d;switch(this.props.message.log_message_data.message_type){case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_CREATE:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TIME:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TITLE:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_LOCATION:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE:d=h._("Change");break;default:d=null}a=b("React").createElement(c,{href:"#",onClick:this.$9,title:h._("Edit Event"),ref:"event_rem_link"},d);this.props.displayItems&&(a=null);return b("React").createElement("span",null,a,this.$10())};a.prototype.$10=function(){__p&&__p();var a;if(!this.state.showEventReminderFlyout)return null;var c="right",d=b("ReactDOM").findDOMNode(this.refs.wrap);d&&d instanceof Element&&d.getBoundingClientRect().left<j&&(c="left");d={alignment:c,position:"above",contextRef:function(){return this.refs.event_rem_link}.bind(this),shown:this.state.showEventReminderFlyout,onToggle:this.$11};var e;b("requireWeak")("EventsActionsLogger",function(a){e=a});c={action_history:[{surface:e.Surface.MESSENGER_CHAT_TAB,mechanism:e.Mechanism.REMINDER_ADMIN_TEXT}]};a=(a=this.props.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_id:a:a:a;a={threadID:this.props.thread.thread_id,eventID:a,dialogProps:d,flyoutNoSheet:!0,isEditing:!0,actionContext:c};var f;b("requireWeak")("ChatEventReminderContainer.react",function(a){f=a});return b("React").createElement(f,a)};a.prototype.$7=function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null};a.prototype.$6=function(){this.$2&&b("cancelAnimationFrame")(this.$2);if(!this.$1)return;this.$2=b("requestAnimationFrame")(function(){this.props.onImageLoad&&this.props.onImageLoad(b("DOMDimensions").getElementDimensions(this.refs.wrap).height),delete this.$2}.bind(this))};a.propTypes={loadMoreMessages:c.func,maxWidth:c.number,message:c.object.isRequired,onImageLoad:c.func,thread:c.object,isLastOfType:c.bool.isRequired,event:c.object};a.defaultProps={onImageLoad:b("emptyFunction")};e.exports=a}),null);
__d("MercuryLogMessageContainer.react",["EventReminderStateStore","FluxContainer","MercuryLogMessage.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("EventReminderStateStore")]};a.calculateState=function(a,c){a=(a=c.message)!=null?(a=a.log_message_data)!=null?(a=a.untypedData)!=null?a.event_id:a:a:a;return{event:b("EventReminderStateStore").getEvent(c.thread?c.thread.thread_id:"",a)}};a.prototype.render=function(){return b("React").createElement(b("MercuryLogMessage.react"),{className:this.props.className,onLogMessageExpanded:this.props.onLogMessageExpanded,loadMoreMessages:this.props.loadMoreMessages,message:this.props.message,onImageLoad:this.props.onImageLoad,viewer:this.props.viewer,isPageMessage:this.props.isPageMessage,thread:this.props.thread,isLastOfType:this.props.isLastOfType,event:this.state.event})};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("ChatConversation.react",["ChatCollapsedLogMessageGroup.react","ChatDateBreak.react","ChatMessageGroup.react","MercuryIDs","MercuryLogMessageContainer.react","MercuryShareAttachmentRenderLocations","MessageList.react","MessengerReadReceipt.bs","React","cancelAnimationFrame","immutable","requestAnimationFrame"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("immutable").OrderedMap;a=b("React").PropTypes;c=b("React").createClass({displayName:"ChatConversation",_raf:undefined,_onMountTimeout:undefined,propTypes:{contextBanner:a.object,forGameChat:a.bool.isRequired,isCanonical:a.bool.isRequired,loadMoreMessages:a.func,maxBubbleWidth:a.number.isRequired,messages:a.instanceOf(b("immutable").List).isRequired,onAttachmentLoad:a.func,onMount:a.func,onlineUsers:a.instanceOf(b("immutable").List).isRequired,onStickerClick:a.func,viewer:a.string.isRequired,thread:a.object,threadID:a.string.isRequired},componentDidMount:function(){this._raf=b("requestAnimationFrame")(function(){this._onMountTimeout=setTimeout(function(){this.props.onMount&&this.props.onMount(),delete this._onMountTimeout}.bind(this),0),delete this._raf}.bind(this))},componentWillUnmount:function(){this._raf&&b("cancelAnimationFrame")(this._raf),clearTimeout(this._onMountTimeout)},render:function(){return b("React").createElement("div",null,this.props.contextBanner,b("React").createElement(b("MessageList.react"),{DateBreak:b("ChatDateBreak.react"),forGameChat:this.props.forGameChat,LogMessage:b("MercuryLogMessageContainer.react"),MessageGroup:b("ChatMessageGroup.react"),deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:b("MercuryShareAttachmentRenderLocations").CHAT,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,CollapsedLogMessageGroup:b("ChatCollapsedLogMessageGroup.react"),messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onlineUsers:this.props.onlineUsers,onStickerClick:this.props.onStickerClick,readReceipts:this._calculateReceipts(this.props),ref:"messageList",viewer:this.props.viewer,thread:this.props.thread,threadID:this.props.threadID}))},_calculateReceipts:function(a){__p&&__p();var c=b("MercuryIDs").getParticipantIDFromUserID(a.viewer),d=b("MessengerReadReceipt.bs").getSeenTimestamps(a.readReceipts,a.threadID),e=new Set(a.thread?a.thread.participants:d.keys());e["delete"](c);return d.withMutations(function(c){b("immutable").Seq(a.messages).reverse().forEach(function(a){if(e.size===0)return!1;if(!e.has(a.author))return null;c.update(a.author,function(b){return!b||b.watermark<=a.timestamp?{watermark:a.timestamp,action:a.timestamp}:b});e["delete"](a.author);return null})})},getMessageList:function(){return this.refs.messageList}});e.exports=c}),null);
__d("ChatDetailStack.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=a.bottomDetail;a=a.topDetail;c=c?b("React").createElement("div",{className:"_4jeh"},c):null;return b("React").createElement("div",{className:"_2rt2"},b("React").createElement("div",{className:"_4jeg"},a),c)}e.exports=a}),null);
__d("ChatEditParticipantsUtils",["AsyncDialog","AsyncRequest","MercuryIDs","MercuryThreadIDMap","URI"],(function(a,b,c,d,e,f){"use strict";var g=b("MercuryThreadIDMap").get();a={showParticipantsModal:function(a){if(!b("MercuryIDs").isGroupChat(a))return;g.getServerIDFromClientID(a,function(a){b("AsyncDialog").send(new(b("AsyncRequest"))(new(b("URI"))("/ajax/browser/dialog/multichat_members/").addQueryData({id:a})))})}};e.exports=a}),null);
__d("ChatTabComposerContainer.react",["cx","fbt","Bootloader","ChatComposer","ChatConfig","FantaMessageActions","FantaTabActions","Keys","LogHistory","MercuryIDs","MercuryMessageActions","MercuryShareAttachmentRenderLocations","MessengerBotMenuDataFetcher","MessengerParticipants.bs","MessengerState.bs","MNCommercePageSetting","P2PGKValues","PhotosUploadWaterfall","React","ReactDOM","SimpleXUIDialog","WaterfallIDGenerator","emptyFunction","getPageIDFromThreadID","getThreadTypeNameFromThreadType","performanceAbsoluteNow","setImmediate","shallowCompare"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("ChatComposer").ChatComposer,k="right",l=/^\s*$/,m=b("LogHistory").getInstance("chat_tab_view"),n=b("ChatConfig").get("slc_disappearing_icons"),o=b("ChatConfig").get("single_line_composer"),p=140,q=90;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={participants:[],showP2PButton:this.$7(),pageID:b("getPageIDFromThreadID")(this.props.threadID),showStructuredMenu:this.$8(),longInput:!1},this.$11=function(a){this.$3=a}.bind(this),this.$12=function(a){this.$4&&this.$4.uploadFiles([].concat(a))}.bind(this),this.$13=function(a){this.$6=a}.bind(this),this.$14=function(a){this.$4=a}.bind(this),this.onSend=function(a){this.props.forGameChat&&b("Bootloader").loadModules(["GamesQuicksilverFunnelLogger"],function(a){a.logGameChatSendMessage(a.getDefaultFunnelName())},"ChatTabComposerContainer.react");if(a&&a.profile_ranges&&a.profile_ranges.length){var c=a,d=this.props.thread,e=this.state.participants;b("Bootloader").loadModules(["MessengerMentionsTypedLogger","MessengerMentionsLoggerEvents"],function(a,f){new a().setEvent(f.MENTION).setGroupSize(e&&e.length).setNumDelivered((c.profile_ranges||[]).length).setThreadid(d&&d.thread_id).setThreadType(b("getThreadTypeNameFromThreadType")(d&&d.thread_type)).setOfflineThreadid(c.offline_threading_id).log()},"ChatTabComposerContainer.react")}o?this.$3&&this.$3.onSend&&this.$3.onSend(a):this.refs.composer&&this.refs.composer.onSend(a)}.bind(this),this.focusInput=function(){var a=this.getInput();a&&a.focus&&a.focus()}.bind(this),this.$16=function(a){a=this.getInput();a&&typeof a.handleSend==="function"&&(a&&a.handleSend())}.bind(this),this.$35=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).confirmAttachmentPlaceholder(c.upload_id,c),this.$29(c)}.bind(this),this.$37=function(a){var b,c;switch(a.error){case"size-exceeded":b=h._("The file you have selected is too large");c=h._("The file you have selected is too large. The maximum size is 25MB.");break;default:b=h._("File Upload Failed"),c=h._("There was a problem uploading the file.")}this.$40(b,c);this.$24(a)}.bind(this),this.$34=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c),this.$28(c)}.bind(this),this.$39=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c);a=h._("File Upload Failed");var d=h._("There was a problem uploading the file.");c.errorDialogParams&&(a=c.errorDialogParams.title||a,d=c.errorDialogParams.body||d);this.$40(a,d);this.$24(c)}.bind(this),this.$36=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c);a=h._("Upload Failed");var d=h._("Please try again. Make sure that you are uploading a valid file.");c.errorDialogParams&&(a=c.errorDialogParams.title||a,d=c.errorDialogParams.body||d);this.$40(a,d);this.$26&&this.$26(c)}.bind(this),this.$38=function(a,b){this.$30&&this.$30(b)}.bind(this),this.$19=function(a,b){this.$22(a,b)}.bind(this),this.$18=function(a){this.props.onEscape&&this.props.onEscape(a)}.bind(this),this.$20=function(a,c){var d=this.props.threadID;d&&(this.$5=b("setImmediate")(function(){this.$5=null,b("FantaMessageActions").composerTextUpdate(d,a,c)}.bind(this)));this.$10()}.bind(this),this.$22=function(event,a){var c=this.props.threadID;event.keyCode===b("Keys").RETURN&&!event.shiftKey&&(event.preventDefault(),this.$15(a));if(event.keyCode===b("Keys").DOWN&&event.shiftKey&&this.hasEmptyInput()){b("FantaTabActions").minimizeTab(c);return}}.bind(this),this.$15=function(a){var b=this.$42();b==null||b.length===0?this.$43(a,[]):this.$43(a,b)}.bind(this),this.$17=function(a){var b=this.getInput();b&&b.insertEmoji(a)}.bind(this),this.$23=function(a,b,c){this.props.onSendHotLike(a.emoji,b,c,this.focusInput)}.bind(this),this.$25=function(){this.props.onSendMessage("",this.props.composer,this.onSend)}.bind(this),this.$27=function(a){this.props.onSelectSticker(a,b("emptyFunction"))}.bind(this),this.$30=function(a){this.$44(b("PhotosUploadWaterfall").UPLOAD_START,a),this.props.onSendPhoto(a,this.onSend),this.$45("submit",a),this.focusInput()}.bind(this),this.$24=function(a){this.$44(b("PhotosUploadWaterfall").CLIENT_ERROR,a),this.$45("failed",a)}.bind(this),this.$26=function(a){this.$44(b("PhotosUploadWaterfall").CLIENT_ERROR,a),this.$45("failed",a)}.bind(this),this.$28=function(a){this.$44(b("PhotosUploadWaterfall").CANCEL_DURING_UPLOAD,a),this.$45("canceled",a)}.bind(this),this.$29=function(a){this.$44(b("PhotosUploadWaterfall").ALL_UPLOADS_DONE,a);this.$45("completed",a);a=a.image_ids.length||a.attachments.length;this.$46(a)}.bind(this),c}a.prototype.shouldComponentUpdate=function(a,c){return b("shallowCompare")(this,a,c)};a.prototype.componentDidMount=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_composer_container",JSON.stringify(this.state),0,a)}.bind(this),"ChatTabComposerContainer.react");this.props.isFocused&&!this.props.isNewEmptyLocalThread&&this.focusInput();this.state.pageID&&b("MessengerBotMenuDataFetcher").getHasPageSetting(this.state.pageID,function(a){this.setState({showStructuredMenu:a})}.bind(this),function(){this.setState({showStructuredMenu:!1})}.bind(this),b("MNCommercePageSetting").STRUCTURED_MENU_ENABLED);this.setState({participants:this.$9()})};a.prototype.componentDidUpdate=function(a){__p&&__p();var c=this.props.thread,d=c?c.thread_id:null,e=c?c.thread_fbid:null;if(d===this.props.threadID){this.props.fileUploader!==a.fileUploader&&this.$10();if(!e||e&&e===b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID))return}d=c?c.participants:[];if(d.length!==this.state.participants.length){this.setState({participants:this.$9()});return}var f=new Set(this.state.participants.map(function(a){return a==null?!1:a.id}).filter(Boolean));if(d.every(function(a){return f.has(a)}))return;else this.setState({participants:this.$9()})};a.prototype.componentWillUnmount=function(){this.$1&&b("MessengerParticipants.bs").removeCallback(this.$1)};a.prototype.$9=function(){__p&&__p();var a=this.props.thread;if(!a)return[];var c=[],d=[];a.participants.forEach(function(a){var e=b("MessengerParticipants.bs").getNow(a);e?d.push(e):c.push(a)});c.length>0&&(this.$1&&b("MessengerParticipants.bs").removeCallback(this.$1),this.$1=b("MessengerParticipants.bs").getMulti(c,function(b){this.$1=null,this.setState({participants:a.participants.map(function(a){return b[a]})})}.bind(this)));return d};a.prototype.$7=function(){return b("P2PGKValues").P2PVisible&&this.props.viewer!==b("MercuryIDs").getUserIDFromThreadID(this.props.threadID)};a.prototype.$8=function(){var a=b("getPageIDFromThreadID")(this.props.threadID);return a===null||a===undefined?!1:b("MessengerBotMenuDataFetcher").getHasPageSetting(a,function(){},function(){},b("MNCommercePageSetting").STRUCTURED_MENU_ENABLED)};a.prototype.render=function(){var a=this.props.composer,c=this.props,d=c.thread;c=c.threadID;var e=c?b("MessengerState.bs").isEmptyLocalThread(this.props.viewer,c):!1;return o?b("React").createElement(j,{composer:a,enableDisappearingIcons:n,fileUploader:this.props.fileUploader,handleSend:this.$15,handleSendClick:this.$16,inputRef:this.$11,isEmptyLocalThread:e,isFocused:this.props.isFocused,defaultText:a.text,onEmojiSelect:this.$17,onEscape:this.$18,onInputKeyDown:this.$19,onTab:this.props.onTab,onTextChange:this.$20,onUploaderMount:this.$14,pageID:this.state.pageID,participantIDs:undefined,participants:this.state.participants,disableInput:this.props.disableInput,showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,thread:d,threadID:c,uploadPhotoFn:this.$12,viewer:this.props.viewer,focusInput:this.focusInput,longInput:this.state.longInput,ref:this.$13,forGameChat:this.props.forGameChat}):b("React").createElement(j,{defaultText:a.text,fileUploaderProps:this.$21(),handleSendClick:this.$16,isEmptyLocalThread:e,ref:"composer",composer:this.props.composer,fileUploader:this.props.fileUploader,handleSend:this.$15,inputKeyDown:this.$22,isFocused:this.props.isFocused,onCustomLikeSelect:this.$23,onEmojiSelect:this.$17,onEscape:this.props.onEscape,onFileUploadFail:this.$24,onP2PTrigger:this.$25,onPhotoUploadFail:this.$26,onStickerSelect:this.$27,onTab:this.props.onTab,onUploadCancel:this.$28,onUploadComplete:this.$29,onUploadSubmit:this.$30,thread:d,threadID:c,viewer:this.props.viewer,disableInput:this.props.disableInput,onTextChange:this.$20,p2pProps:this.$31(),pageID:this.state.pageID,participantIDs:undefined,participants:this.state.participants,photoUploaderProps:this.$32(),showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,stickerButtonProps:this.$33(),forGameChat:this.props.forGameChat})};a.prototype.getInput=function(){return o?this.$3:this.refs.composer&&this.refs.composer.getInput&&this.refs.composer.getInput()};a.prototype.isUploading=function(){return this.refs.composer.isUploading()};a.prototype.$31=function(){return!this.state.showP2PButton?{}:{button:b("React").createElement("i",{className:"hidden_elem"}),className:"_6ga _6gb _6jtl",flyoutAlignment:k,referrer:b("MercuryShareAttachmentRenderLocations").CHAT,threadID:this.props.threadID,onTrigger:this.$25}};a.prototype.$33=function(){var a={className:"_6gb _6gf _6jtm",flyoutAlignment:k,threadID:this.props.threadID,onStickerSelect:this.$27};return a};a.prototype.$32=function(){var a={className:"_6gd",customUI:!0,imageClassName:"hidden_elem",linkClassName:"_6gb _6ge _6jtn",threadID:this.props.threadID,onLastUploadCancel:this.$34,onAllUploadsComplete:this.$35,onLastUploadFail:this.$36,onUploadError:this.$37,onSubmit:this.$38};return a};a.prototype.$21=function(){var a=this.$32();a.linkClassName="_6gb _6gg _6jto";a.imagesOnly=!1;a.onLastUploadFail=this.$39;return a};a.prototype.$40=function(a,c){b("SimpleXUIDialog").show(c,a)};a.prototype.$10=function(){if(!this.$6)return;var a=b("ReactDOM").findDOMNode(this.$6);if(!a)return;a=a.clientHeight;!this.state.longInput&&a>p?this.setState({longInput:!0}):this.state.longInput&&a<q&&this.setState({longInput:!1})};a.prototype.hasEmptyInput=function(){return l.test(this.$41())};a.prototype.$41=function(){var a=this.getInput();return a&&a.getValue()||""};a.prototype.$43=function(a,b){this.props.onSendMessage({message:a,mentions:b},this.props.composer,this.onSend);return};a.prototype.$42=function(){var a=this.getInput();return a&&a.getMentions?a.getMentions():null};a.prototype.$44=function(a,c){this.$2==null&&(this.$2=b("WaterfallIDGenerator").generate()),b("PhotosUploadWaterfall").sendSignal(babelHelpers["extends"]({qn:this.$2,step:a,uploader:b("PhotosUploadWaterfall").APP_CHAT},c||{}))};a.prototype.$46=function(a){if(a===0)return;this.$44(b("PhotosUploadWaterfall").POST_PUBLISHED,{count:a});this.$2=b("WaterfallIDGenerator").generate()};a.prototype.$45=function(a,b){m.debug("photo_uploader:"+a,"{}")};e.exports=a}),null);
__d("M4IconSettings.bs",["React","M4IconSVG.bs","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ReasonReact.bs").statelessComponent("M4IconSettings");function h(a,c,d){var e=a?a[0]:!0,f=c?c[0]:"blue",h={fill:"none",stroke:f,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10"};return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){var a=!e;return b("ReasonReact.bs").element(0,0,b("M4IconSVG.bs").make(0,[a?b("React").createElement("g",{key:"filled"},b("React").createElement("path",{key:"outer",style:h,d:"M15.5,8.9V7.1l-2.2-0.5c-0.1-0.5-0.3-0.9-0.6-1.3l1.2-1.9l-1.2-1.2l-1.9,1.2C10.3,3,9.9,2.8,9.4,2.7L8.9,0.5\n          \t\t\tH7.1L6.6,2.7C6.1,2.8,5.7,3,5.2,3.2L3.3,2.1L2.1,3.3l1.2,1.9C3,5.7,2.8,6.1,2.7,6.6L0.5,7.1v1.7l2.2,0.5c0.1,0.5,0.3,0.9,0.6,1.3\n          \t\t\tl-1.2,1.9l1.2,1.2l1.9-1.2c0.4,0.2,0.9,0.4,1.3,0.6l0.5,2.2h1.7l0.5-2.2c0.5-0.1,0.9-0.3,1.3-0.6l1.9,1.2l1.2-1.2l-1.2-1.9\n          \t\t\tc0.2-0.4,0.4-0.9,0.6-1.3L15.5,8.9z"}),b("React").createElement("circle",{key:"inner",style:h,cx:"8",cy:"8",r:"2.5"})):b("React").createElement("path",{key:"all",d:"M15.5,8.9V7.1l-2.2-0.5c-0.1-0.5-0.3-0.9-0.6-1.3l1.2-1.9l-1.2-1.2l-1.9,1.2C10.3,3,9.9,2.8,9.4,2.7L8.9,0.5 H7.1L6.6,2.7C6.1,2.8,5.7,3,5.2,3.2L3.3,2.1L2.1,3.3l1.2,1.9C3,5.7,2.8,6.1,2.7,6.6L0.5,7.1v1.7l2.2,0.5c0.1,0.5,0.3,0.9,0.6,1.3 l-1.2,1.9l1.2,1.2l1.9-1.2c0.4,0.2,0.9,0.4,1.3,0.6l0.5,2.2h1.7l0.5-2.2c0.5-0.1,0.9-0.3,1.3-0.6l1.9,1.2l1.2-1.2l-1.2-1.9 c0.2-0.4,0.4-0.9,0.6-1.3L15.5,8.9z M8,11c-1.7,0-3-1.3-3-3c0-1.7,1.3-3,3-3c1.7,0,3,1.3,3,3C11,9.7,9.7,11,8,11z",fill:f,stroke:f})]))},g[9],g[10],g[11],g[12]]}a=b("ReasonReact.bs").wrapReasonForJs(g,function(a){return h([a.filled],[a.color],[])});f.component=g;f.make=h;f.jsComponent=a}),null);
__d("ChatTabMenuBootloader.react",["cssVar","cx","fbt","AutoFocusableLink.react","BootloadOnInteraction.react","CurrentUser","FantaTypeComposer","JSResource","LazyComponent.react","M4IconSettings.bs","MessengerState.bs","React","immutable"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("M4IconSettings.bs").jsComponent;j=babelHelpers.inherits(a,b("React").Component);j&&j.prototype;a.prototype.render=function(){var a=this.props,c=a.highlightNewMessage,d=a.isFocused;a=a.threadID;a=b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),a);a=a&&a.header_color||"#0084ff";c=c?"#FFFFFF":d?a:"#bec2c9";d=i._("Options");return b("React").createElement("div",{className:"_461_",ref:"menu"},b("React").createElement(b("BootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),this.props),loader:b("JSResource")("ChatTabMenu.react").__setRef("ChatTabMenuBootloader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":d,role:"button"},b("React").createElement(k,{filled:!0,color:c}))}))};function a(){j.apply(this,arguments)}e.exports=a}),null);
__d("MessengerHoverCardLink",["URI"],(function(a,b,c,d,e,f){var g={getBaseURI:function(){return new(b("URI"))("/ajax/hovercard/chat.php")},constructEndpoint:function(a){return new(b("URI"))(g.getBaseURI()).setQueryData({id:a.id,type:"chat"})}};e.exports=g}),null);
__d("ChatTitleLink.react",["cx","ChatEditParticipantsUtils","Link.react","MercuryIDs","MercuryThreadTitle.react","MessengerAdminGroupUtils","MessengerHoverCardLink","React","TrackingNodes","UserAgent","gkx","goURI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"ChatTitleLink",propTypes:{href:a.string,isNewMessageTab:a.bool,thread:a.object,viewer:a.string},getDefaultProps:function(){return{href:null}},getTitle:function(){return this.refs.threadTitle.getTitle()},render:function(){if(!this.props.thread)return null;var a=this.props,c=a.href,d=a.thread,e=a.viewer;a=babelHelpers.objectWithoutProperties(a,["href","thread","viewer"]);var f="";b("gkx")("AT6Pi2a8MKJnWbIzTtkE83l3SQto_q6iFEUcjRzrX_KWbZvaeUi7XiJBSppF6WZHWLawAEgGrQhXyShvNLt7lgt3")&&d&&d.thread_id&&(f=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(d.thread_id)}));return b("React").createElement(h,babelHelpers["extends"]({className:"titlebarText"+(b("UserAgent").isBrowser("Chrome")&&!b("UserAgent").isPlatform("Windows")?" fixemoji":"")+(c===null?" noLink":""),"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.TITLE),"data-hover":"tooltip",onClick:function(a){return this._handleClick(a)}.bind(this),"data-hovercard":f.toString(),href:c},a),b("React").createElement(b("MercuryThreadTitle.react"),{ref:"threadTitle",isNewThread:this.props.isNewMessageTab,thread:d,useAndSeparator:!0,useShortName:!d.is_canonical,viewer:e}))},_handleClick:function(a){var c=this.props,d=c.href;c=c.thread;if(!d)return;c&&c.associated_object?b("goURI")(d):b("MessengerAdminGroupUtils").showParticipantsModal(c.is_canonical,this.props.isNewMessageTab,c)&&(b("ChatEditParticipantsUtils").showParticipantsModal(c.thread_id),a.preventDefault())}});var h=function(a){return a.href?b("React").createElement(b("Link.react"),a):b("React").createElement("span",a)};e.exports=c}),null);
__d("M4IconCamcorder.bs",["React","M4IconSVG.bs","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ReasonReact.bs").statelessComponent("M4IconCamcorder");function h(a,c,d){var e=a?a[0]:!0,f=c?c[0]:"blue",h={fill:e?f:"none",stroke:f};return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){return b("ReasonReact.bs").element(0,0,b("M4IconSVG.bs").make(0,[b("React").createElement("path",{key:"body",style:h,d:"M9.5,13.5h-7c-1.1,0-2-0.9-2-2v-7c0-1.1,0.9-2,2-2h7c1.1,0,2,0.9,2,2v7C11.5,12.6,10.6,13.5,9.5,13.5z"}),b("React").createElement("line",{key:"focus-ring",stroke:e?"none":f,x1:"13.5",x2:"13.5",y1:"5",y2:"11"}),b("React").createElement("path",{key:"lens",style:h,d:"M15,3.6l-3.5,3V8v1.4l3.5,3c0.2,0.2,0.5,0,0.5-0.3V8V3.9C15.5,3.6,15.2,3.4,15,3.6z"})]))},g[9],g[10],g[11],g[12]]}a=b("ReasonReact.bs").wrapReasonForJs(g,function(a){return h([a.filled],[a.color],[])});f.component=g;f.make=h;f.jsComponent=a}),null);
__d("M4IconPhone.bs",["React","M4IconSVG.bs","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ReasonReact.bs").statelessComponent("M4IconPhone");function h(a,c,d){d=a?a[0]:!0;a=c?c[0]:"blue";var e={fill:d?a:"none",stroke:a};return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){return b("ReasonReact.bs").element(0,0,b("M4IconSVG.bs").make(0,[b("React").createElement("path",{key:"all",style:e,d:"M8.8,11.6c0.1,0,0.1,0.1,0.2,0.1c0.4,0.2,0.8,0.1,1-0.3c0.1-0.2,0.2-0.4,0.3-0.6c0.2-0.2,0.5-0.6,0.8-0.7 C11.5,10,11.8,10,12,10c0.4,0,0.9,0.4,1.6,0.8c0.7,0.4,1.2,0.8,1.5,1c0.2,0.2,0.3,0.4,0.3,0.6c0,0.4,0,1.2-0.7,1.9 c-1,1.1-2.5,1.6-4.3,1c-1.8-0.6-4.1-1.7-6-3.7s-3.1-4.2-3.7-6s-0.2-3.3,1-4.3c0.7-0.6,1.4-0.7,1.9-0.7c0.2,0,0.5,0.1,0.6,0.3 c0.2,0.3,0.6,0.8,1,1.5C5.7,3.1,6,3.6,6,4c0,0.3,0,0.6-0.1,0.8C5.8,5.1,5.5,5.4,5.2,5.6C5,5.8,4.8,5.9,4.7,6C4.3,6.1,4.1,6.6,4.3,7 c0,0.1,0.1,0.1,0.1,0.2C5.5,9,7,10.5,8.8,11.6z"})]))},g[9],g[10],g[11],g[12]]}a=b("ReasonReact.bs").wrapReasonForJs(g,function(a){return h([a.filled],[a.color],[])});f.component=g;f.make=h;f.jsComponent=a}),null);
__d("ChatVideoCallButtonBootloader.react",["cx","AutoFocusableLink.react","BootloadOnInteraction.react","JSResource","LazyComponent.react","M4IconCamcorder.bs","M4IconPhone.bs","React","requireWeak"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("M4IconCamcorder.bs").jsComponent,j=b("M4IconPhone.bs").jsComponent;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=!1,this.state={RTCComponent:null},b}a.prototype.componentDidMount=function(){this.$1=!0,b("requireWeak")("ChatVideoCallButton.react",function(a){this.$1&&this.setState({RTCComponent:a})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.render=function(){var a=this.props.isAudio,c=this.state.RTCComponent;return b("React").createElement("div",{className:"_3a61"+(a?" _461a":"")+(a?"":" _461b"),key:"rtc"+(a?"audio":"video")},c?b("React").createElement(c,this.props):b("React").createElement(b("BootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),this.props),loader:b("JSResource")("ChatVideoCallButton.react").__setRef("ChatVideoCallButtonBootloader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{role:"button"},a?b("React").createElement(j,{color:this.props.color,filled:!0}):b("React").createElement(i,{color:this.props.color,filled:!0}))}))};e.exports=a}),null);
__d("ChatTabHeader.react",["ix","cx","fbt","AutoFocusableLink.react","Bootloader","BootloadOnRender.react","ChatCloseButton.react","ChatConfig","ChatTitleLink.react","CurrentUser","ErrorBoundary.react","EventPlanExperiment","EventReminderStateStore","Image.react","JSResource","LayerFadeOnHide","LazyComponent.react","LoadOnRender.react","MercuryBootloadOnInteraction.react","MercuryConfig","MercuryIDs","MercuryThreadInfo","MercuryTypingAnimation.react","MessageRequestUtils","MessagingTag","MessengerAdminGroupUtils","MessengerJoinableModeType","MessengerState.bs","Placeholder.react","QE2Logger","React","SimpleNUXMessage","TooltipData","WorkChatAvailabilityStatusLoader","XUIAmbientNUX.react","asset","gkx","immutable","isEmpty","lazyLoadComponent","requireWeak"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;var k="118809038721180",l=function(a){b("Bootloader").loadModules(["ArchiveWarningReact.bs"],function(b){b=b.jsComponent;return a(b)},"ChatTabHeader.react")},m=b("lazyLoadComponent")(b("JSResource")("ChatExpandTabButton.react").__setRef("ChatTabHeader.react"));d=babelHelpers.inherits(a,b("React").PureComponent);j=d&&d.prototype;function a(a){j.constructor.call(this,a),this.$1=!1,this.$4=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];this.props.onClick.apply(null,b)}.bind(this),this.$18=function(){return this.refs.menu}.bind(this),this.$19=function(){b("SimpleNUXMessage").markMessageSeenByUser(k),this.setState({eventPlanNuxSeen:!0})}.bind(this),this.state={eventPlanNuxSeen:b("SimpleNUXMessage").hasUserSeenMessage(k)}}a.prototype.componentDidMount=function(){this.$1=!0,b("requireWeak")("ChatVideoCallButton.react",function(a){this.$1&&this.setState({RTCComponent:a})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.render=function(){var a=this.$3(),c=this.props.isRaised;return b("React").createElement("div",{className:"_15p4"+(this.props.isRaised?"":" _15p5")+(c||!a?" _2pis":""),onMouseUp:this.$4,ref:"root"},b("React").createElement("div",{"aria-level":"2",className:"titlebarTextWrapper _15p6",role:"heading"},b("React").createElement("div",{className:"_61td",role:c?"presentation":"button",tabIndex:c?-1:0},a,this.$5()),this.props.isTyping&&!this.props.isRaised?b("React").createElement(b("MercuryTypingAnimation.react"),{className:"_15p8",color:"dark"}):null),b("React").createElement("ul",{className:"_32ca"},this.$6(),b("React").createElement("li",{className:"_32cb"},b("React").createElement(b("ChatCloseButton.react"),{active:this.props.isActive,className:"_3olu _3olv",onClick:this.props.onCloseClick}))))};a.prototype.focus=function(){this.refs.root&&this.refs.root.focus()};a.prototype.$7=function(){return this.props.thread?b("MessageRequestUtils").isMessageRequest(this.props.thread):!1};a.prototype.$8=function(){var a;if(this.props.thread===null)return null;var c=b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),this.props.threadID);if(!c)return null;c=((a=c.marketplace_thread_data)!=null?a.for_sale_item:a)||((a=c.marketplace_thread_data)!=null?a.buyer_fbid:a)||((a=c.marketplace_thread_data)!=null?a.seller_fbid:a);return c};a.prototype.$6=function(){if(!this.props.isRaised)return null;var a=[this.$9(),this.$10(),this.$11(),this.$12(),this.$13(),this.$14(),this.$15()];return a.filter(Boolean)};a.prototype.$14=function(){return this.$16({isAudio:!0})};a.prototype.$13=function(){return this.$16({isAudio:!1})};a.prototype.$16=function(a){__p&&__p();if(this.props.isEmptyChat||this.$7()||this.$8())return null;var c=this.props,d=c.isGroupChat,e=c.onRTCNuxCloseButtonClick,f=c.rtcNuxShown,g=c.thread,h=c.threadID;c=c.viewer;if(d){if(!g||g.participants.length<=1||!b("MercuryThreadInfo").canReply(g))return null;if(g.joinable_mode&&g.joinable_mode.mode===b("MessengerJoinableModeType").JOINABLE)return null}d=babelHelpers["extends"]({isGroupChat:d,onRTCNuxCloseButtonClick:e,rtcCallData:g&&g.rtc_call_data,rtcNuxShown:f&&a.isAudio,threadID:h,thread:g,viewer:c},a);d.className="_3olv"+(d.isAudio?" _2fpc":"")+(d.isAudio?"":" _2fpd");e=this.state.RTCComponent;return b("React").createElement("li",{className:"_3a61"+(d.isAudio?" _461a":"")+(d.isAudio?"":" _461b"),key:"rtc"+(d.isAudio?"audio":"video")},e?b("React").createElement(e,d):b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),d),loader:b("JSResource")("ChatVideoCallButton.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{className:d.className,role:"button"})}))};a.prototype.$17=function(){var a=this.props.thread;return!!a&&b("MercuryThreadInfo").showComposer(a)&&!b("isEmpty")(a.participants)&&!b("MessageRequestUtils").isMessageRequest(a)&&!b("MercuryConfig").ViewerIsReadOnly&&!(b("MercuryConfig").ColdOpenBlock&&(b("MercuryThreadInfo").isColdOpen(a)||b("MercuryThreadInfo").isEmptyLocalThread(a)))&&!(this.props.isPageChat&&a.message_count===0)};a.prototype.$15=function(){__p&&__p();if(!this.$17())return null;var a=this.props,c=a.thread;a=a.isNewMessageTab;if(a||!!c&&c.folder===b("MessagingTag").PENDING)return null;a={attachmentsShelf:this.props.attachmentsShelf,composer:this.props.composer,hasBlockedMessages:this.props.hasBlockedMessages,isGroupChat:this.props.isGroupChat,isMultiCompany:this.props.isMultiCompany,isMuted:this.props.isMuted,isPageChat:this.props.isPageChat,membershipParticipants:this.props.membershipParticipants,participants:this.props.participants,sheetController:this.props.sheetController,thread:this.props.thread,threadID:this.props.threadID,uri:this.props.uri,viewer:this.props.viewer};a.className="_3olv _1ll-";c=i._("Options");var d=!1;if(this.props.threadID){var e=b("EventReminderStateStore").getEvent(this.props.threadID);d=e&&!e.exists&&!this.state.eventPlanNuxSeen&&b("EventPlanExperiment").shouldShowEntryPointNuxWithExposure()}return b("React").createElement("div",{key:"menu"},b("React").createElement("li",{className:"_3a61 _461_",ref:"menu"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),a),loader:b("JSResource")("ChatTabMenu.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{className:a.className,"aria-label":c,role:"button"})})),b("React").createElement(b("XUIAmbientNUX.react"),{alignment:"right",behaviors:{LayerFadeOnHide:b("LayerFadeOnHide")},contextRef:this.$18,onCloseButtonClick:this.$19,shown:d,width:"auto"},i._("Click here to start a new plan.")))};a.prototype.$12=function(){if(this.props.isNewMessageTab||this.props.isPageChat||this.props.isMultiCompany&&!this.props.isGroupChat||this.$7())return null;var a={className:"_3olv _3jyj",isFBAtWork:this.props.isWorkUser,shouldAddToApprovalQueue:b("MessengerAdminGroupUtils").shouldAddToApprovalQueue(this.props.thread,this.props.viewer),shown:!0,onClick:function(){return this.props.sheetController.openAddFriendsSheet()}.bind(this),thread:this.props.thread,viewer:this.props.viewer},c=i._("Add");return b("React").createElement("li",{className:"_3a61 _4620",key:"add"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),a),loader:b("JSResource")("ChatAddToThreadButton.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":c,className:a.className,role:"button"})}))};a.prototype.$11=function(){var a=this.props,c=a.href,d=a.isNewMessageTab,e=a.isPageChat;a=a.isWorkUser;if(d||e||this.$7()||a||!b("ChatConfig").getBool("expand_button_in_header"))return null;b("QE2Logger").logExposureForUser("messenger_chat_tabs_expand_to_m_dot_com");d={className:"_3olv _6pty _6reg",shown:!0,linkToExpand:c};e=i._("Expand in a new window");return b("React").createElement("li",{className:"_3a61 _6pr0",key:"expand"},b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":e,className:d.className,href:c,role:"button"})},b("React").createElement(m,d))))};a.prototype.$9=function(){if(!this.props.isViewerEmployee)return null;var a=this.props.participants;a=a?a.length>0&&a.every(function(a){return!!(a&&a.employee)}):!1;return!a?null:b("React").createElement("li",{key:"archiveWarning"},b("React").createElement(b("LoadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{shown:!0}),loader:l,placeholder:b("React").createElement("div",null)}))};a.prototype.$10=function(){if(!this.props.isWorkUser||!this.props.isMultiCompany)return null;var a=b("React").createElement(b("AutoFocusableLink.react"),{className:"_kp6",onClick:this.props.onClick,role:"presentation"});return b("React").createElement("li",{key:"multiCompanyBadge"},b("React").createElement("div",{className:"_3olv"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),null,a),loader:b("JSResource")("WorkMultiCompanyChatTooltip.react").__setRef("ChatTabHeader.react"),placeholder:a})))};a.prototype.$20=function(){return b("React").createElement("span",{className:"_3a61"+(this.props.isRaised?"":" _3-99")},b("React").createElement("span",{className:"_3olv _2nlt"}))};a.prototype.$21=function(){__p&&__p();if(!b("gkx")("AT505jRFtG_7w3nhZICN2g5HZo5KZ4FP0G7n7x_oCDMvQmeZOfjSNcbXcUzDHS_pr0yjnx5p-38r7Z_8WJZNypI6"))return null;var a=this.props.threadID?b("MercuryIDs").getUserIDFromThreadID(this.props.threadID):null;if(!this.props.participants)return null;var c=this.props.participants.filter(function(b){return b.fbid===a})[0];if(!c)return null;c=b("WorkChatAvailabilityStatusLoader").isLoaded()&&a?b("WorkChatAvailabilityStatusLoader").getStoreEnforce().getDescriptionWithUserName(c.short_name,a):"";return b("React").createElement("span",{className:"_4jft"},b("React").createElement(b("Image.react"),{"data-tooltip-content":c,"data-hover":"tooltip",src:g("550341")}))};a.prototype.$5=function(){var a=this.props.thread,c=this.props.tooltip;b("gkx")("AT6Pi2a8MKJnWbIzTtkE83l3SQto_q6iFEUcjRzrX_KWbZvaeUi7XiJBSppF6WZHWLawAEgGrQhXyShvNLt7lgt3")&&a&&a.is_canonical&&(c="");return b("React").createElement(b("ChatTitleLink.react"),babelHelpers["extends"]({href:this.props.isRaised?this.props.href:undefined,isNewMessageTab:this.props.isNewMessageTab,thread:this.props.thread,viewer:this.props.viewer},b("TooltipData").propsFor(c,"above")))};a.prototype.$3=function(){var a=this.props,c=a.isRaised;a=a.thread;return!c&&a&&a.unread_count>0?b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{className:"_3-8_ _3-99",count:a.unread_count,type:"special"}),loader:b("JSResource")("XUIBadge.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement("span",null)}):b("React").createElement(b("React").Fragment,null,this.$21(),this.$20())};a.propTypes={attachmentsShelf:c.object.isRequired,composer:c.object,hasBlockedMessages:c.bool.isRequired,href:c.string,isActive:c.bool.isRequired,isEmptyChat:c.bool,isGroupChat:c.bool,isMuted:c.bool,isPageChat:c.bool,isRaised:c.bool,isTyping:c.bool,isViewerEmployee:c.bool,isWorkUser:c.bool,onClick:c.func.isRequired,onCloseClick:c.func.isRequired,onRTCNuxCloseButtonClick:c.func.isRequired,participants:c.arrayOf(c.object),rtcNuxShown:c.bool.isRequired,sheetController:c.object.isRequired,thread:c.object,threadID:c.string,tooltip:c.string,uri:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("getGroupNameTooltipFromParticipantIDs",["fbt","MercuryViewer","MessengerParticipants.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=10,i="\n";function a(a,c){__p&&__p();var d=[],e=b("MercuryViewer").getID();a=a&&a.filter(function(a){return a!==e});if(!a||!a.length){c(null);return}var f=a.length,j=f-h;j>1&&(a=a.slice(0,h));b("MessengerParticipants.bs").getMulti(a,function(a){for(var b in a){var e=a[b];d.push(e.name)}if(j>1){e=g._("and {number of hidden chat participants} more.",[g._param("number of hidden chat participants",j)]);d.push(e)}c(d.join(i))})}function c(a){__p&&__p();var c=[],d=b("MercuryViewer").getID();a=a&&a.filter(function(a){return a!==d});if(!a||!a.length)return null;c=a.map(function(a){a=b("MessengerParticipants.bs").getNow(a);return a&&a.name}).filter(function(a){return!!a});a=a.length-(a.length-c.length)-h;if(a>1){c=c.slice(0,h);a=g._("and {number of hidden chat participants} more.",[g._param("number of hidden chat participants",a)]);c.push(a)}return c.join(i)}e.exports={getGroupNameTooltipFromParticipantIDs:c,getGroupNameTooltipFromParticipantIDsAsync:a}}),null);
__d("ChatTabHeaderContainer.react",["ChatTabHeader.react","CurrentUser","MercuryIDs","MercuryThreadInfo","React","WorkModeConfig","getGroupNameTooltipFromParticipantIDs","getPageIDFromThreadID","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(a){g.constructor.call(this,a),this.state=this.calculateState(a)}a.prototype.calculateState=function(a){var c=!1,d;if(a.threadID){var e;c=a.isNewMessageTab?(((e=a.thread)==null?void 0:(e=e.participants)==null?void 0:e.length)||0)>2:b("MercuryIDs").isGroupChat(a.threadID);d=b("getPageIDFromThreadID")(a.threadID)}return{isGroupChat:c,pageID:d}};a.prototype.componentDidMount=function(){this.props.onMount&&this.props.onMount(this)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.setState(this.calculateState(a))};a.prototype.render=function(){var a=this.props.participants&&this.props.participants.toList().toArray(),c=this.props,d=c.isNewMessageTab;c=c.thread;var e;c&&(e=h(c.participants));var f=c&&c.participants&&c.participants.length===0;return b("React").createElement(b("ChatTabHeader.react"),{attachmentsShelf:this.props.attachmentsShelf,composer:this.props.composer,hasBlockedMessages:this.props.hasBlockedMessages,href:this.props.href,isActive:this.props.isActive,isEmptyChat:f,isGroupChat:this.state.isGroupChat,isMultiCompany:this.props.isMultiCompany,isMuted:!!c&&b("MercuryThreadInfo").isMuted(c),isNewMessageTab:this.props.isNewMessageTab,isPageChat:!!this.state.pageID,isRaised:this.props.isRaised,isTyping:this.props.isTyping,isViewerEmployee:b("CurrentUser").isEmployee(),isWorkUser:!!b("WorkModeConfig").is_work_user,membershipParticipants:this.props.membershipParticipants,onClick:this.props.onClick,onCloseClick:this.props.onCloseClick,onRTCNuxCloseButtonClick:this.props.onRTCNuxCloseButtonClick,participants:a,ref:"header",rtcNuxShown:this.props.rtcNuxShown,sheetController:this.props.sheetController,thread:c,threadID:d&&c!=null?c.thread_id:this.props.threadID,uri:this.props.uri,tooltip:e,viewer:this.props.viewer})};a.prototype.focus=function(){this.refs.header.focus()};a.propTypes={attachmentsShelf:c.object.isRequired,composer:c.object,isActive:c.bool.isRequired,isRaised:c.bool,isTyping:c.bool,onClick:c.func.isRequired,onCloseClick:c.func.isRequired,onMount:c.func,onRTCNuxCloseButtonClick:c.func.isRequired,rtcNuxShown:c.bool.isRequired,sheetController:c.object.isRequired,thread:c.object,threadID:c.string,uri:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("ChatDetailStack.bs",["ReasonReact.bs","ChatDetailStack.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("ReasonReact.bs").wrapJsForReason(b("ChatDetailStack.react"),{topDetail:a,bottomDetail:c},d)}f.make=a}),null);
__d("ChatTabMenu.bs",["MercuryIDs","ReasonReact.bs","bs_js_primitive","MessengerState.bs","bs_js_null_undefined","getPageIDFromThreadID","ChatTabMenuBootloader.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e,f,g,h,i,j,k,l,m){var n=a?[a[0].thread_id]:0;if(n){var o=n[0];o=[b("MercuryIDs").isGroupChat(o),b("MessengerState.bs").isNewEmptyLocalThread(c,o),b("bs_js_primitive").null_undefined_to_opt(b("getPageIDFromThreadID")(o))!==0]}else o=[!1,!0,!1];var p=a?a[0].message_count===0:!0;return b("ReasonReact.bs").wrapJsForReason(b("ChatTabMenuBootloader.react"),{autoFocus:!1,composer:d,hasBlockedMessages:g,highlightNewMessage:j,isEmptyChat:o[1],isEmptyConversation:p,isFocused:i,isGroupChat:o[0],isMultiCompany:h,isPageChat:o[2],membershipParticipants:b("bs_js_null_undefined").fromOption(e),participantsMap:b("bs_js_null_undefined").fromOption(f),isNewMessageTab:k,thread:b("bs_js_null_undefined").fromOption(a),threadID:b("bs_js_null_undefined").fromOption(n),uri:l,viewer:c},m)}f.make=a}),null);
__d("ChatThreadName.bs",["cx","React","goURI","LinkReact.bs","MercuryIDs","ReasonReact.bs","MessengerHoverCardLink","MercuryThreadTitleReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("ChatThreadName");function a(a,c,d,e,f,g,i){__p&&__p();return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){__p&&__p();if(a){var h=a[0],i=h.thread_id,j=b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[d],[f],0,["tooltip"],[d],0,0,[c],0,[function(a){if(c.length>0){b("goURI")(c,undefined,undefined);a.stopPropagation();return 0}else return 0}],0,0,0,0,0,0,0,[b("ReasonReact.bs").element(0,0,b("MercuryThreadTitleReact.bs").make(["_1ogo"],0,h,e,[g],0,[!h.is_canonical],[!0],[]))]));if(h.is_canonical){h=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(i)});return b("React").cloneElement(j,{"data-hovercard":h,"data-hover":""})}else return j}else return null},h[9],h[10],h[11],h[12]]}f.component=h;f.make=a}),null);
__d("ChatVideoCallButton.bs",["MercuryIDs","ReasonReact.bs","bs_js_primitive","bs_js_null_undefined","ChatVideoCallButtonBootloader.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e,f,g,h,i){__p&&__p();a=a?a[0]:!0;c=c?c[0]:function(){return 0};d=d?d[0]:!1;h=h?h[0]:!0;if(f){var j=f[0];j=[[j.thread_id],b("bs_js_primitive").null_undefined_to_opt(j.rtc_call_data)]}else j=[0,0];var k=j[1];k=k?k[0]:{call_state:"NO_ONGOING_CALL",server_info_data:null,initiator_fbid:null};j=b("bs_js_null_undefined").fromOption(j[0]);var l=b("MercuryIDs").isGroupChat(j);return b("ReasonReact.bs").wrapJsForReason(b("ChatVideoCallButtonBootloader.react"),{isAudio:a,isGroupChat:l,color:e?e[0]:null,onRTCNuxCloseButtonClick:c,rtcNuxShown:d,threadID:j,thread:b("bs_js_null_undefined").fromOption(f),viewer:g,shown:h,rtcCallData:k},i)}f.make=a}),null);
__d("FantaCloseButton.bs",["ix","cx","fbt","bs_curry","asset","LinkReact.bs","ImageReact.bs","ReasonReact.bs","TrackingNodes","TrackingNodeTypes"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("ReasonReact.bs").statelessComponent("FantaCloseButton");function a(a,c,d){return[j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],function(){var d=b("TrackingNodes").getTrackingInfo(b("TrackingNodeTypes").CLOSE_BUTTON),e=c?i._("Press Esc to close"):i._("Close tab");return b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[e],["_40qq _4vu4 button"],[d],["tooltip"],[e],0,["above"],0,0,[function(c){c.stopPropagation();return b("bs_curry")._1(a,c)}],0,0,0,0,0,0,0,[b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(["close"],0,0,0,[g("393091")],0,0,0,0,[]))]))},j[9],j[10],j[11],j[12]]}f.component=j;f.make=a}),null);
__d("SplitImage.bs",["ReasonReact.bs","SplitImage.react","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f){return b("ReasonReact.bs").wrapJsForReason(b("SplitImage.react"),{border:b("bs_js_null_undefined").fromOption(e),size:a,srcs:c,className:b("bs_js_null_undefined").fromOption(d)},f)}f.make=a}),null);
__d("FantaProfilePresence.bs",["cx","React","goURI","gkx","LinkReact.bs","bs_caml_array","ImageReact.bs","MercuryIDs","SplitImage.bs","ReasonReact.bs","bs_js_primitive","MessengerHoverCardLink"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("FantaProfilePresence");function i(a,c,d,e,f,g,i,j,k){__p&&__p();var l=j?j[0]:"";return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){__p&&__p();var h=b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")&&a.length>1;if(h){var j=Math.round(c/3)|0;j=c-j|0;j=b("React").createElement("div",{className:"_44yp",style:{height:c.toString()+"px",width:c.toString()+"px"}},b("React").createElement("div",{className:"_1gyw"},b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(0,[""],0,0,[b("bs_caml_array").caml_array_get(a,0)],[j],0,[j],0,[]))),b("React").createElement("div",{className:"_1gyw",style:{borderColor:l}},b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(0,[""],0,0,[b("bs_caml_array").caml_array_get(a,1)],[j],0,[j],0,[]))))}else j=b("ReasonReact.bs").element(0,0,b("SplitImage.bs").make(c,a,["_1gyw"],e,[]));j=b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[i],["_2yg8"],0,["tooltip"],[i],0,0,[g],0,[function(a){if(g.length>0){b("goURI")(g,undefined,undefined);a.stopPropagation();return 0}else return 0}],0,0,0,0,[-1],0,0,[j]));if(f){var k=f[0];if(k.is_canonical){k=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(k.thread_id)});k=b("React").cloneElement(j,{"data-hovercard":k})}else k=j}else k=j;return b("React").createElement("div",{"aria-hidden":!0,className:"_ro7"+(h?" _44yq":"")},k,d?b("React").createElement("div",{className:"_1gyx",style:{borderColor:l}}):null)},h[9],h[10],h[11],h[12]]}a=b("ReasonReact.bs").wrapReasonForJs(h,function(a){return i(a.images,a.imageSize,a.isActive,b("bs_js_primitive").null_undefined_to_opt(a.border),b("bs_js_primitive").null_undefined_to_opt(a.thread),a.threadHref,a.tooltip,b("bs_js_primitive").null_undefined_to_opt(a.backgroundColor),[])});f.component=h;f.make=i;f.jsComponent=a}),null);
__d("FantaM4Header.bs",["cx","fbt","cssVar","React","gkx","MercuryIDs","bs_belt_Option","ChatTabMenu.bs","ReasonReact.bs","bs_js_primitive","ChatThreadName.bs","ChatDetailStack.bs","FantaCloseButton.bs","ArchiveWarningReact.bs","ChatVideoCallButton.bs","FantaProfilePresence.bs","MessengerParticipants.bs","getPageIDFromThreadID","getGroupNameTooltipFromParticipantIDs"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("ReasonReact.bs").statelessComponent("FantaM4Header");function k(a,c){__p&&__p();if(a){a=a[0].valueSeq().filter(function(a){return!(a.image_src==null)}).map(function(a,d,e){d=b("bs_belt_Option").getExn(b("bs_js_primitive").null_undefined_to_opt(a.image_src));return[d,a.fbId!==c]}).take(4).toArray();var d=a.length>3;d=d?a.filter(function(a){return a[1]}):a;return d.slice(0,3).map(function(a){return a[0]})}else return[]}function l(a,c,d){__p&&__p();if(a){a=a[0];var e=a.image_src;if(e==null){a=b("MercuryIDs").getParticipantIDFromFromThreadID(a.thread_id);if(a==null)return k(c,d);else{c=b("MessengerParticipants.bs").getNow(a);if(c==null)return[];else{d=c.image_src;if(d==null)return[];else return[d]}}}else return[e]}else return[]}function m(a){__p&&__p();if(a){a=a[0];if(a.is_canonical)return"";else{a=b("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs(a.participants);if(a==null)return"";else return a}}else return""}function n(a,c,d,e,f,g,i,k,n,o,p,q,r,s,t,u,v,w,x){__p&&__p();var y=s?s[0]:"";return[j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],function(){__p&&__p();var j=l(r,p,t),s=r?b("bs_js_primitive").null_undefined_to_opt(b("getPageIDFromThreadID")(r[0].thread_id)):0,z=h._("Active now");s=s||!e?null:b("React").createElement("div",{"aria-label":z,role:"presentation"},z);if(p){z=p[0];var A=z.filter(function(b,a,c){return b.employee});A=z.count()>0&&A.count()===z.count()}else A=!1;z=m(r);if(r){var B=r[0].header_color;B=B==null?["#0084ff"]:[B]}else B=["#0084ff"];B=d?B?[["#FFFFFF"],B[0]]:[["#bec2c9"],""]:B?f?[[B[0]],""]:[["#bec2c9"],""]:[["#bec2c9"],""];var C=B[1];B=B[0];var D=b("gkx")("AT6xa_Prh72hnOTDQ3aoezexBws-l47wdubCJdahCNHN_M0yvNIVgO3a6G_ArwG33iWNx1YBgXNCaMdq6kvMfM0Y");D=d?D?"_69pt _2mgn _3566":"_69pt _2mgn":"_69pt";var E=v?h._("New message"):b("ReasonReact.bs").element(0,0,b("ChatThreadName.bs").make(r,y,z,t,"_2mgq",v,[]));A=v?null:A?b("React").createElement("div",{className:"_69r-"},b("React").createElement("div",{className:"_1v1u"},b("ReasonReact.bs").element(0,0,b("ArchiveWarningReact.bs").make(A,[]))),s):s;return b("React").createElement("div",{className:D,style:{backgroundColor:C},onClick:n},b("React").createElement("div",{className:"_66n2"},v?null:b("ReasonReact.bs").element(0,0,b("FantaProfilePresence.bs").make(j,32,u?!0:e,[!0],r,y,z,[C],[])),b("React").createElement("div",{className:"_66n3"+(v?" _6dtv":"")},b("ReasonReact.bs").element(0,0,b("ChatDetailStack.bs").make(E,A,[])),r&&!v?b("React").createElement("div",{className:"_69ae"},b("React").createElement("div",{className:"_66n5 _1iti"},b("ReasonReact.bs").element(0,0,b("ChatVideoCallButton.bs").make([!1],0,0,B,r,t,0,[]))),b("React").createElement("div",{className:"_66n5 _1iti"},b("ReasonReact.bs").element(0,0,b("ChatVideoCallButton.bs").make([!0],[o],[q],B,r,t,0,[]))),b("React").createElement("div",{className:"_66n5"},b("ReasonReact.bs").element(0,0,b("ChatTabMenu.bs").make(r,t,a,i,p,c,g,f,d,v,w,[])))):null)),b("ReasonReact.bs").element(0,0,b("FantaCloseButton.bs").make(k,f,[])))},j[9],j[10],j[11],j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){return n(a.composer,a.hasBlockedMessages,a.highlightNewMessage,a.isActive,a.isFocused,a.isMultiCompany,b("bs_js_primitive").null_undefined_to_opt(a.membershipParticipants),a.onClose,a.onHeaderToggle,a.onRTCNuxCloseButtonClick,b("bs_js_primitive").null_undefined_to_opt(a.participants),a.rtcNuxShown,b("bs_js_primitive").null_undefined_to_opt(a.thread),[a.threadHref],a.viewer,b("bs_js_primitive").null_undefined_to_opt(a.pageIndicatorDescription),a.isNewMessageTab,a.uri,[])});c=32;d=20;f.component=j;f.profile_image_size=c;f.small_profile_image_size=d;f.getUpTo3Images=k;f.getProfileImages=l;f.getTooltip=m;f.make=n;f.jsComponent=a}),null);
__d("XGroupCallNuxController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groupcall/nux/",{action:{type:"String",required:!0}})}),null);
__d("FantaChatHeaderContainer.react",["cx","AsyncRequest","Bootloader","ChatTabHeaderContainer.react","FantaAvailableStatus","FantaM4Header.bs","FantaTabActions","FantaTabSheetActions","MercuryIgnoredBlockedParticipants.bs","React","XGroupCallNuxController","gkx","immutable","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("FantaM4Header.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=!1,this.state={rtcNuxShown:!1},this.$7=function(){var a=this.props.threadID;b("FantaTabSheetActions").openAddMoreFriendsSheet(a)}.bind(this),this.$4=function(event){this.props.onClose&&this.props.onClose(),event.preventDefault()}.bind(this),this.$5=function(event){var a=event.target,c=a&&a.classList&&a.classList.contains("button");a=a&&(a.tagName==="svg"||a.ownerSVGElement!=null);if(c||a)return;event.stopPropagation();b("FantaTabActions").minimizeTab(this.props.threadID)}.bind(this),this.$6=function(event){this.$3();var a=event.target;if(!a)return;(a.getAttribute("role")==="presentation"||a.classList&&(a.classList.contains("_15p6")||a.classList.contains("_2nlt")||a.classList.contains("_14lt")))&&(event.stopPropagation(),b("FantaTabActions").minimizeTab(this.props.threadID))}.bind(this),this.$3=function(){if(this.state.rtcNuxShown&&this.$1){this.setState({rtcNuxShown:!1});var a=b("XGroupCallNuxController").getURIBuilder().setString("action","dismiss").getURI();new(b("AsyncRequest"))(a).send()}}.bind(this),c}a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return c.threadHref!==a.threadHref||c.highlightNewMessage!==a.highlightNewMessage||c.isFocused!==a.isFocused||c.viewer!==a.viewer||c.threadID!==a.threadID||c.isLastGroupTab!==a.isLastGroupTab||c.thread!==a.thread||d.rtcNuxShown!==b.rtcNuxShown||c.customColor!==a.customColor||c.blockedIDs!==a.blockedIDs||!c.membershipParticipants&&!!a.membershipParticipants||!!c.membershipParticipants&&!!a.membershipParticipants&&!c.membershipParticipants.equals(a.membershipParticipants)||!c.participants&&!!a.participants||!!c.participants&&!!a.participants&&!c.participants.equals(a.participants)};a.prototype.componentDidMount=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_header",JSON.stringify({isNewMessageTab:this.props.isNewMessageTab,hasThread:!!this.props.thread}),0,a)}.bind(this),"FantaChatHeaderContainer.react");this.$1=!0;this.$2()};a.prototype.componentWillUnmount=function(){this.$3(),this.$1=!1};a.prototype.render=function(){var a=this.props,c=a.blockedIDs,d=a.composer,e=a.customColor,f=a.highlightNewMessage,g=a.isFocused,h=a.isNewMessageTab,j=a.membershipParticipants,k=a.pageIndicatorDescription,l=a.participants,m=a.thread,n=a.threadHref,o=a.threadID,p=a.uri;a=a.viewer;var q=this.state.rtcNuxShown,r=e?{color:e}:null;c=!!m&&b("MercuryIgnoredBlockedParticipants.bs").qualifiesAs(a,c,m);if(b("gkx")("AT6A1bnDK2h8UfK21QtwMasCKSCRuJLNl1CkXiFlb4ngyuzOTwnMPylW45yiU1EwI4xsY2mbtMRkoGbbra-xak0V")){var s=b("FantaAvailableStatus").isAvailable(m,o);return b("React").createElement("div",{className:"clearfix titlebar"},b("React").createElement(i,{composer:d,hasBlockedMessages:c,highlightNewMessage:f,isActive:s,isFocused:g,isMultiCompany:this.props.isMultiCompany,isNewMessageTab:!!h,membershipParticipants:j,onClose:this.$4,onHeaderToggle:this.$5,onRTCNuxCloseButtonClick:this.$3,pageIndicatorDescription:k,participants:l,rtcNuxShown:q,thread:m,threadHref:n,uri:p,viewer:a}))}return b("React").createElement("div",{className:"clearfix fbNubFlyoutTitlebar titlebar"+(e?" _1m34":""),style:r},b("React").createElement(b("ChatTabHeaderContainer.react"),{attachmentsShelf:document.createElement("div"),composer:d,hasBlockedMessages:c,href:n,isActive:g,isMultiCompany:this.props.isMultiCompany,isNewMessageTab:!!h,isRaised:!0,isTyping:!1,membershipParticipants:j,onClick:this.$6,onCloseClick:this.$4,onRTCNuxCloseButtonClick:this.$3,participants:l,rtcNuxShown:q,sheetController:{openAddFriendsSheet:this.$7},thread:m,threadID:o,uri:p,viewer:a}))};a.prototype.$2=function(){if(this.props.isLastGroupTab){var a=b("XGroupCallNuxController").getURIBuilder().setString("action","should_show").getURI();new(b("AsyncRequest"))(a).setHandler(function(a){a=a.payload.shouldShow;this.$1&&this.setState({rtcNuxShown:a})}.bind(this)).send()}};a.propTypes={blockedIDs:c.instanceOf(Set).isRequired,customColor:c.string,highlightNewMessage:c.bool,isFocused:c.bool.isRequired,isLastGroupTab:c.bool.isRequired,onClose:c.func.isRequired,thread:c.object,threadID:c.string.isRequired,uri:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("FantaConversation.react",["Bootloader","ChatConversation.react","CurrentUser","EventProfiler","MercuryIDs","MessengerHotLikePreviewEvents","React","StickerInterfaces","StickersTypedLogger","SubscriptionsHandler","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(a){g.constructor.call(this,a),this.$4=function(a){this.props.threadID===a&&this.setState({likePreview:null})}.bind(this),this.$5=function(a,c){if(!a)return;new(b("StickersTypedLogger"))().setEvent("click_sticker").setPackid(a).setStickerid(c).log();b("Bootloader").loadModules(["StickersPackInTray","StickersActions","StickersStoreController"],function(c,d,e){c.onIsPackInTray(a,b("StickerInterfaces").MESSAGES,function(b){b.in_sticker_tray?(d.selectTrayPack(a),d.showStickerFlyout(this.props.threadID)):e.showStore(a)}.bind(this))}.bind(this),"FantaConversation.react")}.bind(this),this.state={likePreview:null},this.$1=new(b("SubscriptionsHandler"))()}a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return!c.onlineUsers.equals(a.onlineUsers)||!c.messages.equals(a.messages)||c.threadID!==a.threadID||c.thread!==a.thread||d.likePreview!==b.likePreview};a.prototype.componentDidMount=function(){this.$2(),this.$3()};a.prototype.componentDidUpdate=function(){this.$3()};a.prototype.componentWillUnmount=function(){this.$1.release()};a.prototype.$3=function(){b("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],!0,"click")};a.prototype.$2=function(){this.$1.addSubscriptions(b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").START,function(a,b){this.props.threadID===b&&this.setState({likePreview:a})}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP,this.$4),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP_EMOJI,this.$4),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").REMOVE,this.$4))};a.prototype.render=function(){var a=this.props.messages,c=this.props,d=c.forGameChat,e=c.onLoadMoreMessages,f=c.thread;c=c.threadID;var g=this.state.likePreview,h=b("CurrentUser").getID();g&&(a=a.push(g));return f?b("React").createElement(b("ChatConversation.react"),{forGameChat:d,isCanonical:b("MercuryIDs").isCanonical(c),loadMoreMessages:e,maxBubbleWidth:181-this.props.scrollbarPadding,messages:a,onAttachmentLoad:function(){return this.props.onAttachmentLoad()}.bind(this),onMount:b("emptyFunction"),onStickerClick:this.$5,onlineUsers:this.props.onlineUsers,readReceipts:this.props.readReceipts,ref:"conversation",thread:f,threadID:c,viewer:h}):b("React").createElement("div",null)};a.prototype.getMessageList=function(){return this.refs.conversation&&this.refs.conversation.getMessageList()};a.propTypes={forGameChat:c.bool.isRequired,messages:c.object.isRequired,onLoadMoreMessages:c.func.isRequired,onlineUsers:c.object.isRequired,scrollbarPadding:c.number,thread:c.object,threadID:c.string.isRequired};e.exports=a}),null);
__d("FantaPageGreetingLoader.react",["cx","BootloadOnRender.react","JSResource","LazyComponent.react","React","getPageIDFromThreadID"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(a){var c=a.thread;a=a.threadID;if(c!=null){c=((c=c)!=null?c.is_canonical_neo_user:c)||!1;if(c)return null}else return null;return b("getPageIDFromThreadID")(a)?b("React").createElement("div",{className:"_av1"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MercuryChatTabPagesGreetingContainer.react").__setRef("FantaPageGreetingLoader.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{threadID:a})})):null};e.exports=a}),null);
__d("MercuryLastMessageIndicator.react",["cx","fbt","CurrentUser","MercuryIDs","MercuryMessageSourceTags","MercuryViewer","MessengerParticipants.bs","MessengerReadReceipt.bs","MessengerTextWithEmoticons.react","React","SubscriptionsHandler","TooltipData","WorkModeConfig","XWorkplaceHomepageMainController","emptyFunction","formatDate","gkx","immutable","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j=b("immutable").Set;c=b("React").PropTypes;var k=function(a,c,d){a=b("MessengerReadReceipt.bs").getSeenTimestamp(a,d,c[0]);d=a.action*.001;return{seenTimestamp:d,seenByData:null}},l=function(a,c,d){__p&&__p();var e={};for(var f=a,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;e[i]=b("MessengerParticipants.bs").getNow(i)}i=null;c&&c.custom_nickname&&(i=c.custom_nickname);h={};g=Object.keys(e);for(var f=0;f<g.length;f++){var j=g[f],k=e[j],l;void 0;!k?l=b("MessengerParticipants.bs").getDefaultName():(l=k.short_name,i&&i[k.fbid]&&(l=i[k.fbid]));h[j]=l}var m;k=!1;j=!1;n(a,d,c)?j=!0:a.length==1?m=" "+h[a[0]]:a.length==2?m=" "+h[a[0]]+", "+h[a[1]]:a.length==3?m=" "+h[a[0]]+", "+h[a[1]]+", "+h[a[2]]:a.length>3&&(m=" "+h[a[0]]+", "+h[a[1]]+", ",k=!0);return{seenTimestamp:null,seenByData:{seenByAll:j,text:m,showTooltip:k,seenBy:a}}},m=function(a,c,d,e){e=b("MessengerReadReceipt.bs").getSeenBy(a,e,!0);if(e.length===0)return{seenTimestamp:null,seenByData:null};var f=b("MercuryIDs").getUserIDFromThreadID(d);if(f)return k(a,e,d);else return l(e,c)},n=function(a,c,d){var e=d?d.participants.length:0;a=a.length;c&&c.author!=b("MercuryViewer").getID()&&(!d||d.participants.indexOf(c.author)>-1)&&a++;return e>2&&a>=e-1};d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={seenTimestamp:null,seenByData:null},b}a.getDerivedStateFromProps=function(a,b){"use strict";return m(a.readReceipts,a.thread,a.threadID,a.lastMessage)};a.prototype.shouldComponentUpdate=function(a,b){"use strict";__p&&__p();if(a.thread!==this.props.thread||a.threadID!==this.props.threadID||a.lastMessage!==this.props.lastMessage||a.isTyping!==this.props.isTyping||a.readReceipts!==this.props.readReceipts||b.seenTimestamp!==this.state.seenTimestamp)return!0;a=this.state.seenByData;b=b.seenByData;if(!a&&!b)return!1;if(!a||!b)return!0;if(a.seenByAll!==b.seenByAll||a.showTooltip!==b.showTooltip||a.text!==b.text)return!0;return!j(a.seenBy).equals(j(b.seenBy))?!0:!1};a.prototype.componentDidUpdate=function(){"use strict";if(!this.isVisible())return;this.props.indicatorDidShow&&this.props.indicatorDidShow()};a.prototype.componentWillUnmount=function(){"use strict";this.$1&&this.$1.release()};a.prototype.$2=function(){"use strict";return!this.props.lastMessage?[]:this.props.lastMessage.source_tags||this.props.lastMessage.tags||[]};a.prototype.$3=function(){"use strict";if(this.props.isTyping)return b("React").createElement("div",{className:this.$4([])},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f",ref:"text"},"\xa0"));var a=this.$2(),c=this.state.seenByData,d=this.state.seenTimestamp;if(c)return b("React").createElement("div",{className:this.$4(a)},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f"},this.$5(c)));else if(d)return b("React").createElement("div",{className:this.$4(a)},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f",ref:"text"},this.$6(d)));else return b("React").createElement("div",{className:this.$4(a)},b("React").createElement("div",{className:"_510h"}),b("React").createElement("span",{className:"_510f",ref:"text"},this.$7(a)))};a.prototype.render=function(){"use strict";return b("CurrentUser").isWorkUser()?this.$3():b("React").createElement("div",{className:"_4gd0"},this.$3())};a.prototype.$6=function(a){"use strict";var c=Date.now()*.001,d;a<c-518400?d="M j":a<c-86400?d="D g:ia":d="g:ia";return h._("Seen {timestamp}",[h._param("timestamp",b("formatDate")(a,d))])};a.prototype.$7=function(a){"use strict";__p&&__p();if(a.includes(b("MercuryMessageSourceTags").MESSENGER))if(!b("WorkModeConfig").is_work_user)return b("React").createElement("a",{href:"/mobile/messenger",className:"fcg",target:"_blank"},h._("Sent from Messenger"));else return b("React").createElement("a",{href:"https://www.facebook.com/workplace/mobile/",className:"fcg",target:"_blank"},h._("Sent from Workplace Chat"));else if(a.includes(b("MercuryMessageSourceTags").MOBILE)){var c=b("WorkModeConfig").is_work_user?"/workplace/mobile":"/mobile";return b("React").createElement("a",{href:c,className:"fcg",target:"_blank"},h._("Sent from Mobile"))}else if(a.includes(b("MercuryMessageSourceTags").EMAIL))return b("React").createElement("span",null,h._("Sent from email"));else if(a.includes(b("MercuryMessageSourceTags").WORK_DESKTOP)){c=b("XWorkplaceHomepageMainController").getURIBuilder().setString("path","chat-app").setString("ref","last-message-indicator").getURI();return b("React").createElement("a",{href:c,className:"fcg",target:"_blank"},h._("Sent from the desktop app"))}return null};a.prototype.$4=function(a){"use strict";var c=this.props.lastMessage&&this.props.lastMessage.author&&b("MercuryViewer").isViewer(this.props.lastMessage.author);c="_510g"+(c?" _510e":"");var d=null;this.props.isTyping?d=null:this.state.seenByData!==null||this.state.seenTimestamp!==null?d="seen":a.includes(b("MercuryMessageSourceTags").MESSENGER)||a.includes(b("MercuryMessageSourceTags").MOBILE)?d="sentFromMobile":a.includes(b("MercuryMessageSourceTags").WORK_DESKTOP)?d="sentFromDesktop":a.includes(b("MercuryMessageSourceTags").EMAIL)&&(d="sentFromEmail");return b("joinClasses")(c,d)};a.prototype.isVisible=function(){"use strict";var a=this.$2();return a.includes(b("MercuryMessageSourceTags").MESSENGER)||a.includes(b("MercuryMessageSourceTags").MOBILE)||a.includes(b("MercuryMessageSourceTags").EMAIL)||a.includes(b("MercuryMessageSourceTags").WORK_DESKTOP)?!0:this.state.seenTimestamp!==null||this.state.seenByData!==null};a.prototype.$5=function(a){"use strict";__p&&__p();var c=a.seenByAll;if(c)return h._("Seen by everyone");c=a.text;if(!c)return null;c=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoji:!0,renderEmoticons:!0,text:c});var d=a.showTooltip;if(!d)return h._("Seen by {names}",[h._param("names",c)]);else{d=this.$8(a);return h._("Seen by {names}{=num more link}",[h._param("names",c),h._param("=num more link",d)])}};a.prototype.$8=function(a){"use strict";__p&&__p();if(!a.text||!a.showTooltip)return null;var c={},d=0,e=null;b("MessengerParticipants.bs").getMulti(a.seenBy,function(b){e=a.seenBy.map(function(a){return b[a].name}).join("\r\n"),d=Object.keys(b).length-2});c=Object.assign({"data-tooltip-alignh":"center"},b("TooltipData").propsFor(e,"above"));var f=h._({"*":"{num} more"},[h._param("num",d,[0])]);return b("React").createElement("span",babelHelpers["extends"]({className:"more"},c),f)};a.propTypes={indicatorDidShow:c.func,lastMessage:c.object,readReceipts:c.object,threadID:c.string.isRequired,isTyping:c.bool.isRequired};a.defaultProps={indicatorDidShow:b("emptyFunction")};e.exports=a}),null);
__d("MercuryQuickReply.react",["cx","BootloadedComponent.react","JSResource","MercuryIDs","MessengerQuickCamOrigins","MessengerQuickReplyUtils","MessengerViewerContactMethodsWebGraphQLQuery","React","WebGraphQL","XUISpinner.react","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={viewerEmail:null,viewerPhone:null},b}a.prototype.componentDidMount=function(){this.$1(this.props.lastMessage)!==null&&this.props.quickReplyDidShow()};a.prototype.componentDidUpdate=function(a){this.$1(this.props.lastMessage)!==null&&this.$1(a.lastMessage)===null&&this.props.quickReplyDidShow(),this.$2(this.props.lastMessage)};a.prototype.render=function(){__p&&__p();var a=this.props.lastMessage,c=b("MercuryIDs").getParticipantIDFromUserID(this.props.viewer);if(!a||a.author===c)return null;c=this.$1(a);if(Array.isArray(c)){var d=c.every(function(a){return a.content_type==="user_email"&&this.state.viewerEmail===null||a.content_type==="user_phone_number"&&this.state.viewerPhone===null}.bind(this));if(!d){d=b("MessengerQuickReplyUtils").localizeTitleIfNecessary(c);return b("React").createElement("div",{className:"_419m"},b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("MessengerBotsQuickReplyButtonList.react").__setRef("MercuryQuickReply.react"),bootloadPlaceholder:b("React").createElement(b("XUISpinner.react"),{className:"_5h-9"}),isSponsored:a.is_sponsored,messageId:a.message_id,options:d,pageId:b("MercuryIDs").getUserIDFromParticipantID(a.author),threadID:a.thread_id,quickCamOriginLocation:this.props.quickCamOriginLocation,viewer:this.props.viewer,viewerEmail:this.state.viewerEmail,viewerPhone:this.state.viewerPhone}))}}return null};a.prototype.$1=function(a){a=a&&a.platform_xmd&&JSON.parse(a.platform_xmd);return Array.isArray(a&&a.quick_replies)?a&&a.quick_replies:null};a.prototype.$2=function(a){__p&&__p();a=this.$1(a);if(!a||a.length===0)return;a.some(function(a){return a.content_type==="user_email"||a.content_type==="user_phone_number"})&&b("promiseDone")(b("WebGraphQL").exec(new(b("MessengerViewerContactMethodsWebGraphQLQuery"))({})),function(a){var b;b=(b=a)!=null?(b=b.viewer)!=null?(b=b.user)!=null?b.all_phones:b:b:b;a=(a=a)!=null?(a=a.viewer)!=null?a.all_emails:a:a;var c=b?b.find(function(a){return a.is_preferred}):null;!c&&b&&(c=b[0]);b=a?a.find(function(a){return a.is_primary}):null;this.setState({viewerEmail:(a=b)!=null?a.display_email:a,viewerPhone:(b=c)!=null?(b=b.phone_number)!=null?b.universal_number:b:b})}.bind(this))};a.propTypes={quickReplyDidShow:c.func.isRequired,lastMessage:c.object,quickCamOriginLocation:c.oneOf(b("MessengerQuickCamOrigins").getValues()).isRequired,threadID:c.string.isRequired,viewer:c.string.isRequired};e.exports=a}),null);
__d("MessengerTabsThreadSearchLoader",["Promise","Bootloader","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={_store:null,_actions:null,_promise:null,getStoreEnforce:function(){b("nullthrows")(this._store,"Tab thread search store is not loaded");return this._store},getActionsEnforce:function(){b("nullthrows")(this._actions,"Tab thread search actions are not loaded");return this._actions},isLoaded:function(){return this._store&&this._actions},load:function(){this._promise||(this._promise=new(b("Promise"))(function(a){b("Bootloader").loadModules(["MessengerThreadSearchActions","MessengerTabsThreadSearchStore"],function(b,c){this._store=c.get(),this._actions=b,a({store:c,actions:b})}.bind(this),"MessengerTabsThreadSearchLoader")}.bind(this)));return this._promise}};e.exports=a}),null);
__d("FantaConversationScroller.react",["ix","cx","csx","fbt","Animation","Arbiter","BootloadedComponent.react","Bootloader","BootloadOnRender.react","ChatThread","ChatTypingIndicatorsWrapper.react","CurrentUser","ErrorBoundary.react","Event","FantaConversation.react","FantaPageGreetingLoader.react","FantaTabActions","Grid.react","Image.react","JSResource","LazyComponent.react","Link.react","MercuryAttachment","MercuryConfig","MercuryIDs","MercuryLastMessageIndicator.react","MercuryQuickReply.react","MercuryShareAttachmentRenderLocations","MessengerHotLikePreviewEvents","MessengerParticipants.bs","MessengerQuickCamOrigins","MessengerTabsThreadSearchLoader","MessengerVideoAutoplayActions","MessengerVideoAutoplayStore","Parent","QE2Logger","React","ReactDOM","Scroll","ScrollBoundaryContain","Style","SubscriptionsHandler","TimeSlice","WebMessengerConstants","WorkBotLandingPageHelper","XUIButton.react","XUISpinner.react","immutable","asset","clearImmediate","emptyFunction","getElementPosition","getPageIDFromThreadID","gkx","isEventSupported","joinClasses","performanceAbsoluteNow","promiseDone","setImmediate","shallowEqual","throttle"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l=b("ChatThread").ChatThread,m=b("WorkBotLandingPageHelper").shouldShowBotLandingPage,n=b("Grid.react").GridItem;c=b("React").PropTypes;var o=15,p=null,q=20,r=1e3;function s(a){__p&&__p();if(p===null){var c=a.firstElementChild;if(c){b("Style").set(a,"overflow","scroll");var d=c.clientWidth;b("Style").set(a,"overflow","hidden");c=c.clientWidth;p=Math.max(c-d,0);b("Style").set(a,"overflow","")}else p=0}return p}d=babelHelpers.inherits(a,b("React").Component);k=d&&d.prototype;function a(a){__p&&__p();k.constructor.call(this,a),this.$9=[],this.state={loadingMessages:!this.props.isEmptyLocalThread,scrollbarPadding:p===null?o:p,hideLastMessageIndicator:!1,searchResults:null},this.$20=function(a){a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);a&&(this.$21(),this.$22()&&!this.$23()&&!this.$3&&!this.props.hasFetchedAll&&!(this.state.searchResults&&this.state.searchResults.mid)&&(this.setState({loadingMessages:!0}),this.props.onLoadMoreMessages()),this.$24(),this.$10())}.bind(this),this.$16=function(){__p&&__p();if(!this.refs||this.state.loadingMessages||!this.props.thread){this.$9=[];return}var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer),c=b("getPageIDFromThreadID")(this.props.threadID);if(!a||!c){this.$9=[];return}var d=10,e,f;try{e=a.getBoundingClientRect(),f=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(a){return}if(!f||!e)return;var g=[];this.$8.forEach(function(a){if(!f)return;var h=a.message_id,i=f.getMessageElement(h);if(i){i=i.getBoundingClientRect();i.top>e.top-d&&i.bottom<e.bottom+d&&(g.push(h),this.$9.includes(h)||b("Bootloader").loadModules(["MessengerAdsWebLogger","MNAdsLoggerEventEnum"],function(b,d){b.log(a.ad_client_token,a.ad_id,d.MESSAGE_SEEN_THREAD,!0,h,c)},"FantaConversationScroller.react"))}}.bind(this),this);this.$9=g}.bind(this),this.$26=function(){this.$1=null,b("FantaTabActions").scrollBottomChanged(this.props.threadID,this.$6,this.$27)}.bind(this),this.$27=function(){this.$28(!1),this.$18()}.bind(this),this.$29=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){return b.markerEnd(c.FIRSTCHATTABOPEN_WWW,"SUCCESS",0,a)},"FantaConversationScroller.react")},this.$32=function(a){a=b("Parent").byClass(a.target,"._1dlq");a||this.props.onFocus&&this.props.onFocus()}.bind(this),this.$34=function(a){a.target&&a.target.classList&&a.target.classList.contains("_5wd4")&&(this.props.onFocus&&this.props.onFocus())}.bind(this),this.$6=!0}a.prototype.shouldComponentUpdate=function(a,c){var d=this.props,e=this.state;return!d.onlineUsers.equals(a.onlineUsers)||d.hasFetchedAll!==a.hasFetchedAll||d.isFocused!==a.isFocused||!d.messages.equals(a.messages)||d.showContextBanner!==a.showContextBanner||d.readReceipts!==a.readReceipts||d.thread!==a.thread||d.threadID!==a.threadID||e.loadingMessages!==c.loadingMessages||e.hideLastMessageIndicator!==c.hideLastMessageIndicator||!b("shallowEqual")(e.searchResults,c.searchResults)||d.jumpToMessage!==a.jumpToMessage};a.prototype.componentDidMount=function(){__p&&__p();var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_conversation_scroller",JSON.stringify({messageSize:this.props.messages.size,hasThread:!!this.props.thread}),0,a)}.bind(this),"FantaConversationScroller.react");this.$7=new(b("SubscriptionsHandler"))();this.$11();this.$12();this.$13();b("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$14());this.setState({scrollbarPadding:s(this.refs.scrollContainer),searchResults:this.$15()});this.$10=b("throttle")(this.$16,r);this.$8=this.props.messages.filter(function(a){return a.is_sponsored});this.$10();this.$17()};a.prototype.componentDidUpdate=function(a){__p&&__p();this.$13();if(this.$3){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer),d=this.$3||0;c=c.scrollHeight-d;this.scrollToPosition(c,!1);this.$3=null}if(!a.messages.equals(this.props.messages)){b("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$14());d=a.messages.last();c=this.props.messages.last();if(d!==c&&c&&c.author){a=b("MercuryIDs").getUserIDFromParticipantID(c.author);a===b("CurrentUser").getID()&&(this.scrollToBottom(!1),this.$18())}}this.$19();this.$10()};a.prototype.componentWillUnmount=function(){this.$1&&b("clearImmediate")(this.$1),this.$7.release(),b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,null)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){__p&&__p();var c=this.state.loadingMessages&&a.messages.size>0&&!a.messages.equals(this.props.messages);if(c||a.hasFetchedAll||a.showContextBanner){this.setState({loadingMessages:!1});c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);var d=c.scrollHeight;c=b("Scroll").getTop(c);this.$3=d-c}this.$8=a.messages.filter(function(a){return a.is_sponsored})};a.prototype.$15=function(){return b("MessengerTabsThreadSearchLoader").isLoaded()?b("MessengerTabsThreadSearchLoader").getStoreEnforce().getThreadState(this.props.threadID):null};a.prototype.$17=function(){(b("gkx")("AT5-H1DssNMzHFJnUsWkAc7ZTo_DRYYDCHBxlitySatfbYXgP_km8FqsTzTXC2uX7HeORenaopRdXTYwYznmUFoOqEvkESAzIjmNIdQtgjBCQQ")||b("MercuryConfig").M3CRE)&&b("promiseDone")(b("MessengerTabsThreadSearchLoader").load(),function(a){var b=a.store;a.actions;this.$7.addSubscriptions(b.get().addListener("change",function(){return this.setState({searchResults:this.$15(),loadingMessages:!1})}.bind(this)))}.bind(this))};a.prototype.$13=function(a){a===void 0&&(a=!1),this.$6&&b("TimeSlice").guard(function(){this.scrollToBottom(a)}.bind(this),"post load chat animations",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.renderGroupWave=function(){var a=this.props.thread;return b("MercuryIDs").isLocalThread(this.props.threadID)&&b("gkx")("AT7uCGaYk4KWBCIq3SurfBIwk1DjmbU_QXgSqcY73Sdnw3DJhbzA4qigZjhm4wwYtWnHVZcxghHN6RO33C1W8YjG")&&a&&!a.associated_object&&!a.is_canonical&&!a.thread_fbid?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement(b("XUISpinner.react"),{background:"light",className:"loading",size:"small"}),bootloadLoader:b("JSResource")("ChatWaveImage.react").__setRef("FantaConversationScroller.react"),thread:a,m4Thread:l!=null}):null};a.prototype.maybeRenderNullStateWave=function(){__p&&__p();var a=this.props,c=a.thread;a=a.threadID;if(!c||!c.is_canonical||c.timestamp)return null;b("QE2Logger").logExposureForUser("wave_in_www_null_state");if(!b("MercuryConfig").MNWNS)return null;c=b("MercuryIDs").getParticipantIDFromFromThreadID(a);c=c?b("MessengerParticipants.bs").getNow(c):null;c=c?c.short_name:null;return b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("MessengerNewWavePrompt.react").__setRef("FantaConversationScroller.react"),threadID:a,recipientName:c,entrypoint:"canonical_null_state"})};a.prototype.$24=function(){__p&&__p();var a=this.props.threadID,c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!c)return;var d;try{c=c.getBoundingClientRect(),d=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(a){return}if(!d||!c)return;var e=[],f=b("MessengerVideoAutoplayStore").getMessageIDs(a),g=f||this.$14()||b("immutable").List();g.map(function(a){var c=b("MercuryAttachment").getVideoElem(a,d);c&&e.push([a,c.getBoundingClientRect()])});e.length&&b("MessengerVideoAutoplayActions").onScroll(a,f?null:g,b("immutable").Map(e),c)};a.prototype.$14=function(){return this.props.messages.filter(function(a){return b("MercuryAttachment").isSingleVideoAttachment(a)||b("MercuryAttachment").isSharedVideoAttachmentMessage(a)}).reverse().map(function(a){return a.message_id})};a.prototype.$25=function(a,c){__p&&__p();var d=this.refs.conversation?this.refs.conversation.getMessageList():null;if(!d)return;var e=b("ReactDOM").findDOMNode(this.refs.scrollContainer),f=b("ReactDOM").findDOMNode(this.refs.conversation);d=d.getMessageComponent(a);a=b("ReactDOM").findDOMNode(d);if(!a||!f||!e)return;f=f.getBoundingClientRect().top;a=a.getBoundingClientRect().top;a=Math.abs(a-f)-e.getBoundingClientRect().height/2;this.$6=!1;this.scrollToPosition(Math.max(a,0),!1);b("CurrentUser").isWorkUser()&&d.highlightMessage();var g=c;g&&b("setImmediate")(function(){return g()})};a.prototype.scrollToBottom=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);c&&this.scrollToPosition(c.scrollHeight,a)};a.prototype.scrollToPosition=function(a,c){var d=b("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$5&&this.$5.stop();c?this.$5=new(b("Animation"))(d).to("scrollTop",a).ease(b("Animation").ease.end).duration(400).go():b("Scroll").setTop(d,a)};a.prototype.$23=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);a=a===0?0:a||q;return b("Scroll").getTop(c)+c.clientHeight>=c.scrollHeight-a};a.prototype.$22=function(){var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);return b("Scroll").getTop(a)<a.clientHeight};a.prototype.$18=function(){var a=this.$6;this.$23()?this.$6=!0:this.$6=!1;a!==this.$6&&(this.$1=b("setImmediate")(this.$26))};a.prototype.$11=function(){__p&&__p();var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!a)return;var c=b("isEventSupported")("mousewheel")?"mousewheel":b("isEventSupported")("wheel")?"wheel":"DOMMouseScroll",d=function(){this.$18()}.bind(this),e=function(){a.addEventListener(c,d,{passive:!0})},f=function(){a.removeEventListener(c,d,{passive:!0})};this.$7.addSubscriptions(b("Arbiter").subscribe("overflow-applied-to-body",function(){return this.$13()}.bind(this)),b("Event").listen(a,"mousedown",d),b("Event").listen(a,"mouseup",d),b("Event").listen(a,"mouseenter",e),b("Event").listen(a,"mouseleave",f),{cancel:f},b("Event").listen(a,"scroll",b("throttle")(this.$20,50)));e=b("ScrollBoundaryContain").applyToElem(a);e&&this.$7.addSubscriptions(e)};a.prototype.$12=function(){this.$7.addSubscriptions(b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").START,function(a,b){this.props.threadID===b&&(this.$28(!1),clearInterval(this.$4),this.$4=setInterval(function(){this.$28(!1)}.bind(this),50))}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").FINISH_ANIMATION,function(a){clearInterval(this.$4)}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").FINISH_EMOJI_ANIMATION,function(a){clearInterval(this.$4)}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").REMOVE,function(a){this.props.threadID===a&&clearInterval(this.$4)}.bind(this)))};a.prototype.$30=function(){return b("CurrentUser").isWorkUser()&&b("gkx")("AT4JDYUn5QDz10kQUm3j56rNv0YkUWxFYcsCLtFfBFzqJyNVsspOur5_1q6un6fiUWbmi8I1iVFFPGTd0qKcb9Fr")?m(this.props.messages):this.props.messages.size===0};a.prototype.$31=function(){return b("CurrentUser").isWorkUser()&&b("gkx")("AT4JDYUn5QDz10kQUm3j56rNv0YkUWxFYcsCLtFfBFzqJyNVsspOur5_1q6un6fiUWbmi8I1iVFFPGTd0qKcb9Fr")?m(this.props.messages):!1};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.forGameChat,d=a.hasFetchedAll,e=a.isEmptyLocalThread,f=a.messages,g=a.showContextBanner,h=a.thread;a=a.threadID;var i=b("CurrentUser").getID();e=e||d||g;d=this.state.loadingMessages||!h?b("React").createElement("div",{className:"_1xdl"},b("React").createElement(b("XUISpinner.react"),{background:"light",className:"loading",size:"small"})):null;d||(this.$29(),this.$29=b("emptyFunction"));g=function(){return this.$13()}.bind(this);var k=this.$30()?b("React").createElement(b("FantaPageGreetingLoader.react"),{thread:h,threadID:a}):null;e=e?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("MessengerContextBannerContainer.react").__setRef("FantaConversationScroller.react"),isContinuation:!1,location:b("MercuryShareAttachmentRenderLocations").CHAT,viewer:i,thread:h,threadID:a}):null;var m=b("React").createElement("div",{className:b("joinClasses")("accessible_elem","_2kwv")},j._("Chat conversation start")),o=b("React").createElement("div",{className:b("joinClasses")("accessible_elem","_2kwv")},j._("Chat conversation end")),p=null,q=this.state.searchResults;if(q&&q.messages){var r=j._("Load more...");p=b("React").createElement(b("React").Fragment,null,q.upExhausted?null:b("React").createElement(b("XUIButton.react"),{className:"_41jf",label:r,onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext(b("WebMessengerConstants").MORE_SEARCH_CONTEXT_UP,this.props.threadID)}.bind(this),type:"primary",use:"default"}),b("React").createElement(b("FantaConversation.react"),{forGameChat:c,onAttachmentLoad:g,scrollbarPadding:this.state.scrollbarPadding,ref:"conversation",messages:q.messages,onLoadMoreMessages:b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext,hasFetchedAll:this.props.hasFetchedAll,isFocused:this.props.isFocused,onFocus:this.props.onFocus,onlineUsers:this.props.onlineUsers,readReceipts:this.props.readReceipts,showContextBanner:this.props.showContextBanner,thread:this.props.thread,threadID:this.props.threadID}),q.downExhausted?null:b("React").createElement(b("XUIButton.react"),{className:"_41jf",label:r,onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext(b("WebMessengerConstants").MORE_SEARCH_CONTEXT_DOWN,this.props.threadID)}.bind(this),type:"primary",use:"default"}),b("React").createElement(b("ChatTypingIndicatorsWrapper.react"),{threadID:a,indicatorClass:undefined,indicatorsWillShow:b("emptyFunction"),indicatorsDidShow:function(){return this.setState({hideLastMessageIndicator:!0},function(){this.$13(!0)}.bind(this))}.bind(this),indicatorsDidHide:function(){return this.setState({hideLastMessageIndicator:!1})}.bind(this),rootClassName:undefined,viewer:i,onlineUsers:this.props.onlineUsers}))}else p=b("React").createElement(b("React").Fragment,null,b("React").createElement(b("FantaConversation.react"),babelHelpers["extends"]({forGameChat:c,onAttachmentLoad:g,scrollbarPadding:this.state.scrollbarPadding,ref:"conversation"},this.props)),b("React").createElement(b("MercuryQuickReply.react"),{lastMessage:f.size>0?f.last():undefined,threadID:a,quickReplyDidShow:function(){return this.$13(!0)}.bind(this),viewer:i,quickCamOriginLocation:b("MessengerQuickCamOrigins").CHAT_TAB}),b("React").createElement(b("ChatTypingIndicatorsWrapper.react"),{threadID:a,indicatorClass:undefined,indicatorsWillShow:b("emptyFunction"),indicatorsDidShow:function(){return this.setState({hideLastMessageIndicator:!0},function(){this.$13(!0)}.bind(this))}.bind(this),indicatorsDidHide:function(){return this.setState({hideLastMessageIndicator:!1})}.bind(this),rootClassName:undefined,viewer:i,onlineUsers:this.props.onlineUsers}),this.renderGroupWave(),this.maybeRenderNullStateWave(),b("React").createElement(b("MercuryLastMessageIndicator.react"),{isTyping:this.state.hideLastMessageIndicator,indicatorDidShow:function(){this.$13(!0)}.bind(this),indicatorWillShow:b("emptyFunction"),lastMessage:f.size>0?f.last():null,readReceipts:this.props.readReceipts,thread:h,threadID:a}));q=b("React").createElement("div",{className:"_1xdm"+(d?" _1xdw":"")},b("React").createElement("div",{className:"_1xdx"},b("React").createElement("div",{className:"_1xe8"})),m,e,d,b("React").createElement("div",{style:f.size>0?{height:"176px"}:d?{height:"168px"}:{height:"192px"},className:"_1xdm"},this.$31()?null:p,b("gkx")("AT5LR14w3g9nmjLKlBbu8cp6dDohvGRAgb2EKeLFjLUw4ckGbkEAtvxTKhQkttWbJnopoJSv-Wj26ZhFsXLqkhQ5")&&b("React").createElement(b("ErrorBoundary.react"),{project:"omnim"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("OmniMSuggestionsContainer.react").__setRef("FantaConversationScroller.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{threadID:this.props.threadID,trackBottom:function(){return this.$13(!0)}.bind(this)})}))),o);return l!=null?b("React").createElement(l,{onClick:this.$32,spacerContent:b("React").createElement(b("React").Fragment,null,m,e,k,d),scrollRef:function(a){this.refs.scrollContainer=a}.bind(this)},p,b("gkx")("AT5LR14w3g9nmjLKlBbu8cp6dDohvGRAgb2EKeLFjLUw4ckGbkEAtvxTKhQkttWbJnopoJSv-Wj26ZhFsXLqkhQ5")&&b("React").createElement(b("ErrorBoundary.react"),{project:"omnim"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("OmniMSuggestionsContainer.react").__setRef("FantaConversationScroller.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{threadID:this.props.threadID,trackBottom:function(){return this.$13(!0)}.bind(this)})})),o,this.$33(!0)):b("React").createElement("div",{className:"_2v5j"},b("React").createElement("div",{className:"fbNubFlyoutBody scrollable",onClick:this.$34,ref:"scrollContainer",role:"button",tabIndex:"0"},b("React").createElement("div",{className:"fbNubFlyoutBodyContent"},k,b("React").createElement(b("Grid.react"),{className:"conversationContainer",role:"log",cols:1},b("React").createElement(n,{alignv:"bottom"},q)))),this.$33(!1))};a.prototype.$33=function(a){a=a?{bottom:"14px"}:{bottom:"74px"};return this.state.searchResults&&this.state.searchResults.messages?b("React").createElement(b("Link.react"),{style:a,className:"_2llh",onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,null)}.bind(this)},b("React").createElement(b("Image.react"),{className:"_2llt",src:g("415098")})):null};a.prototype.$19=function(){var a=this.props.jumpToMessage;if(!a)return;this.props.messages.some(function(b){return b.message_id===a})||this.state.searchResults&&this.state.searchResults.messages&&this.state.searchResults.messages.some(function(b){return b.message_id===a})?this.$25(a,function(){return b("FantaTabActions").wipeJumpToMessage(this.props.threadID)}.bind(this)):b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,a)};a.prototype.$21=function(){var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer),c=b("getElementPosition")(a);b("Arbiter").inform("chatScrolled/"+this.props.threadID,{scrollTop:b("Scroll").getTop(a),top:c.y,viewHeight:c.height})};a.prototype.$28=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);c&&this.$35(c.scrollHeight,a)};a.prototype.$35=function(a,c){var d=b("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$5&&this.$5.stop();c===!0?this.$5=new(b("Animation"))(d).to("scrollTop",a).ease(b("Animation").ease.end).duration(400).go():b("Scroll").setTop(d,a)};a.propTypes={forGameChat:c.bool.isRequired,hasFetchedAll:c.bool.isRequired,isEmptyLocalThread:c.bool.isRequired,isFocused:c.bool.isRequired,messages:c.object.isRequired,onFocus:c.func,onLoadMoreMessages:c.func.isRequired,onlineUsers:c.instanceOf(b("immutable").List).isRequired,showContextBanner:c.bool,thread:c.object,threadID:c.string.isRequired,jumpToMessage:c.string};e.exports=a}),null);
__d("FantaDragAndDrop.react",["Bootloader","BootloadOnRender.react","FantaTypeComposer","JSResource","LazyComponent.react","MercuryShareAttachmentRenderLocations","MessengerEnvironment","React","emptyFunction","ifRequired"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=960;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$2=function(a){var b=this.props.composer;this.$5(function(c){c.removeSharePreview(a,b)})}.bind(this),this.$3=function(a,b){var c=this.props.composer;this.$5(function(d){d.loadedShareData(a,b,c)})}.bind(this),this.$4=function(a){var b=this.props.composer;this.$5(function(c){c.loadingShareData(a,b)})}.bind(this),b}a.prototype.componentDidMount=function(){b("MessengerEnvironment").messengerui?b("Bootloader").loadModules(["MessengerActions"],b("emptyFunction"),"FantaDragAndDrop.react"):b("Bootloader").loadModules(["FantaMessageActions"],b("emptyFunction"),"FantaDragAndDrop.react")};a.prototype.shouldComponentUpdate=function(a){var b=this.props,c=b.composer,d=a.composer,e=c.fileUploader,f=e.uploadingFiles;e=e.uploadedFiles;var g=d.fileUploader.uploadingFiles,h=d.fileUploader.uploadedFiles;c=c.sharePreview;d=d.sharePreview;return b.threadID!==a.threadID||!!(!f&&g)||!!(f&&g&&!f.equals(g))||!!(!e&&h)||!!(e&&h&&!e.equals(h))||!!(!c&&d)||!!(c&&d&&!c.equals(d))};a.prototype.render=function(){var a=this.props,c=a.composer;a=a.threadID;var d=c.sharePreview,e=d.share;d=d.uri;c=c.fileUploader;c.uploadingFiles;c.uploadedFiles;return b("React").createElement("div",{className:"fbNubFlyoutAttachments"},b("React").createElement("div",{className:"chatAttachmentShelf"},e||d?b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MercurySharePreview.react").__setRef("FantaDragAndDrop.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{onClose:this.$2,onLoaded:this.$3,onLoading:this.$4,threadID:a,imageSize:{width:h,height:h},location:b("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW,share:e,uri:d})}):null))};a.prototype.$5=function(a){b("MessengerEnvironment").messengerui?b("ifRequired")("MessengerActions",function(b){a(b)},function(){b("Bootloader").loadModules(["MessengerActions"],function(b){a(b)},"FantaDragAndDrop.react")}):b("ifRequired")("FantaMessageActions",function(b){a(b)},function(){b("Bootloader").loadModules(["FantaMessageActions"],function(b){a(b)},"FantaDragAndDrop.react")})};a.propTypes={composer:c.object.isRequired,threadID:c.string.isRequired};e.exports=a}),null);
__d("FantaMercuryTabOverflowBootloader.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a=b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr")?b("JSResource")("FantaM4TabOverflow.react").__setRef("FantaMercuryTabOverflowBootloader.react"):b("JSResource")("FantaMercuryTabOverflow.react").__setRef("FantaMercuryTabOverflowBootloader.react");return b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{items:this.props.items,tabContents:this.props.tabContents}),loader:a,placeholder:b("React").createElement("div",null)})};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaTab.react",["cx","EventProfiler","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=!1,b}a.prototype.componentDidMount=function(){b("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],!0,"click")};a.prototype.render=function(){var a=this.props,c=a.isFocused,d=a.isLastTab,e=a.isLastTabOfType,f=a.MainComponent,g=a.messengerState,h=a.MinimizedComponent,i=a.raisedTabCount,j=a.tab,k=a.tabContent;a=a.forGameChat;h=j.isMinimized?h:f;f=j.id+(j.isMinimized?"-minimized":"-maximized");var l=this.$1&&!j.isMinimized;this.$1=j.isMinimized;return b("React").createElement("div",{className:"_5qi9 _5qib"+(this.props.isFocused?" _5qic":"")+(j.isMinimized?" _3001":"")},b("React").createElement(h,{isFocused:c,isHovered:j.isHovered||l,isLastTab:d,isLastTabOfType:e,key:f,messengerState:g,raisedTabCount:i,tab:j,tabContent:k,forGameChat:a}))};e.exports=a}),null);
__d("FantaTabGroup.react",["cx","FantaTab.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){return!this.props.tabGroup.equals(a.tabGroup)||this.props.messengerState!==a.messengerState||!!(!this.props.tabContents&&a.tabContents)||!!(this.props.tabContents&&a.tabContents&&!this.props.tabContents.equals(a.tabContents))};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.isLastOfTypeChecker,d=a.MainComponent,e=a.messengerState,f=a.MinimizedComponent,g=a.OverflowComponent,h=a.tabContents;a=a.tabGroup;var i=a.focusedTabID,j=a.getRaisedandUnraisedTabs(),k=j.raisedTabs;j=j.unraisedTabs;var l;c&&(l=k.findLastKey(function(a){return c(a)&&a.id}));a=a.allowedRaisedTabs===0?null:this.$1(j,g);var m=k.count();return b("React").createElement("div",{className:"_59v1"},a,k.map(function(a){return b("React").createElement(b("FantaTab.react"),{forGameChat:!1,isFocused:a.id===i,isLastTab:a===k.last(),isLastTabOfType:a.id===l,key:a.id,messengerState:e,MainComponent:d,MinimizedComponent:f,raisedTabCount:m,tab:a,tabContent:h&&h.get(a.id)})}).toArray())};a.prototype.$1=function(a,c){return!a.isEmpty()?b("React").createElement("div",{className:"_1kws"},b("React").createElement(c,{items:a,tabContents:this.props.tabContents})):null};function a(){h.apply(this,arguments)}a.propTypes={MainComponent:c.func.isRequired,messengerState:c.array,MinimizedComponent:c.func.isRequired,OverflowComponent:c.func.isRequired,tabContents:c.object,tabGroup:c.object.isRequired};e.exports=a}),null);
__d("FantaPendingActions.react",["Bootloader","BootloadOnRender.react","FantaTabActions","JSResource","LazyComponent.react","MercuryThreadActions","MessengerMessageRequestsTypedLogger","MessageRequestUtils","MessagingTag","React","MercuryIDs","CurrentUser"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MercuryThreadActions").get();c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$3=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,c);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(c).setEntryPoint(null).log()}.bind(this),this.$4=function(a){var c=this.props.thread;c=!!c&&b("MessageRequestUtils").isFiltered(c);var d=b("CurrentUser").getID();d=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,d);a==="hide"&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(c?"other":"pending").setThreadKey(d).setEntryPoint("inbox_banner").log()}.bind(this),this.$1=function(){__p&&__p();var a=this.props,c=a.thread,d=a.threadID;a=!!c&&b("MessageRequestUtils").isFiltered(c);var e=b("CurrentUser").getID();e=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,e);if(a)b("Bootloader").loadModules(["WebMessengerDeleteThreadDialog"],function(a){a.show(d,this.$3,this.$4,function(){return b("FantaTabActions").closeTab(d)})}.bind(this),"FantaPendingActions.react");else{var f=b("MercuryIDs").isGroupChat(d);b("Bootloader").loadModules(["WebMessengerDeclineMRDialog"],function(a){a.show(c,d,function(){return b("FantaTabActions").closeTab(d)},f)},"FantaPendingActions.react")}new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(e).setEntryPoint(null).log()}.bind(this),this.$2=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,c);h.changeFolder(this.props.threadID,b("MessagingTag").INBOX);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_accept_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(c).setEntryPoint(null).log()}.bind(this),c}a.prototype.render=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);return b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("ChatPendingActions.react").__setRef("FantaPendingActions.react"),placeholder:b("React").createElement("div",{style:{height:27}}),component:b("React").createElement(b("LazyComponent.react"),{isFiltered:a,onDeleteClick:this.$1,onReplyClick:this.$2})})};e.exports=a}),null);
__d("FantaTabComposer.react",["ChatTabComposerContainer.react","MessengerState.bs","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$2=function(a){this.$1=a}.bind(this),b}a.prototype.componentDidMount=function(){var a=this.props.participants;this.props.isFocused&&a.length>0&&!this.props.isEmptyLocalThread&&this.focusInput()};a.prototype.componentDidUpdate=function(a){this.props.isFocused&&this.props.isFocused!==a.isFocused&&!this.props.isEmptyLocalThread&&this.focusInput()};a.prototype.shouldComponentUpdate=function(a){var b=this.props;return!b.composer.equals(a.composer)||b.disableInput!==a.disableInput||!b.fileUploader&&!!a.fileUploader||b.fileUploader&&!b.fileUploader.equals(a.fileUploader)||b.isEmptyLocalThread!==a.isEmptyLocalThread||b.isFocused!==a.isFocused||b.isNewEmptyLocalThread!==a.isNewEmptyLocalThread||b.threadID!==a.threadID||b.viewer!==a.viewer||b.forGameChat!==a.forGameChat||b.participants.length!==a.participants.length};a.prototype.render=function(){var a=this.props,c=a.participants,d=a.threadID,e=a.viewer,f=a.isFocused;return c.length===0?b("React").createElement("div",null):b("React").createElement(b("MessengerState.bs").jsComponent,{fbid:e},function(a){return b("React").createElement(b("ChatTabComposerContainer.react"),{composer:this.props.composer,disableInput:this.props.disableInput,fileUploader:this.props.fileUploader,isFocused:f,onEscape:this.props.onEscape,onSelectSticker:this.props.onSelectSticker,onSendHotLike:this.props.onSendHotLike,onSendPhoto:this.props.onSendPhoto,onTab:this.props.onTab,onSendMessage:this.props.onSendMessage,isNewEmptyLocalThread:this.props.isNewEmptyLocalThread,ref:this.$2,thread:b("MessengerState.bs").threads(a)[d],threadID:d,viewer:e,forGameChat:this.props.forGameChat})}.bind(this))};a.prototype.focusInput=function(){this.$1&&this.$1.focusInput()};a.prototype.hasEmptyInput=function(){var a=this.$1;return!a?!1:a.hasEmptyInput()};e.exports=a}),null);
__d("FantaTabSheetPlaceholder.react",["cx","React","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("React").createElement("div",{className:"_w_z"},b("React").createElement(b("XUISpinner.react"),null))};e.exports=a}),null);
__d("FantaTabSheet.react",["cx","BootloadedComponent.react","CurrentUser","FantaTabSheetPlaceholder.react","JSResource","MercuryIDs","MercuryMessages","MessengerParticipants.bs","MercurySheetPolicy","MessengerGroupsSyncStatus","Placeholder.react","React","emptyFunction","lazyLoadComponent"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MercuryMessages").get(),j=b("lazyLoadComponent")(b("JSResource")("ChatGroupsSyncTabSheet.react").__setRef("FantaTabSheet.react"));c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){var b=this.props;return b.threadID!==a.threadID||!b.tabContent.equals(a.tabContent)};a.prototype.maybeRenderMontage=function(){var a=this.props,c=a.threadID;a=a.tabContent;return a.isMontageOpen?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatMontageSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:"Montage",threadID:c,onResize:b("emptyFunction")}):null};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.threadID;a=a.tabContent;var d=a.loggingID,e=a.openSheet,f=a.privacyController,g=a.thread,h=a.typeahead,k;switch(e){case b("MercurySheetPolicy").sheets.ChatThreadIsMutedTabSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetChatThreadIsMuted.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatNameConversationTabSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetNameConversation.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:e,thread:g,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet:var l=b("MercuryIDs").getUserIDFromThreadID(c);if(l){l=b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromUserID(l));l&&f&&(k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserBlockedTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),gender:l.gender,key:e,privacyActionController:f,shortName:l.short_name}))}break;case b("MercurySheetPolicy").sheets.ChatOfflineTabSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetOffline.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,privacyController:f,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatReadOnlyTabSheet:case b("MercurySheetPolicy").sheets.ChatReadOnlyPermanentTabSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetReadOnly.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.FantaAddFriendsSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetAddFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:e,loggingID:d,thread:g,threadID:c,typeahead:h});break;case b("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetAddMoreFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:e,loggingID:d,thread:g,threadID:c,typeahead:h});break;case b("MercurySheetPolicy").sheets.ChatThreadIsMessageBlockedSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetMessageBlocked.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,participants:a.participants,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserFocusSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserFocusSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,thread:g,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserFocusBypassSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserFocusBypassSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e});break;case b("MercurySheetPolicy").sheets.ChatUploadWarningTabSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUploadWarningTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e});break;case b("MercurySheetPolicy").sheets.ChatNoRecipientsTabSheet:b("MercuryIDs").isCanonical(c)||(k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatNoRecipientsTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e}));break;case b("MercurySheetPolicy").sheets.ChatNewMessagesTabSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaNewMessagesTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatEmployeeAwaySheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatEmployeeAwaySheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e});break;case b("MercurySheetPolicy").sheets.ChatEventReminderTabSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaEventReminderTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatAppointmentBanner:if(g){l=i.getCurrentlyLoadedMessages(c);k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatAppointmentBannerRoot.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),pageID:g.other_user_fbid,userID:b("CurrentUser").getID(),count:100,messageList:l,appointmentBannerDidUpdate:b("emptyFunction"),key:e,threadID:c})}break;case b("MercurySheetPolicy").sheets.ChatJoinCallSheet:if(g){f=g.rtc_call_data;d=g.thread_fbid;k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatJoinCallSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,rtcCallData:f,threadFBID:d})}break;case b("MercurySheetPolicy").sheets.ChatRoomAssociatedObjectSheet:if(g){h=g.associated_object;k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatRoomAssociatedObjectSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,associatedObject:h})}break;case b("MercurySheetPolicy").sheets.ChatMentorshipProgramSheet:k=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("MentorshipProgramSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:e,mentorship:a.mentorship});break;case b("MercurySheetPolicy").sheets.ChatGroupsSyncTabSheet:g&&g.work_associated_group&&(k=b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null),key:e},b("React").createElement(j,{group:g.work_associated_group,imageURL:g.image_src,name:g.name})));break}l=this.maybeRenderMontage();if(k)return b("React").createElement("div",{className:"_1sk5"},b("React").createElement("div",{className:"_1sk6"},k));else if(l)return l;return null};function a(){h.apply(this,arguments)}a.propTypes={threadID:c.string.isRequired,tabContent:c.object.isRequired};e.exports=a}),null);
__d("FantaTabMain.react",["cssVar","cx","fbt","invariant","Bootloader","BootloadOnRender.react","ChatBehavior","ChatConfig","ChatTabBlinking","CurrentUser","DragDropTarget","Event","FantaAvailableStatus","FantaChatHeaderContainer.react","FantaConversationScroller.react","FantaDispatcher","FantaDragAndDrop.react","FantaMessageActions","FantaPendingActions.react","FantaTabActions","FantaTabComposer.react","FantaTabSheet.react","FBIDCheck","JSResource","Keys","LazyComponent.react","MercuryIDs","MessageRequestUtils","MessagingTagConstants","MessengerBotMenuDataFetcher","MessengerParticipants.bs","MessengerParticipantUtils.bs","MessengerState.bs","MNCommercePageSetting","Parent","Placeholder.react","React","ReactDOM","SimpleXUIDialog","TrackingNodes","WorkBotLandingPageHelper","WorkChatAvailabilityStatusLoader","WorkFileUploadsGating","XUISpinner.react","convertMIGColorToFIGColor","getPageIDFromThreadID","getVendorPrefixedEventName","gkx","ifRequired","immutable","joinClasses","lazyLoadComponent","performanceAbsoluteNow","promiseDone","throttle"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l=b("WorkBotLandingPageHelper").shouldShowBotLandingPage,m=b("lazyLoadComponent")(b("JSResource")("FantaPageComposerNullState.react").__setRef("FantaTabMain.react")),n=/\D+/g;c=b("React").PropTypes;var o=function(a){a=b("MercuryIDs").getUserIDFromThreadID(a.tab.id);return a&&b("gkx")("AT505jRFtG_7w3nhZICN2g5HZo5KZ4FP0G7n7x_oCDMvQmeZOfjSNcbXcUzDHS_pr0yjnx5p-38r7Z_8WJZNypI6")&&b("WorkChatAvailabilityStatusLoader").isLoaded()?b("WorkChatAvailabilityStatusLoader").getStoreEnforce().getIsDoNotDisturb(a):!1};function p(a,b,c){__p&&__p();var d={};if(a){b?d.backgroundColor=b:d.backgroundColor=c;if(a.length&&a.length>0)if(a.length===1)d.backgroundColor=a[0];else if(a.length===2)d.backgroundImage="linear-gradient("+a[0]+", "+a[1]+")";else{var e=a.length,f=100/(e-1);e=a.map(function(a,b){return a+" "+b*f+"%"}).join(", ");d.backgroundImage="linear-gradient("+e+")"}}else b?d.backgroundColor=b:d.backgroundColor=c;return d}d=babelHelpers.inherits(a,b("React").Component);k=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=k.constructor).call.apply(a,[this].concat(e)),this.$10=null,this.state={closing:!1,disableInput:!1,isDoNotDisturb:o(this.props)},this.$23=function(event){var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);if(!a||!c){if(this.$9){clearTimeout(this.$9);this.$9=null;return}b("FantaTabActions").hoveredTab(this.props.tab.id)}}.bind(this),this.$24=function(event){var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);(!a||!c)&&(this.$9&&clearTimeout(this.$9),this.$9=setTimeout(function(){this.$9=null,b("FantaTabActions").unhoveredTab(this.props.tab.id)}.bind(this),500))}.bind(this),this.$21=function(event){var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id);(!a||!c)&&(!event.relatedTarget||!event.target?this.$7=setTimeout(function(){this.$7=null,this.$25(this.props.tab.id)}.bind(this),100):this.$25(this.props.tab.id))}.bind(this),this.$22=function(event){if(this.$7){clearTimeout(this.$7);this.$7=null;return}var a=!!b("Parent").byClass(event.target,"fantaTabMain-"+this.props.tab.id),c=!!b("Parent").byClass(event.relatedTarget,"fantaTabMain-"+this.props.tab.id),d=event.target;d&&d.classList&&(d.classList.contains("_3olu")||d.classList.contains("_61td")||d.classList.contains("_40qq")||d.classList.contains("_4zs3"))||(!a||!c)&&(b("FantaDispatcher").isDispatching()||b("FantaTabActions").focusTab(this.props.tab.id))}.bind(this),this.$27=function(a){b("FantaMessageActions").linkPreview(this.props.tab.id,a)}.bind(this),this.$26=function(a){var c=this.props.tabContent;c=c||{};c=c.composer;var d=this.props.tab.id;c&&b("FantaMessageActions").prepareFilesForSend(d,a,c)}.bind(this),this.$18=function(a){a.keyCode===b("Keys").ESC&&(this.$2(!0),a.preventDefault(),a.stopPropagation())}.bind(this),this.$19=function(a){a.keyCode===b("Keys").TAB&&this.$20(a)}.bind(this),this.$20=function(event){var a=this.props.raisedTabCount;a>1&&(event.preventDefault(),this.$3(event.ctrlKey,event.shiftKey))}.bind(this),this.$2=function(a){var c=this.props,d=c.tab;c=c.tabContent;!c||c&&c.composer.text.length===0&&!this.$28()?(this.$29(),a?b("FantaTabActions").closeAndTabNext(d.id):b("FantaTabActions").closeTab(d.id)):this.$30();this.$31()}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){this.$2=b("throttle")(this.$2,100),this.$3=b("throttle")(this.$3,100)};a.prototype.componentDidMount=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_fanta_main",JSON.stringify({messageSize:this.props.messages?this.props.messages.size:0,hasThread:!!this.props.thread}),0,a)}.bind(this),"FantaTabMain.react");this.$11();this.$12();this.$13(this.props.tab.id);this.$14();this.$15();this.$16()};a.prototype.componentDidUpdate=function(a){this.$12();if(b("gkx")("AT505jRFtG_7w3nhZICN2g5HZo5KZ4FP0G7n7x_oCDMvQmeZOfjSNcbXcUzDHS_pr0yjnx5p-38r7Z_8WJZNypI6")&&b("WorkChatAvailabilityStatusLoader").isLoaded()&&a.thread!==this.props.thread){var c=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a=b("MercuryIDs").getUserIDFromThreadID(a.tab.id);var d=b("WorkChatAvailabilityStatusLoader").getActionsEnforce();a&&d.unsubscribeUser(a,this);c&&(d.subscribeUser(c,this),b("WorkChatAvailabilityStatusLoader").getStoreEnforce().fetchUsers([c]))}};a.prototype.componentWillUnmount=function(){this.$4&&this.$4.disable();this.$10&&this.$10.remove();var a=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a&&b("WorkChatAvailabilityStatusLoader").isLoaded()&&b("WorkChatAvailabilityStatusLoader").getActionsEnforce().unsubscribeUser(a,this)};a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return c.hasFetchedAll!==a.hasFetchedAll||c.isFocused!==a.isFocused||c.isHovered!==a.isHovered||c.isLastGroupTab!==a.isLastGroupTab||!c.messages.equals(a.messages)||!c.tab.equals(a.tab)||!c.tabContent&&!!a.tabContent||c.tabContent&&!c.tabContent.equals(a.tabContent)||c.thread!==a.thread||c.fbid!==a.fbid||c.blockedIDs!==a.blockedIDs||c.readReceipts!==a.readReceipts||c.ignoredIds!==a.ignoredIds||d.closing!==b.closing||d.disableInput!==b.disableInput||d.isDoNotDisturb!==b.isDoNotDisturb||!c.onlineUsers.equals(a.onlineUsers)};a.prototype.$12=function(){__p&&__p();if(b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr"))return;var a=this.props,c=a.tab;a=a.thread;c=c.id;if(!a)return;var d=this.refs.root&&b("ReactDOM").findDOMNode(this.refs.root);if(!d)return;a=a.unread_count;if(a!==undefined){a=!!a&&(!b("ChatBehavior").showsTabUnreadUI||b("ChatBehavior").showsTabUnreadUI());a?b("ChatTabBlinking").blinkTab(c,{getTabElem:function(){return d},isFocused:function(){return this.props.isFocused}.bind(this),isHovered:function(){return!1}}):b("ChatTabBlinking").unblinkTab(c)}};a.prototype.$17=function(){var a=this.props.tabContent&&this.props.tabContent.nullStateCTA;if(!a)return!1;if(this.props.thread&&this.props.thread.message_count===0)return!0;return b("CurrentUser").isWorkUser()&&b("gkx")("AT4JDYUn5QDz10kQUm3j56rNv0YkUWxFYcsCLtFfBFzqJyNVsspOur5_1q6un6fiUWbmi8I1iVFFPGTd0qKcb9Fr")?l(this.props.messages):!1};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.blockedIDs,d=a.forGameChat,e=a.hasFetchedAll,f=a.isFocused,g=a.isHovered,h=a.isLastGroupTab,k=a.messages,l=a.onLoadMoreMessages,n=a.onSelectSticker,o=a.onSendHotLike,q=a.onSendMessage,r=a.onSendPhoto,s=a.readReceipts,t=a.showContextBanner,u=a.tab,v=a.tabContent;a=a.thread;u=u.id;var w=b("CurrentUser").getID(),x=v&&v.composer.fileUploader,y=v&&v.composer.sharePreview,z=x&&x.uploadingFiles,A=x&&x.uploadedFiles,B=a&&b("convertMIGColorToFIGColor")(a.header_color),C=v&&v.nullStateCTA,D=this.$17(),E=a&&a.participants||[],F=v&&v.threadPreviewRecipients||b("immutable").List();E=E.length>0?E:F.toArray();F=(F=this.props)!=null?(F=F.thread)!=null?F.other_user_fbid:F:F;F=F?b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromUserID(F)):null;var G=b("getPageIDFromThreadID")(this.props.tab.id),H=b("MessengerState.bs").isEmptyLocalThread(w,u),I=b("MessengerState.bs").isNewEmptyLocalThread(w,u);D=a&&b("MessageRequestUtils").isMessageRequest(a)?b("React").createElement(b("FantaPendingActions.react"),{thread:a,threadID:u}):D&&C?b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",{className:"_2xh0"},b("React").createElement("div",{className:"_2xh4 _59w_"},b("React").createElement(b("XUISpinner.react"),{size:"small"})))},b("React").createElement(m,{threadID:u,nullStateCTA:C,pageName:F&&F.short_name})):v?b("React").createElement("div",{className:"fbNubFlyoutFooter"+(this.state.disableInput?" fbNubFlyoutComposerDisabled":"")},b("React").createElement(b("FantaTabComposer.react"),{composer:v.composer,disableInput:this.state.disableInput,fileUploader:x,forGameChat:d,isEmptyLocalThread:H,isFocused:f,isNewEmptyLocalThread:I,onEscape:this.$18,onKeyDown:this.$18,onKeyPress:this.$19,onSelectSticker:n,onSendHotLike:o,onSendMessage:q,onSendPhoto:r,onTab:this.$20,participants:E,ref:"composer",threadID:u,viewer:w})):null;C=b("FantaAvailableStatus").isAvailable(a,u)&&!this.state.isDoNotDisturb;!v&&j(0);F=b("React").createElement(b("FantaTabSheet.react"),{tabContent:v,threadID:u});I=(x=a)!=null?x.marketplace_thread_data:x;o=(n=I)!=null?n.for_sale_item:n;r=(q=I)!=null?q.buyer_fbid:q;x=(E=I)!=null?E.seller_fbid:E;var J;o&&r&&x&&(J=b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MarketplaceMessengerContextBanner.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{buyerID:r,forSaleItem:o,renderLocation:"chat",sellerID:x})}));n=a&&b("gkx")("AT4vZBWyiZL1KZrir2lJt4vVNMIYu8sDbA3PtNwJWZh5seJSYZeYdmCgqH3wgiUS4PfslnEPm3wz9jSsjDINBCSy")?p(a.gradient_colors,a.solid_color,"#0084ff"):undefined;q=v&&v.isMultiCompany;E=v&&v.joinableInterstitialData?b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("ChatJoinableInterstitialPreview.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{data:v.joinableInterstitialData,isActive:f,onClose:this.$2})}):b("React").createElement("div",{className:"fbNubFlyoutInner"},b("React").createElement(b("FantaChatHeaderContainer.react"),{blockedIDs:c,composer:v.composer,customColor:B,highlightNewMessage:v&&v.highlightNewMessage,isDoNotDisturb:this.state.isDoNotDisturb,isFocused:f,isLastGroupTab:h,isMultiCompany:q,isNewMessageTab:v&&v.isNewMessageTab,membershipParticipants:v.membershipParticipants,onClose:this.$2,pageIndicatorDescription:v.pageIndicatorDescription,participants:v.participants,thread:a,threadHref:v&&v.threadHref,threadID:u,uri:v.uri,viewer:w}),b("React").createElement("div",{className:"_1ia _2sz2",ref:function(a){this.$5=a}.bind(this),style:n},F,b("React").createElement(b("FantaConversationScroller.react"),{forGameChat:d,hasFetchedAll:e,isFocused:f,isEmptyLocalThread:H,messages:k,onFocus:function(){return this.refs.composer&&this.refs.composer.focusInput()}.bind(this),onLoadMoreMessages:l,onlineUsers:this.props.onlineUsers,readReceipts:s,showContextBanner:t,thread:a,threadID:u,viewer:w,jumpToMessage:v.jumpToMessage}),b("React").createElement("div",{className:"_2hc2"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("P2PChatThreadBannerContainer.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{isVisible:!0,otherUserID:b("MercuryIDs").getUserIDFromThreadID(u),threadID:u})})),b("React").createElement("div",{className:"_4g6x"},b("React").createElement("div",{className:"_4g6y"},b("React").createElement("div",{className:"_4g6z _4g71"},i._("Drag Link\/Files Here")),b("React").createElement("div",{className:"_4g6z _4g6- _4g6_"},i._("Drop Files Here")),b("React").createElement("div",{className:"_4g6z _4g6- _4g70"},i._("Drop Link Here")))),G?b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{originalElement:D,pageID:G,playLinkClassName:"_2xh6 _2h_r",showGameImage:!0,threadFBID:(I=this.props)!=null?(I=I.thread)!=null?I.thread_fbid:I:I,threadID:u}),loader:b("JSResource")("MessengerGameBotPlayButton.react").__setRef("FantaTabMain.react"),placeholder:b("React").createElement("div",null)}):D,b("React").createElement(b("FantaDragAndDrop.react"),{composer:v.composer,threadID:u,uploadedFiles:A,uploadingFiles:z,sharePreview:y}),J));r=b("gkx")("AT7HdSIkhS9TSQx6PWXopj-NxmSus9nuXkEu6XM1WdZJElXpLdnQNN92q5iZdzYJyRUbbjoWOgsBC8RH9ivzcfSt");return b("React").createElement("div",{className:b("joinClasses")((this.state.closing?"_2suj":"")+" _3_9e _s0f _50mz _50m_"+(C?" _4-0b":"")+(this.state.isDoNotDisturb?" _1oh2":"")+" fbNub _50-v"+(f?" focusedTab":"")+(g?" hoveredTab":"")+" opened _27_3"+(b("ChatConfig").get("single_line_composer")?" _68h9":"")+(r?" _69cg":"")+(r?" _4k2r":""),"fantaTabMain-"+u),"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.CHAT_FLYOUT),onBlur:this.$21,onFocus:this.$22,onKeyDown:this.$18,onKeyPress:this.$19,onMouseEnter:this.$23,onMouseLeave:this.$24,ref:"root"},b("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent",role:"complementary"},b("React").createElement("div",{className:"fbNubFlyoutOuter"},E)))};a.prototype.$15=function(){var a=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a&&b("gkx")("AT505jRFtG_7w3nhZICN2g5HZo5KZ4FP0G7n7x_oCDMvQmeZOfjSNcbXcUzDHS_pr0yjnx5p-38r7Z_8WJZNypI6")&&b("promiseDone")(b("WorkChatAvailabilityStatusLoader").load(),function(b){var c=b.store;b._;this.$10=c.addListener(function(){this.setState({isDoNotDisturb:c.getIsDoNotDisturb(a)})}.bind(this))}.bind(this))};a.prototype.$25=function(a){b("FantaDispatcher").isDispatching()||b("FantaTabActions").blurTab(this.props.tab.id),this.$9&&(clearTimeout(this.$9),this.$9=null),setTimeout(function(){b("FantaTabActions").unhoveredTab(a)})};a.prototype.$16=function(){var a=b("getPageIDFromThreadID")(this.props.tab.id);a&&b("MessengerBotMenuDataFetcher").getHasPageSetting(a,function(a){this.setState({disableInput:a})}.bind(this),function(){this.setState({disableInput:!1})}.bind(this),b("MNCommercePageSetting").COMPOSER_INPUT_DISABLED)};a.prototype.$11=function(){__p&&__p();if(b("WorkFileUploadsGating").canUploadFiles&&!this.$4){var a=b("ReactDOM").findDOMNode(this.$5);if(a){a=new(b("DragDropTarget"))(a);this.$4=a;a.setOnFilesDropCallback(this.$26);a.setOnURLDropCallback(this.$27);a.enable()}}};a.prototype.$3=function(a,c){a||(c?b("FantaTabActions").focusPreviousTab():b("FantaTabActions").focusNextTab())};a.prototype.$29=function(){var a=this.props.tab.id;b("Bootloader").loadModules(["MessengerShareFilePreviewFunnelLogger"],function(b){return b.endFunnel(a)},"FantaTabMain.react")};a.prototype.$28=function(){return this.$32()||this.$33()};a.prototype.$32=function(){var a,b=this.props.tabContent;a=((a=b)!=null?(a=a.composer)!=null?(a=a.fileUploader)!=null?a.uploadedFiles:a:a:a)||{size:0};b=((b=b)!=null?(b=b.composer)!=null?(b=b.fileUploader)!=null?b.uploadingFiles:b:b:b)||{size:0};return a.size>0||b.size>0};a.prototype.$33=function(){var a=this.props.tabContent;a=(a=a)!=null?(a=a.composer)!=null?a.sharePreview:a:a;return!!(a&&a.params&&a.type)};a.prototype.$34=function(a){__p&&__p();var c=this.props.tab,d=b("ReactDOM").findDOMNode(this.refs.root);this.$1=setTimeout(function(){return a?b("FantaTabActions").closeAndTabNext(c.id):b("FantaTabActions").closeTab(c.id)},1.2*b("ifRequired")("cssVar",function(a){return"200ms".replace(n,"")},function(){return 200}));if(d)var e=b("Event").listen(d,b("getVendorPrefixedEventName")("animationend"),function(d){d.animationName==="closeChatTab"&&(a?b("FantaTabActions").closeAndTabNext(c.id):b("FantaTabActions").closeTab(c.id),clearTimeout(this.$1),e.remove())}.bind(this));this.$31();this.setState({closing:!0})};a.prototype.$30=function(a){var c=this.props.tab,d=c.id;b("FantaTabActions").blurTab(d);c=i._("Are you sure you want to close this chat window?");var e=i._("You haven't sent your message.");b("SimpleXUIDialog").showConfirm(c,e,function(c){c?(this.$29(),a?b("FantaTabActions").closeAndTabNext(d):b("FantaTabActions").closeTab(d)):b("FantaTabActions").focusTab(d)}.bind(this),{autofocusConfirm:!0,useReactFocusBehavior:!0})};a.prototype.$14=function(){this.$8=Math.floor(Date.now()/1e3)};a.prototype.$31=function(){var a=this.props,c=a.thread,d=a.tab,e=c?c.other_user_fbid:null,f=Math.floor(Date.now()/1e3),g=this.$8;c&&e&&!b("FBIDCheck").isUser_deprecated(e)&&b("Bootloader").loadModules(["PagesLogger","PagesLoggerEventEnum","PagesLoggerEventTargetEnum","PagesEventObserver","PagesEventType"],function(a,b,h,i,j){a.log(e,b.CLICK,h.MESSAGE_FANTA_TAB_CLOSE,"",["pages_surface_team"],{open_tab_timestamp:g,close_tab_timestamp:f,last_message_timestamp:c.last_message_timestamp,message_count:c.message_count,snippet_sender:c.snippet_sender,participants:c.participants,entrypoint:d.entryPoint}),i.notify(j.MESSAGES_FANTA_TAB_CLOSE,e,{open_tab_timestamp:g,close_tab_timestamp:f,last_message_timestamp:c.last_message_timestamp,message_count:c.message_count,snippet_sender:c.snippet_sender,participants:c.participants,entrypoint:d.entryPoint})},"FantaTabMain.react")};a.prototype.$13=function(a){__p&&__p();if(!b("MercuryIDs").isValidThreadID(a))return;b("Bootloader").loadModules(["GroupChatMessageBlockAlert","GroupChatMessageIgnoreAlert","MercuryIgnoredBlockedParticipants.bs","MercuryThreadActions"],function(c,d,e,f){__p&&__p();var g=f.get();b("MessengerState.bs").getThreadMeta(b("CurrentUser").getID(),a,function(f){var h=this.props,i=h.fbid,j=h.ignoredIds;b("MessengerState.bs").compute(i,function(h){h=h.blocked_ids;e.isPresentInGroupThread(i,h,f)?c.show(e.participantsInGroupThread(i,h,f),function(){b("FantaTabActions").focusTab(a)},function(){b("FantaTabActions").closeTab(a),b("MessengerState.bs").isEmptyLocalThread(b("CurrentUser").getID(),a)||g.leaveGroup(a)}):b("MessengerParticipantUtils.bs").areParticipantsInGroupThread(i,j,f)&&f.folder==="inbox"&&d.show(b("MessengerParticipantUtils.bs").participantsInGroupThread(i,j,f),b("MercuryIDs").getThreadFBIDFromThreadID(a),function(){b("FantaTabActions").focusTab(a)},function(){b("FantaTabActions").closeTab(a),b("Bootloader").loadModules(["IgnoreMessagesTypedLogger","IgnoreMessagesLoggingEvent","IgnoreMessagesPlatforms"],function(c,d,e){g.changeFolder(a,b("MessagingTagConstants").other),new c().setEvent(d.IGNORE_CONFIRMED).setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(a)).setPlatform(e.CHAT_TABS).log()},"FantaTabMain.react")})})}.bind(this))}.bind(this),"FantaTabMain.react")};a.propTypes={hasFetchedAll:c.bool.isRequired,isFocused:c.bool.isRequired,isHovered:c.bool.isRequired,isLastGroupTab:c.bool.isRequired,messages:c.object,onlineUsers:c.instanceOf(b("immutable").List).isRequired,onLoadMoreMessages:c.func.isRequired,onSelectSticker:c.func.isRequired,onSendHotLike:c.func.isRequired,onSendMessage:c.func.isRequired,onSendPhoto:c.func.isRequired,raisedTabCount:c.number,showContextBanner:c.bool,tab:c.object.isRequired,tabContent:c.object,thread:c.object,forGameChat:c.bool.isRequired};e.exports=a}),null);
__d("FantaTabMainLoader.react",["Bootloader","FantaAppStore","FantaAvailableStatus","FantaGetMessageActions","FantaMessageActions","FantaTabMain.react","MercuryConfig","MercuryIDs","MessengerState.bs","React","TimeSlice","emptyFunction","immutable","requestIdleCallback","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;var h=function(a){__p&&__p();b("FantaAppStore").addReducers(a);a=b("FantaAppStore").getState();a=(a=a)!=null?(a=a.mercury)!=null?a.tabContents:a:a;if(a){var c=a.reduce(function(a,b){b=b.thread;b&&a.push(b);return a},[]);b("setImmediate")(function(){return b("FantaGetMessageActions").threadsUpdated(c)})}h=b("emptyFunction")};d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$2=function(){var a=this.props.tab;b("FantaGetMessageActions").fetchMoreMessages(a.id)}.bind(this),this.$3=function(a,c){var d=this.props.tab;b("FantaMessageActions").sendSticker(d.id,a,c)}.bind(this),this.$4=function(a,c,d,e){var f=this.props.tab;b("FantaMessageActions").sendHotLike(f.id,a,c,d,e)}.bind(this),this.$5=function(a,c,d){var e=this.props.tab;b("FantaMessageActions").sendMessage(e.id,a,c,d)}.bind(this),this.$6=function(a,c){var d=this.props.tab;b("FantaMessageActions").sendPhoto(d.id,a,c)}.bind(this),c}a.prototype.shouldComponentUpdate=function(a){var b=this.props;return b.isFocused!==a.isFocused||b.isHovered!==a.isHovered||b.isLastTabOfType!==a.isLastTabOfType||b.messengerState!==a.messengerState||!b.tab.equals(a.tab)||!b.tabContent.equals(a.tabContent)};a.prototype.componentDidMount=function(){var a=function(){b("Bootloader").loadModules(["FantaReducersTabSheets"],h,"FantaTabMainLoader.react")};b("TimeSlice").guard(function(){b("requestIdleCallback")(a)},"additional request not needed for initial display",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.isFocused,d=a.isHovered,e=a.isLastTabOfType,f=a.messengerState,g=a.raisedTabCount,h=a.tab,i=a.tabContent;a=a.forGameChat;var j=i.hasFetchedAll,k=i.showContextBanner,l=i.thread,m=i.threadPreviewID,n=i.messages;m=m?h.id+"-"+m:h.id;if(!i)return b("React").createElement("div",{key:"noContent-"+m});n||(n=b("immutable").List());var o=b("immutable").List([]);b("MercuryConfig").GDWC&&(o=this.$1(l,h));return b("React").createElement(b("FantaTabMain.react"),{blockedIDs:b("MessengerState.bs").blockedIds(f),fbid:b("MessengerState.bs").fbid(f),forGameChat:a,hasFetchedAll:j,ignoredIds:b("MessengerState.bs").ignoredIds(f),isFocused:c,isHovered:d,isLastGroupTab:e,key:m,messages:n,onlineUsers:o,onLoadMoreMessages:this.$2,onSelectSticker:this.$3,onSendHotLike:this.$4,onSendMessage:this.$5,onSendPhoto:this.$6,raisedTabCount:g,readReceipts:b("MessengerState.bs").readReceiptsPerThread(f),showContextBanner:k,tab:h,tabContent:i,thread:l})};a.prototype.$1=function(a,c){__p&&__p();var d=b("MercuryIDs").getUserIDFromThreadID(c.id),e=[];d?e=b("FantaAvailableStatus").isAvailable(a,c.id)?[d]:[]:a&&(e=a.participants.filter(function(a){if(!a)return!1;a=b("MercuryIDs").getThreadIDFromParticipantID(a);if(!a)return!1;a=b("FantaAvailableStatus").isAvailable(null,a);return a}),e=e.map(function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)||""}));return b("immutable").List(e)};a.propTypes={isFocused:c.bool.isRequired,isHovered:c.bool.isRequired,isLastTabOfType:c.bool.isRequired,messengerState:c.array,raisedTabCount:c.number,tab:c.object.isRequired,tabContent:c.object};e.exports=a}),null);
__d("XUIBadgeReact.bs",["ReasonReact.bs","XUIBadge.react","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){if(a)if(a[0])return["regular"];else return["special"];else return 0}function a(a,c,d,e,f){return b("ReasonReact.bs").wrapJsForReason(b("XUIBadge.react"),{className:b("bs_js_null_undefined").fromOption(c),count:b("bs_js_null_undefined").fromOption(d),maxcount:b("bs_js_null_undefined").fromOption(e),type:b("bs_js_null_undefined").fromOption(g(a))},f)}f.stringOfBadgeType=g;f.make=a}),null);
__d("FantaM4HeaderMinimized.bs",["cx","fbt","cssVar","bs_block","bs_curry","React","ReasonReact.bs","bs_js_primitive","FantaM4Header.bs","XUIBadgeReact.bs","ChatThreadName.bs","ChatDetailStack.bs","FantaCloseButton.bs","FantaProfilePresence.bs"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("ReasonReact.bs").reducerComponentWithRetainedProps("FantaM4HeaderMinimized");function k(a,c,d,e,f,g,i,k,l){__p&&__p();return[j[0],j[1],j[2],j[3],j[4],function(a){var c=a[1];if(!a[0][2][0]&&c[2][0]){b("bs_curry")._1(c[3],0);setTimeout(function(){return b("bs_curry")._1(c[3],1)},1e3);return 0}else return 0},j[6],j[7],function(j){__p&&__p();var l=b("FantaM4Header.bs").getProfileImages(g,f,i),m=g?g[0].unread_count:0,n=b("FantaM4Header.bs").getTooltip(g);if(g){var o=g[0].header_color;o=o==null?["#0084ff"]:[o]}else o=["#0084ff"];var p=a&&j[1][0];p=p?o?[o[0],"_69pt _2mgn _6d6l"]:["","_69pt _6d6l"]:o?["","_69pt _6d6l"]:["","_69pt _6d6l"];o=p[0];l=k?null:b("ReasonReact.bs").element(0,0,b("FantaProfilePresence.bs").make(l,20,c,[!0],g,"",n,[o],[]));n=k?h._("New message"):b("ReasonReact.bs").element(0,0,b("ChatThreadName.bs").make(g,"",n,i,"_2mgq",k,[]));j=m>0&&!(a&&j[1][0]);return b("React").createElement("div",{className:p[1],style:{backgroundColor:o},onClick:e},b("React").createElement("div",{className:"_66n2"},l,b("React").createElement("div",{className:"_66n3"},b("ReasonReact.bs").element(0,0,b("ChatDetailStack.bs").make(n,null,[])),j?b("ReasonReact.bs").element(0,0,b("XUIBadgeReact.bs").make([0],["_429n"],[m],[99],[])):null)),b("ReasonReact.bs").element(0,0,b("FantaCloseButton.bs").make(d,!1,[])))},function(){return[!1]},[a],function(c,a){if(c)return b("bs_block").__(0,[[!1]]);else return b("bs_block").__(0,[[!0]])},j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){return k(a.highlightNewMessage,a.isActive,a.onClose,a.onHeaderToggle,b("bs_js_primitive").null_undefined_to_opt(a.participants),b("bs_js_primitive").null_undefined_to_opt(a.thread),a.viewer,a.isNewMessageTab,[])});c=20;d=1e3;f.component=j;f.small_profile_image_size=c;f.blink_threshold_ms=d;f.make=k;f.jsComponent=a}),null);
__d("FantaTabMinimized.react",["cx","fbt","Bootloader","ChatBehavior","ChatTabBlinking","ChatTabHeaderContainer.react","CurrentUser","FantaAvailableStatus","FantaM4HeaderMinimized.bs","FantaTabActions","React","ReactDOM","SimpleXUIDialog","emptyFunction","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FantaM4HeaderMinimized.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={closing:!1},this.$5=function(event){var a=this.props,c=a.tab;a=a.tabContent;!a||a&&a.composer.text.length===0&&!this.$7()?(this.$8(),b("FantaTabActions").closeTab(c.id)):this.$9()}.bind(this),this.$6=function(event){var a=event.target;a&&a.classList&&!a.classList.contains("button")&&(event.stopPropagation(),b("FantaTabActions").unminimizeTab(this.props.tab.id),b("FantaTabActions").focusTab(this.props.tab.id))}.bind(this),c}a.prototype.componentDidMount=function(){this.$3()};a.prototype.componentDidUpdate=function(){this.$3()};a.prototype.shouldComponentUpdate=function(a){var b=this.props;return!b.tab.equals(a.tab)||!b.tabContent&&!!a.tabContent||!!b.tabContent&&!b.tabContent.equals(a.tabContent)};a.prototype.$3=function(){__p&&__p();if(b("gkx")("AT4aq0gj3KFvuyn5ouzkcinNuxrDXZY6HPjnRXCVXzOigsSLEws96b2T0YYtUZg_IxPxKREPJvW4RS6GeFXjfiRr"))return;var a=this.props,c=a.tab;a=a.tabContent;c=c.id;if(!a)return;a=a.thread;if(!a)return;var d=this.refs.root&&b("ReactDOM").findDOMNode(this.refs.root);if(!d)return;a=a.unread_count;if(a!==undefined){a=!!a&&(!b("ChatBehavior").showsTabUnreadUI||b("ChatBehavior").showsTabUnreadUI());a?b("ChatTabBlinking").blinkTab(c,{getTabElem:function(){return d},isFocused:function(){return!1},isHovered:function(){return!1}}):b("ChatTabBlinking").unblinkTab(c)}};a.prototype.$4=function(){var a=this.props.tabContent,c=a&&a.thread,d=c&&c.thread_id,e=a&&a.thread&&a.thread.header_color,f=e?{color:e}:null,g=b("CurrentUser").getID();if(b("gkx")("AT6A1bnDK2h8UfK21QtwMasCKSCRuJLNl1CkXiFlb4ngyuzOTwnMPylW45yiU1EwI4xsY2mbtMRkoGbbra-xak0V")){d=c&&d&&b("FantaAvailableStatus").isAvailable(c,d);return b("React").createElement("div",{className:"clearfix titlebar"},b("React").createElement(j,{highlightNewMessage:a&&a.highlightNewMessage,isActive:d,isNewMessageTab:a&&a.isNewMessageTab,onClose:this.$5,onHeaderToggle:this.$6,participants:a&&a.participants,thread:c,viewer:g}))}return b("React").createElement("div",{className:(this.state.closing?"_2suj":"")+" clearfix fbNubFlyoutTitlebar titlebar"+(e?" _1m34":""),style:f},b("React").createElement(b("ChatTabHeaderContainer.react"),{attachmentsShelf:document.createElement("div"),composer:a&&a.composer,hasBlockedMessages:!1,href:a&&a.threadHref,isActive:!1,isNewMessageTab:!!(a&&a.isNewMessageTab),isRaised:!1,isTyping:!1,membershipParticipants:a&&a.membershipParticipants,onClick:this.$6,onCloseClick:this.$5,onRTCNuxCloseButtonClick:b("emptyFunction"),participants:a&&a.participants,rtcNuxShown:!1,sheetController:{},showAddFriend:b("emptyFunction"),thread:c,threadID:this.props.tab.id,viewer:g}))};a.prototype.render=function(){var a=this.props,c=a.tab;a=a.tabContent;c=c.id;a=a&&!!a.thread&&b("FantaAvailableStatus").isAvailable(a.thread,c);return b("React").createElement("div",{className:"_4cd8 _50mz _50m_ fbNub _50-v"+(a?" _4-0b":"")+" _27_3"+(b("gkx")("AT7HdSIkhS9TSQx6PWXopj-NxmSus9nuXkEu6XM1WdZJElXpLdnQNN92q5iZdzYJyRUbbjoWOgsBC8RH9ivzcfSt")?" _69cg":""),ref:"root"},this.$4())};a.prototype.$8=function(){var a=this.props.tab.id;b("Bootloader").loadModules(["MessengerShareFilePreviewFunnelLogger"],function(b){return b.endFunnel(a)},"FantaTabMinimized.react")};a.prototype.$7=function(){return this.$10()||this.$11()};a.prototype.$10=function(){var a,b=this.props.tabContent;a=((a=b)!=null?(a=a.composer)!=null?(a=a.fileUploader)!=null?a.uploadedFiles:a:a:a)||{size:0};b=((b=b)!=null?(b=b.composer)!=null?(b=b.fileUploader)!=null?b.uploadingFiles:b:b:b)||{size:0};return a.size>0||b.size>0};a.prototype.$11=function(){var a=this.props.tabContent;a=(a=a)!=null?(a=a.composer)!=null?a.sharePreview:a:a;return!!(a&&a.params&&a.type)};a.prototype.$9=function(){var a=this.props.tab,c=h._("Are you sure you want to close this chat window?");b("FantaTabActions").blurTab(a.id);var d=h._("You haven't sent your message.");b("SimpleXUIDialog").showConfirm(c,d,function(c){c?b("FantaTabActions").closeTab(a.id):b("FantaTabActions").focusTab(a.id)},{autofocusConfirm:!0,useReactFocusBehavior:!0})};a.propTypes={tab:c.object.isRequired,tabContent:c.object};e.exports=a}),null);
__d("FantaMercuryTabsWithMain.react",["Bootloader","CurrentUser","FantaAppStore","FantaCookieUtil","FantaMercuryTabOverflowBootloader.react","FantaTabActions","FantaTabGroup.react","FantaTabMainLoader.react","FantaTabMinimized.react","FluxContainer","LazyComponent.react","LoadOnRender.react","MercuryIDs","MessengerState.bs","PresenceState","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MessengerState.bs").jsComponent,i=function(a){b("Bootloader").loadModules(["MessengerReasonDialogContainerReact.bs"],function(b){b=b.jsComponent;return a(b)},"FantaMercuryTabsWithMain.react")};g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("FantaAppStore")]};a.calculateState=function(){return{tabGroup:b("FantaAppStore").getState().tabGroup,tabContents:b("FantaAppStore").getState().mercury.tabContents}};a.prototype.componentDidMount=function(){this.props.loadDataOnMount&&b("FantaTabActions").loadFromData(b("FantaCookieUtil").convertCookieData(b("PresenceState").get()))};a.prototype.render=function(){return b("React").createElement(h,{fbid:b("CurrentUser").getID()},function(a){return[b("React").createElement(b("FantaTabGroup.react"),{key:"tabgroup",messengerState:a,MainComponent:b("FantaTabMainLoader.react"),MinimizedComponent:b("FantaTabMinimized.react"),OverflowComponent:b("FantaMercuryTabOverflowBootloader.react"),tabGroup:this.state.tabGroup,tabContents:this.state.tabContents,isLastOfTypeChecker:this.$1}),b("React").createElement(b("LoadOnRender.react"),{key:"dialog",component:b("React").createElement(b("LazyComponent.react"),null),loader:i,placeholder:b("React").createElement("span",null)})]}.bind(this))};a.prototype.$1=function(a){return b("MercuryIDs").isGroupChat(a.id)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("MessengerPlatformPostbackFailedDialog.react",["fbt","MessengerDialog.react","MessengerDialogBodyReact.bs","MessengerDialogHeader.react","MessengerDialogs.bs","MessengerDialogTitle.react","React"],(function(a,b,c,d,e,f,g){"use strict";var h=b("MessengerDialogBodyReact.bs").jsComponent;function a(){return b("React").createElement(b("MessengerDialog.react"),{onToggle:function(a){a||b("MessengerDialogs.bs").removeDialog()}},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,g._("Action unsuccessful"))),b("React").createElement(h,null,g._("There was an error while delivering your message to the bot. Please try again later.")))}e.exports=a}),null);
__d("FantaPageComposerNullState.react",["cx","fbt","ChatPageComposerNullState.react","CurrentUser","FantaAppStore","MessengerDialogs.bs","MessengerDiscoveryEntryPoint","MessengerDiscoveryEntryPointsLoggingHelper","MessengerPlatformPostbackFailedDialog.react","MNCommerceCallToActionType","MNCommercePostbackCTADataManager","MNCommercePostbackRefSendManager","React","getPageIDFromThreadID"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$2=function(){__p&&__p();var a=this.props,c=a.threadID;a=a.nullStateCTA;switch(a.action_type){case b("MNCommerceCallToActionType").OPEN_NATIVE:break;case b("MNCommerceCallToActionType").POSTBACK:default:var d=b("FantaAppStore").getState().tabGroup.tabs.get(c),e=[];d&&d.entryPoint&&d.entryPoint[0]&&Object.values(b("MessengerDiscoveryEntryPoint")).indexOf(d.entryPoint[0])!==-1&&e.push(b("MessengerDiscoveryEntryPointsLoggingHelper").getEntryPointsLoggingTagStr([d.entryPoint[0]]));b("MNCommercePostbackCTADataManager").sendAndConfirm(a.id,a.title,c,null,function(a){a.error&&b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("MessengerPlatformPostbackFailedDialog.react"),null)})},null,e);break}}.bind(this),c}a.prototype.render=function(){return b("React").createElement("div",{className:"_2xh0"},this.$1(),b("React").createElement("div",{className:"_2xh4 _59w_"},b("React").createElement(b("ChatPageComposerNullState.react"),{cta:this.props.nullStateCTA,disabled:!1,onClick:this.$2,threadID:this.props.threadID})))};a.prototype.$1=function(){__p&&__p();if(this.props.nullStateCTA!==null)switch(this.props.nullStateCTA.action_type){case b("MNCommerceCallToActionType").OPEN_NATIVE:return null;case b("MNCommerceCallToActionType").POSTBACK:if(!b("MNCommercePostbackRefSendManager").hasMDotMeRef(b("getPageIDFromThreadID")(this.props.threadID))&&!this.props.nullStateCTA.instantgame_metadata&&!b("CurrentUser").isWorkUser()){var a=this.props.pageName?this.props.pageName:h._("Page");return b("React").createElement("div",{className:"_4teq"},h._("When you tap {cta title}, {name} will see your public info.",[h._param("cta title",this.props.nullStateCTA.title),h._param("name",a)]))}break;default:return null}return null};e.exports=a}),null);
__d("FantaTabsReactApp",["ChatPerfInstrumentation","FantaMercuryTabsWithMain.react","FantaTabsAppBase","React","ReactDOM","UserActivity","gkx","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=500,i;g=babelHelpers.inherits(a,b("FantaTabsAppBase"));g&&g.prototype;a.prototype.initializeFantaData=function(a){__p&&__p();d(["FantaAppStore","FantaCookieUtil","FantaGetMessageActions","FantaTabActions","MercuryThreadInformer","PresenceState"],function(c,d,e,f,g,j){__p&&__p();f.loadFromData(d.convertCookieData(j.get(),null,a)),j.registerStateLoader(function(b){f.loadFromData(d.convertCookieData(b,c.getState().tabGroup,a))}),j.registerStateStorer(function(a){if(!b("UserActivity").isOnTab()&&!b("UserActivity").isActive(h)&&!b("gkx")("AT6nWa67JNvPKaNLOZDdyp4fuiyIepv2XIXuKF5LN83i_b2kMZXQUSDdjTj5i5D9b_AvpyeTkt6VFx72KlG1zydvjEHtSqFDRRgvpLmEHrSbcw"))return a;var e=c.getState().tabGroup;if(!i||i&&!i.equals(e)){i=e;return d.createCookieData(e,a)}else return a}),g.get().subscribe("threads-updated",function(a,c){Object.keys(c).forEach(function(a){b("setImmediate")(function(){e.refreshThread(a)})})}),b("ChatPerfInstrumentation").logInitData()})};a.prototype.initializeFantaUI=function(){__p&&__p();d(["FantaAppStore","FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(a,c,d,e,f,g,h){__p&&__p();g.init();h.init();b("ReactDOM").render(this.getViewComponent(),this.tabsElem);c.onMessagesReceived(function(a,c){b("setImmediate")(function(){d.receivedNewMessage(a,c)})});f.init(this.tabsElem);b("ChatPerfInstrumentation").logInitUI();e=a.getState().tabGroup.tabs;e.toArray().length===0&&b("ChatPerfInstrumentation").logDisplayDone()}.bind(this))};a.prototype.getViewComponent=function(){return b("React").createElement(b("FantaMercuryTabsWithMain.react"),{loadDataOnMount:!1})};function a(){g.apply(this,arguments)}e.exports=new a()}),null);
__d("ChatInitialDataTransformer.bs",["bs_array","bs_js_dict","bs_caml_array","bs_caml_format","MessengerServerPayloadTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();var c=a.viewer,d=a.is_page,e=[],f=[],g={},h=[],i={},j=[];b("bs_array").iter(function(a){__p&&__p();if(a==null)return 0;else{var k=b("MessengerServerPayloadTransformer.bs").getThreadFBID(a),l=b("MessengerServerPayloadTransformer.bs").getOtherUserID(a),m=b("MessengerServerPayloadTransformer.bs").transformThread(c,a,d);e.push(m);var n=b("MessengerServerPayloadTransformer.bs").transformMessages(c,a,d);n&&b("bs_array").iter(function(a){f.push(a);return 0},n[0]);n=b("MessengerServerPayloadTransformer.bs").getMessagePageInfo(a);n&&(n[0].has_previous_page||(k==null?l==null||j.push({type:"thread",fbid:l}):j.push({type:"thread",fbid:k})));n=b("MessengerServerPayloadTransformer.bs").transformReadReceipts(c,a);if(n){n=n[0];k==null||(g[k]=n);l==null||(g[l]=n)}k=b("MessengerServerPayloadTransformer.bs").transformDeliveryReceipts(a);if(k.length>=1){l=b("bs_caml_array").caml_array_get(k,0);if(m.is_canonical){n=m.other_user_fbid;n==null||h.push({other_user_fbid:n,thread_fbid:null,time:b("bs_caml_format").caml_float_of_string(l.timestamp_precise)})}else{k=m.thread_fbid;k==null||h.push({other_user_fbid:null,thread_fbid:k,time:b("bs_caml_format").caml_float_of_string(l.timestamp_precise)})}}n=b("MessengerServerPayloadTransformer.bs").transformParticipants(a);return b("bs_array").iter(function(a){i[a.fbid]=a;return 0},n)}},a.threads);return{threads:e,actions:f,roger:g,delivery_receipts:h,participants:b("bs_js_dict").values(i),end_of_history:j}}f.transform=a}),null);