if (self.CavalryLogger) { CavalryLogger.start_js(["32ed8"]); }

__d("AsyncLoader",["AsyncRequest","BaseAsyncLoader"],(function(a,b,c,d,e,f){function a(a,b){this._endpoint=a,this._type=b}Object.assign(a.prototype,b("BaseAsyncLoader").prototype);a.prototype.send=function(a,c,d,e,f){new(b("AsyncRequest"))(a).setData({ids:c}).setHandler(e).setErrorHandler(f).setAllowCrossPageTransition(!0).setMethod("GET").setReadOnly(!0).send()};e.exports=a}),null);
__d("ChatproxyPresence",["Arbiter","AvailableListConstants","AvailableListInitialData","BanzaiODS","ChannelConstants","LastActiveTimes","PresenceStatus","debounceAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";this.$1=a,this.$2=!1,this.$3=b("AvailableListInitialData").chatNotif,this.$4=!1}a.prototype.subscribe=function(){"use strict";__p&&__p();b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("chatproxy-presence"),this.updatePresenceInfo.bind(this)),b("Arbiter").subscribe(b("ChannelConstants").ON_INVALID_HISTORY,function(){this.$2=!0}.bind(this)),b("Arbiter").subscribe(b("ChannelConstants").RTI_SESSION,function(a,b){b&&(this.$4=b)}.bind(this)),b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("get_debug_presence"),function(a,c){a=b("PresenceStatus").getAllDebugInfo();c=b("LastActiveTimes").getDebugData();for(var d in c){var e=a[d];e===undefined&&(e={},a[d]=e);e.l=Math.floor(c[d])}this.$4.issueRequest("/debug_presence",{},a,function(){b("BanzaiODS").bumpEntityKey("ChatproxyPresence","debug_presence.sucess")})}.bind(this))};a.prototype.getRTISession=function(){"use strict";return this.$4};a.prototype.updatePresenceInfo=function(a,c){"use strict";__p&&__p();this.$2&&(this.$2=!1,b("PresenceStatus").resetPresenceData());c=c.obj;a=c.buddyList;b("PresenceStatus").setMultiChatproxy(a);a=!1;c.chatNotif!==undefined&&(a=this.$3!==c.chatNotif);a&&(this.$3=c.chatNotif);c.gamers&&b("PresenceStatus").setPlayingCanvasGameFriends(c.gamers);a&&this.$1(b("AvailableListConstants").ON_CHAT_NOTIFICATION_CHANGED,this.$3);b("debounceAcrossTransitions")(function(){this.$1(b("AvailableListConstants").ON_AVAILABILITY_CHANGED)}.bind(this),0)()};a.prototype.getWebChatNotification=function(){"use strict";return this.$3};e.exports=a}),null);
__d("TypingStates",[],(function(a,b,c,d,e,f){a=Object.freeze({INACTIVE:0,TYPING:1,QUITTING:2});e.exports=a}),null);
__d("AvailableList",["Arbiter","ArbiterMixin","AsyncRequest","AvailableListConstants","BanzaiODS","Bootloader","ChannelConstants","ChatConfig","ChatDispatcher","ChatproxyPresence","ChatReliabilityInstrumentation","ChatVisibility","CurrentUser","FBIDCheck","FBLogger","JSLogger","LastActiveTimes","PresencePrivacy","PresenceStatus","PresenceStatusActionTypes","Run","ServerTime","TypingStates","debounceAcrossTransitions","emptyFunction","requireWeak"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("BanzaiODS").setEntitySample("presence",1e-4);var g=babelHelpers["extends"]({},b("AvailableListConstants"),b("ArbiterMixin")),h=/\D/;g.subscribe([b("AvailableListConstants").ON_AVAILABILITY_CHANGED,b("AvailableListConstants").ON_UPDATE_ERROR],function(a,c){b("Arbiter").inform(a,c)});b("PresenceStatus").subscribe("change",b("debounceAcrossTransitions")(function(){g.inform(b("AvailableListConstants").ON_AVAILABILITY_CHANGED)},0));var i=b("debounceAcrossTransitions")(function(){g.inform(b("AvailableListConstants").ON_AVAILABILITY_CHANGED),b("ChatDispatcher").dispatch({type:b("PresenceStatusActionTypes").AVAILABILITY_CHANGED})},0);function j(a,c,d,e,f){if(a===b("CurrentUser").getID())return;c=b("PresenceStatus").set(a,c,d,e,f);if(c){d=b("debounceAcrossTransitions")(function(){g.inform(b("AvailableListConstants").ON_AVAILABILITY_CHANGED,a),b("ChatDispatcher").dispatch({type:b("PresenceStatusActionTypes").AVAILABILITY_CHANGED,id:a})},0);d()}}function k(a){a=a.payload.availability||{};for(var b in a)j(b&&b.toString(),a[b].a,!0,"mercury_tabs",a[b].c)}function l(a){if(!a||a==="0"||h.test(a)){b("ChatReliabilityInstrumentation").logERROR("bad id for available list: "+a);return}new(b("AsyncRequest"))("/ajax/mercury/tabs_presence.php").setData({target_id:a}).setHandler(k).setErrorHandler(b("emptyFunction")).setAllowCrossPageTransition(!0).send()}function a(a,c){c.chat_config=b("ChatConfig").getDebugInfo(),c.available_list_debug_info={count:b("PresenceStatus").getOnlineIDs().length}}var m=undefined;try{m=new(b("ChatproxyPresence"))(function(event){g.inform(event)}),m.subscribe()}catch(a){b("FBLogger")("chat").catching(a).mustfix("Failed to subscribe to chat proxy presence"),b("ChatReliabilityInstrumentation").logERROR(a.getMessage())}Object.assign(g,{getChatproxyPresenceObject:function(){return m},get:function(a){return b("PresenceStatus").get(a)},updateForID:function(a){if(b("ChatConfig").get("presence_page_green_dot_sub")&&!b("FBIDCheck").isUser_deprecated(a))return;l(a);b("PresencePrivacy").getVisibility()==b("PresencePrivacy").ONLINE&&b("Run").onAfterLoad(function(){return b("Bootloader").loadModules(["ChannelManager","ChannelTransport"],function(b,c){b.startChannelManager(),c.sendAdditionalBuddyRequest(b.getCompleteConfig(),a)},"AvailableList")})},getWebChatNotification:function(){return m&&m.getWebChatNotification()},isReady:function(){return!!m},set:function(a,b,c,d){j(a,b,!0,c,d)}});b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,a);b("PresencePrivacy").subscribe(["privacy-changed","privacy-availability-changed","privacy-user-presence-response"],i);b("requireWeak")("ChannelConnection",function(a){return a.subscribe([a.CONNECTED,a.RECONNECTING,a.SHUTDOWN,a.MUTE_WARNING,a.UNMUTE_WARNING],i)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("buddylist_overlay"),function(a,c){a={};c=c.obj.overlay;for(var d in c)g.set(d,c[d].a,c[d].s||"channel",c[d].vc),c[d].la&&(a[d]=c[d].la);b("LastActiveTimes").update(a)});b("Arbiter").subscribe([b("ChannelConstants").getArbiterType("typ"),b("ChannelConstants").getArbiterType("ttyp")],function(a,c){__p&&__p();a=c.obj;if(a.st===b("TypingStates").TYPING){c=a.from;if(b("ChatVisibility").isOnline()){b("BanzaiODS").bumpEntityKey("presence","stale_presence_check_typing");a=b("PresenceStatus").get(c);if(a!=b("AvailableListConstants").ACTIVE){a=b("LastActiveTimes").get(c)*1e3;var d=b("ServerTime").get();if(!a)b("BanzaiODS").bumpEntityKey("presence","no_detailed_presence_typing");else if(d-a>5*60*1e3){var e="stale_presence_typing";d=d-a;d<10*60*1e3?e+="600":d<60*60*1e3&&(e+="3600");b("BanzaiODS").bumpEntityKey("presence",e)}}}g.set(c&&c.toString(),b("AvailableListConstants").ACTIVE,"channel-typing")}});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("messaging"),function(a,c){__p&&__p();if(!b("ChatVisibility").isOnline())return;a=c.obj;if(a.message&&a.message.timestamp&&a.message.sender_fbid){c=b("ServerTime").get();var d=a.message.timestamp;if(c-d<2*60*1e3){b("BanzaiODS").bumpEntityKey("presence","stale_presence_check");c=a.message.sender_fbid;a=b("PresenceStatus").get(c);if(a==b("AvailableListConstants").ACTIVE)return;a=b("LastActiveTimes").get(c)*1e3;if(!a)b("BanzaiODS").bumpEntityKey("presence","no_detailed_presence");else if(d-a>5*60*1e3){c="stale_presence";d=d-a;d<10*60*1e3?c+="600":d<60*60*1e3&&(c+="3600");b("BanzaiODS").bumpEntityKey("presence",c)}}}});e.exports=g}),null);
__d("ChatHovercard",["Arbiter","AsyncLoader","Bootloader","JSLogger","TimeSlice","debounce","emptyFunction","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();var g=5,h=new(b("AsyncLoader"))("/ajax/chat/hovercard/sidebar.php","hover"),i=b("JSLogger").create("chat_hovercard");b("Arbiter").subscribe("Hovercard/dirty",h.reset.bind(h));function j(a,c){var d=function(){h.get(a,c)};b("TimeSlice").guard(d,"superfluous request to first open DD",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()}function k(a,c){__p&&__p();if(!a)return;j(a,function(d){__p&&__p();b("setTimeoutAcrossTransitions")(function(){__p&&__p();if(!d){i.error("fetch_failure",{id:a});return}b("Bootloader").loadModules(["Hovercard"],function(b){b=b.getDialog(d);if(!b){i.error("no_hovercard",{id:a,endpoint:d});return}a==c.getActiveID()&&c.showHovercard(a,b)},"ChatHovercard")},0)})}function l(a,b){__p&&__p();var c=[];function d(b){b>=0&&b<a.length&&c.push(a[b])}b=a.indexOf(b);if(b>-1){d(b);for(var e=1;e<g;e++)d(b+e),d(b-e)}return c.filter(function(a){return a})}function m(a,c){c=c.getActiveID();if(c){a=a.getShowingUsers();a=l(a,c);j(a,b("emptyFunction"))}}function a(a){var c=a.getHoverController();c.registerDefault(k);c.subscribe("hover",b("debounce")(m.bind(null,a,c),100))}e.exports=a}),null);
__d("ChatOrderedListHover",["csx","ArbiterMixin","CSS","ErrorUtils","Event","LayerHideOnBlur","Parent","clearTimeout","mixin","setTimeoutAcrossTransitions","shield"],(function(a,b,c,d,e,f,g){__p&&__p();var h;function i(a){b("CSS").addClass(a,"fetching")}function j(a){b("CSS").removeClass(a,"fetching")}c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));h=c&&c.prototype;function a(a){"use strict";h.constructor.call(this),this._orderedList=a,this._root=a.getRoot(),b("Event").listen(this._root,"mouseover",this._mouseOver.bind(this)),b("Event").listen(this._root,"mouseleave",this._mouseLeave.bind(this)),a.subscribe("click",b("shield")(this._hide,this))}a.prototype._mouseOver=function(event){"use strict";if(this._paused)return;var a=event.getTarget();a=b("Parent").bySelector(a,"._42fz")||b("Parent").bySelector(a,"._5a58");a&&this._setActiveItem(a)};a.prototype._mouseLeave=function(event){"use strict";this._setActiveItem(null)};a.prototype._clearTimeouts=function(){"use strict";this._showTimeout&&b("clearTimeout")(this._showTimeout),this._showTimeout=null,this._hideTimeout&&b("clearTimeout")(this._hideTimeout),this._hideTimeout=null};a.prototype._hide=function(){"use strict";this._showingDialog&&(this._showingDialog.hide(),this._showingDialog=null,this._showingID=null)};a.prototype._show=function(){"use strict";var a=this.getActiveID(),c=!1;this._defaultHandler&&(c=!0,b("ErrorUtils").applyWithGuard(this._defaultHandler,{},[a,this]));c&&this._showingID!=this.getActiveID()&&i(this._activeItem)};a.prototype._setActiveItem=function(a){"use strict";__p&&__p();if(a!=this._activeItem){this._clearTimeouts();this._activeItem&&j(this._activeItem);if(a){this._activeItem=a;a=this._showingDialog?0:600;this._showTimeout=b("setTimeoutAcrossTransitions")(function(){return this._show()}.bind(this),a);this.inform("hover")}else this._activeItem=null,this._hideTimeout=b("setTimeoutAcrossTransitions")(function(){return this._hide()}.bind(this),10),this.inform("leave")}};a.prototype.registerDefault=function(a){"use strict";this._defaultHandler=a};a.prototype.getActiveID=function(){"use strict";var a=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return a||null};a.prototype.showHovercard=function(a,c){"use strict";__p&&__p();if(a==this.getActiveID()&&a!=this._showingID){this._clearTimeouts();j(this._activeItem);this._hide();this._showingDialog=c;this._showingID=a;var d=c.subscribe("mouseenter",this._setActiveItem.bind(this,this._activeItem)),e=c.subscribe("mouseleave",function(){d.unsubscribe(),this._setActiveItem(null)}.bind(this)),f=c.subscribe("hide",function(){this.inform("hovercard_hide"),d.unsubscribe(),e.unsubscribe(),f.unsubscribe()}.bind(this));c.enableBehavior(b("LayerHideOnBlur")).setContext(this._activeItem).setPosition("left").show();this.inform("hovercard_show")}};Object.assign(a.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});e.exports=a}),null);
__d("ChatOrderedList",["csx","Arbiter","ArbiterMixin","AvailableList","AvailableListConstants","ChatConfig","ChatHovercard","ChatOptions","ChatOrderedListHover","ChatSidebarConstants","ChatSidebarPreloadStore","ChatSidebarStore","ChatSidebarUserDetailsFactory","CSS","DataStore","DOM","Event","MercuryParticipantTypes","MessengerDivebarSizingTypedLogger","Parent","PresenceOrderedList","PresencePrivacy","React","ReactDOM","ShortProfilesStore","SidebarType","WorkChatSidebarUtils","WorkModeConfig","debounceAcrossTransitions","emptyFunction","gkx","mixin","onAfterDisplay"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));h=c&&c.prototype;function a(a,c,d,e,f){"use strict";__p&&__p();h.constructor.call(this),this._debouncedRender=b("emptyFunction"),this._render=function(){__p&&__p();if(!this._isVisible||this._isHovering){this._isHovering&&(this._skippedRenderDuringHover=!0);return}b("PresenceOrderedList").getSorted(this._numTopFriends,function(a){__p&&__p();var c=b("WorkModeConfig").is_work_user?b("PresenceOrderedList").getAllSorted(a.concat(this._nearby)).filter(function(a){a=b("ShortProfilesStore").getNow(a);return!a||a.type===b("MercuryParticipantTypes").FB4C}):b("PresenceOrderedList").getAvailableSorted(a.concat(this._nearby)),d=b("WorkModeConfig").is_work_user?b("PresenceOrderedList").getAllSorted(a.concat(this._nearby)).filter(function(a){a=b("ShortProfilesStore").getNow(a);return a&&a.type!==b("MercuryParticipantTypes").FB4C}):[];a=a.filter(function(a){return!this._nearby||this._nearby.indexOf(a)===-1}.bind(this));var e=b("PresencePrivacy").getVisibility()==b("PresencePrivacy").ONLINE?this._nearby.filter(function(a){return b("PresencePrivacy").allows(a)}):this._nearby,f=b("PresencePrivacy").getVisibility()==b("PresencePrivacy").ONLINE?a.filter(function(a){return b("PresencePrivacy").allows(a)}):a;a=b("PresencePrivacy").getOnlinePolicy()===b("PresencePrivacy").ONLINE_TO_WHITELIST&&b("PresencePrivacy").getVisibility()?a.filter(function(a){return!b("PresencePrivacy").allows(a)}):[];var g=b("ChatSidebarStore").isAfterDomLoad();g=b("ChatSidebarUserDetailsFactory").getUsersDetailedData([].concat(c,e,a,f,d),g);var h=this._orderedListComponent;b("ReactDOM").render(b("React").createElement(h,{adminedPages:this._adminedPages,availableUsers:c,groups:b("WorkChatSidebarUtils").computeGroups(this._groups,this._pinnedThreads),isAfterDomLoad:b("ChatSidebarStore").isAfterDomLoad(),isSidebar:this._isSidebar,isUserOffline:b("PresencePrivacy").isUserOffline(),marketplaceThreads:this._marketplaceThreads,maxItemSlots:this._maxItemSlots+1,nearby:e,offlineUsers:a,pageListModule:this._pageListModule,pinnedThreads:this._pinnedThreads,pymmList:this._pymmList,scrollContainer:this._scrollContainer,topUsers:b("WorkChatSidebarUtils").computeTopUsers(f,this._pinnedThreads),usersDetailedData:g,workOthers:d,showWorkWelcomeOverlay:this._showWorkWelcomeOverlay&&!this._typeAheadActive}),this._orderedList);this.inform("render")}.bind(this))}.bind(this),this._debouncedRender=b("debounceAcrossTransitions")(this._render,300),this._showWorkWelcomeOverlay=e,this._typeAheadActive=!1,this._root=c,this._isVisible=!1,this._excludedIds={},this._numTopFriends=5,this._adminedPages=[],this._marketplaceThreads=[],this._pageListModule=null,this._pymmList={config:null,pages:[]},this._pinnedThreads=[],this._groups=[],this._nearby=[],this._hoverController=null,this._isHovering=!1,this._skippedRenderDuringHover=!1,this._isSidebar=a,this._maxItemSlots=0,this._orderedListComponent=f,this._orderedList=b("DOM").find(this._root,".fbChatOrderedList"),b("Event").listen(this._orderedList,"mouseover",function(){this.isSidebar&&(this._isHovering=!0)}.bind(this)),b("Event").listen(this._orderedList,"mouseout",function(){this._isHovering=!1,this._skippedRenderDuringHover&&(this._skippedRenderDuringHover=!1,this._debouncedRender())}.bind(this)),this._scrollableOrderedList=b("Parent").byClass(this._root,"scrollableOrderedList"),this._scrollableArea=b("Parent").byClass(this._root,"scrollable"),a&&new(b("ChatHovercard"))(this),b("Arbiter").subscribe("jslogger/dump",function(a,c){this.getSortedList(function(a){c.chat_lists=c.chat_lists||{sorted_list:a,available_list:b("PresenceOrderedList").getAvailableSorted(),excluded_list:this._excludedIds}}.bind(this))}.bind(this)),b("Arbiter").subscribe("sidebar/typeahead/active",function(a,b){this._typeAheadActive=b,this._render()}.bind(this)),b("ShortProfilesStore").addListener(function(){return this._debouncedRender()}.bind(this)),b("ChatSidebarStore").addListener(function(){return this._debouncedRender()}.bind(this)),b("gkx")("AT6TwEfyE3S3vuj5vzRrcHEi-HcoHeZ6vee22bU63x8bdHsLirNM3h1OMH1kyUhz92T9lqrOtqys1ni5dEuGQ43h")?b("onAfterDisplay")(function(){b("PresencePrivacy").subscribe("privacy-user-presence-changed",function(){return this._debouncedRender()}.bind(this)),b("AvailableList").subscribe(b("AvailableListConstants").ON_AVAILABILITY_CHANGED,function(){return this._debouncedRender()}.bind(this))}.bind(this)):(b("PresencePrivacy").subscribe("privacy-user-presence-changed",function(){return this._debouncedRender()}.bind(this)),b("AvailableList").subscribe(b("AvailableListConstants").ON_AVAILABILITY_CHANGED,function(){return this._debouncedRender()}.bind(this))),b("gkx")("AT5JVN5EFvOcbWXNXUiIQC28fl62U3k8LyTO0MldrOTPd6YqonWZITDV1Qrdjg7AiaJCWdBrX6zjzI-YMWBZCxaH")&&b("WorkChatSidebarUtils").loadPinnedThreads(function(a){this._pinnedThreads=a,this._render()}.bind(this))}a.prototype.getShowingUsers=function(){"use strict";return b("DOM").scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode)};a.prototype.getUserForNode=function(a){"use strict";return b("DataStore").get(a,"id")||b("DataStore").get(a,"serverthreadid")};a.prototype.getHoverController=function(){"use strict";this._hoverController||(this._hoverController=new(b("ChatOrderedListHover"))(this));return this._hoverController};a.prototype.getItemHeight=function(){"use strict";return b("ChatSidebarConstants").getItemHeight()};a.prototype.getRoot=function(){"use strict";return this._root};a.prototype.getSortedList=function(a){"use strict";b("PresenceOrderedList").getSorted(this._numTopFriends,function(b){return a(b)})};a.prototype.hide=function(){"use strict";if(!this._isVisible)return;this._isVisible=!1;b("CSS").hide(this._scrollableOrderedList||this._root);this.inform("hide")};a.prototype.setNumTopFriends=function(a,c,d){"use strict";__p&&__p();b("ChatSidebarPreloadStore").onLoaded(function(e){__p&&__p();var f=e.groups,g=e.nearby,h=e.adminedPages,i=e.marketplaceThreads,j=e.pageListModule;e=e.pymmList;var k=new(b("MessengerDivebarSizingTypedLogger"))();k.setMaxItemSlots(a).setSidebarType(d);a--;b("ChatConfig").get("show_header")&&a--;var l=b("gkx")("AT6ezxCFIuDr3f155YU0cVompttkL6-4ye5A4xnJR5wWiQ5IOmLV0d94XM9VgwajF9248OtJTIz0cnvOn5PCMW2_"),m=!b("ChatOptions").getSetting("hide_businesses")&&e.pages;l&&m&&(a-=3);h=b("ChatOptions").getSetting("hide_admined_pages")?[]:h;l&&h.length&&(a-=h.length+1);l=b("gkx")("AT5JVWJbiBH_R11af3ugwEkygwtGA94cjWscD1h1CBO8Xf5mCWt4AowBueuL5iwANGzh4gbBCKAJiFrLkbGm9DbQ")&&!b("ChatOptions").getSetting("hide_marketplace")&&(i==null?void 0:i.length);l&&(this._marketplaceThreads=i,a-=3);this._maxItemSlots=a;l=a;i=b("ChatSidebarStore").getGroupsToShow(f||[])||[];f=m?e:{config:null,pages:[]};m=i.length;m===0&&b("gkx")("AT5TWxfoyJTuU3Tr-O8sY_Gkxvimm2rPLn9ZsAsusyJiAYq-zLKg2_7_eMccMJTI9qOx7gwISC6rrsGtqpWk_uDLins6TCNHhi73ZUmc4ebtyg")&&!b("ChatOptions").getSetting("hide_groups")&&m++;m>0&&(l-=m+1);b("ChatConfig").get("nearby_friends_www_chatbar")&&g.length>0&&(l-=g.length+1);b("ChatConfig").get("show_admined_pages")&&h.length>0&&(l-=h.length+1);b("ChatConfig").get("show_businesses")&&f.pages.length>0&&(l-=2);e=l;l=Math.min(a,Math.max(l,b("ChatConfig").get("min_top_friends")||0));if(l!==this._numTopFriends||i.length!==this._groups.length||g.length!==this._nearby.length||h.length!==this._adminedPages.length||f.pages.length!==this._pymmList.pages.length){this._groups=i;this._numTopFriends=l;this._nearby=g;this._adminedPages=h;this._pageListModule=j;this._pymmList=f;k.setNumTopFriends(l).setNumNearby(g.length).setNumGroups(i.length).setNumAdminedPages(h.length).setNumPymm(f.pages.length);m=0;d===b("SidebarType").BUDDYLIST&&h.length>0&&(m+=h.length+1,k.setNumAdminedPages(0));d===b("SidebarType").BUDDYLIST&&f.pages.length>0&&(k.setNumPymm(0),m+=2);e+=m;l>e&&(e+=1);k.setNumTopFriendsShown(Math.max(e,0));b("ChatSidebarStore").getVisibleType()===d&&k.log();c?(typeof this._debouncedRender.reset==="function"&&this._debouncedRender.reset(),this._render()):this._debouncedRender()}}.bind(this))};a.prototype.show=function(){"use strict";if(this._isVisible)return;this._isVisible=!0;b("CSS").show(this._scrollableOrderedList||this._root);this._render();this.inform("show")};a.prototype.isVisible=function(){"use strict";return this._isVisible};a.prototype.setScrollContainer=function(a){"use strict";b("DOM").contains(a,this._root)&&(this._scrollContainer=a)};e.exports=a}),null);
__d("ChatPerfTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:ChatPerfLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:ChatPerfLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:ChatPerfLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setDuration=function(a){this.$1.duration=a;return this};a.prototype.setEndpoint=function(a){this.$1.endpoint=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setTabsOpen=function(a){this.$1.tabs_open=a;return this};c={duration:!0,endpoint:!0,event:!0,tabs_open:!0};e.exports=a}),null);
__d("FantaConst",[],(function(a,b,c,d,e,f){"use strict";var g={DEFAULT_ALLOWED_RAISED_TABS:2,DEFAULT_MESSAGE_COUNT:10,cookieIDs:{PERSONAL_COOKIE_ID:"t3",PERSONAL_FOCUS_COOKIE_ID:"lm3",PERSONAL_TIME_COOKIE_ID:"utc3",WORK_COOKIE_ID:"t3w",WORK_FOCUS_COOKIE_ID:"lm3w",WORK_TIME_COOKIE_ID:"utc3w"},getCookieIDs:function(){return[g.cookieIDs.PERSONAL_COOKIE_ID,g.cookieIDs.PERSONAL_FOCUS_COOKIE_ID,g.cookieIDs.PERSONAL_TIME_COOKIE_ID,g.cookieIDs.WORK_COOKIE_ID,g.cookieIDs.WORK_FOCUS_COOKIE_ID,g.cookieIDs.WORK_TIME_COOKIE_ID]}};e.exports=g}),null);
__d("Dcode",[],(function(a,b,c,d,e,f){__p&&__p();var g,h={},i={_:"%",A:"%2",B:"000",C:"%7d",D:"%7b%22",E:"%2c%22",F:"%22%3a",G:"%2c%22ut%22%3a1",H:"%2c%22bls%22%3a",I:"%2c%22n%22%3a%22%",J:"%22%3a%7b%22i%22%3a0%7d",K:"%2c%22pt%22%3a0%2c%22vis%22%3a",L:"%2c%22ch%22%3a%7b%22h%22%3a%22",M:"%7b%22v%22%3a2%2c%22time%22%3a1",N:".channel%22%2c%22sub%22%3a%5b",O:"%2c%22sb%22%3a1%2c%22t%22%3a%5b",P:"%2c%22ud%22%3a100%2c%22lc%22%3a0",Q:"%5d%2c%22f%22%3anull%2c%22uct%22%3a",R:".channel%22%2c%22sub%22%3a%5b1%5d",S:"%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a",T:"%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a",U:"%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a",V:"%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a",W:"%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a",X:"%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1",Y:"%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a",Z:"%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a"};(function(){var a=[];for(var b in i)h[i[b]]=b,a.push(i[b]);a.reverse();g=new RegExp(a.join("|"),"g")})();a={encode:function(a){return encodeURIComponent(a).replace(/([_A-Z])|%../g,function(a,b){return b?"%"+b.charCodeAt(0).toString(16):a}).toLowerCase().replace(g,function(a){return h[a]})},decode:function(a){return decodeURIComponent(a.replace(/[_A-Z]/g,function(a){return i[a]}))}};e.exports=a}),null);
__d("PresenceCookieManager",["Cookie","CurrentUser","Dcode","ErrorUtils","JSLogger","PresenceInitialData","PresenceUtil","WebStorage","WorkModeConfig"],(function(a,b,c,d,e,f){__p&&__p();var g=b("PresenceInitialData").cookieVersion,h="presence",i={},j=null,k=null,l=b("JSLogger").create("presence_cookie");function m(a){var c=b("Cookie").get(h)||"";if(c.length===0)return null;return c[0]!==a?null:c.substring(1)}function n(a,c){b("Cookie").set(h,a+c)}function o(){return!(b("PresenceInitialData").useWebStorage||!1)?null:b("WebStorage").getSessionStorage()}function p(){var a=o();a=a!=null?a.getItem(h):null;return a!=null?a.substring(1):null}function q(a){var b=o();if(b==null)return!1;b.setItem(h,"E"+a);return!0}function r(){var a=p();return a!=null?a:m("E")}function s(a){__p&&__p();a=a.state;if(a==null)return"";var c=m("S")||"",d=b("WorkModeConfig").is_work_user?"w":"f";a=b("WorkModeConfig").is_work_user?a.t3w:a.t3;a=a!=null?a.length>0:!1;var e=c.indexOf(d)!==-1;e&&!a&&(c=c.replace(d,""));!e&&a&&(c+=d);return c}function t(a,b){var c=q(a);c?n("S",b):(a.length>1024&&l.warn("big_cookie",a.length),n("E",a))}function u(){__p&&__p();try{var a=r();j!==a&&(j=a,k=null,a&&(a=b("Dcode").decode(a),k=JSON.parse(a)));if(k){if(k.user&&k.user!==b("CurrentUser").getID())return null;return k.v!==g?null:k}}catch(a){l.warn("getcookie_error",a)}return null}function v(){return{v:g,time:w(),user:b("CurrentUser").getID()}}function w(){return parseInt(Date.now()/1e3,10)}function x(a){var c=b("Dcode").encode(JSON.stringify(a));b("PresenceUtil").hasUserCookie()&&t(c,s(a))}var y={register:function(a,b){i[a]=b},store:function(){__p&&__p();var a=u();if(a&&a.v&&g<a.v){l.debug("stale_cookie",g);return}var c=v();for(var d in i)c[d]=b("ErrorUtils").applyWithGuard(i[d],i,[a&&a[d]],function(a){a.presence_subcookie=d});x(c)},clear:function(){var a=y.getSubCookie("state");b("Cookie").clear(h);var c=b("WebStorage").getSessionStorage();c!=null&&c.removeItem(h);if(a){c=v();c.state=a;x(c)}},getSubCookie:function(a){var b=u();return!b?null:b[a]}};e.exports=y}),null);
__d("PresenceState",["Arbiter","ErrorUtils","FantaConst","JSLogger","PresenceCookieManager","PresenceInitialData","debounceAcrossTransitions","setIntervalAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("PresenceInitialData").cookiePollInterval||2e3,h=b("PresenceInitialData").shouldSuppress||!1,i=[],j=[],k=null,l=null,m=0,n=null,o=0,p=["sb2","tr","tw","at","wml"].concat(b("FantaConst").getCookieIDs()),q=b("JSLogger").create("presence_state");function r(){return b("PresenceCookieManager").getSubCookie("state")}function s(){m=Date.now(),b("PresenceCookieManager").store(),w(l)}var t=b("debounceAcrossTransitions")(s,0);function u(a){(a==undefined||isNaN(a)||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)&&(a=0);return a}function v(a){var c={};a&&(p.forEach(function(b){a&&a[b]&&(c[b]=a[b])}),m<a.ut&&q.error("new_cookie",{cookie_time:a.ut,local_time:m}));c.ut=m;for(var d=0,e=i.length;d<e;d++)b("ErrorUtils").applyWithGuard(i[d],null,[c]);l=c;return l}function w(a){o++;m=u(a&&a.ut);k||(k=b("setIntervalAcrossTransitions")(z,g));l=a;n===null&&(n=a);for(var c=0,d=j.length;c<d;c++)b("ErrorUtils").applyWithGuard(j[c],null,[a]);o--}function x(a){if(a&&a.ut)if(m<a.ut)return!0;else a.ut<m&&q.error("old_cookie",{cookie_time:a.ut,local_time:m});return!1}function y(){var a=r();x(a)&&(l=a);return l}function z(){var a=r();x(a)&&w(a)}b("PresenceCookieManager").register("state",v);b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.presence_state={initial:babelHelpers["extends"]({},n),state:babelHelpers["extends"]({},l),update_time:m,sync_paused:o,poll_time:g}});(function(){var a=y();if(a)w(a);else{q.debug("no_cookie_initial");w(v());return}})();a={doSync:function(a){if(o)return;a?s():t()},registerStateStorer:function(a){i.push(a)},registerStateLoader:function(a){j.push(a)},get:function(){return y()},getInitial:function(){return n},shouldSuppress:function(){return h},verifyNumber:u};e.exports=a}),null);
__d("ChatPerfInstrumentation",["Promise","BaseEventEmitter","ChatPerfEvent","ChatPerfTypedLogger","FantaConst","PresenceState","WorkModeConfig","emptyFunction","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("WorkModeConfig").is_work_user;c=a?b("FantaConst").cookieIDs.WORK_COOKIE_ID:b("FantaConst").cookieIDs.PERSONAL_COOKIE_ID;d=b("PresenceState").getInitial();var g=d&&d[c]?d[c].length:0,h;f={_startTime:Number,_sidebarStartTime:Number,init:function(){this._startTime=b("performanceAbsoluteNow")();return new(b("Promise"))(function(a){return a()})},initDivebar:function(){this._sidebarStartTime=b("performanceAbsoluteNow")()},_log:function(event,a){a=b("performanceAbsoluteNow")()-(a||this._startTime);h&&h.emit(event,a);var c=new(b("ChatPerfTypedLogger"))();c.setEvent(event).setDuration(a);c.setTabsOpen(g);c.log()},addPerfTimingsListener:function(event,a){h||(h=new(b("BaseEventEmitter"))());return h.once(event,a)},logInitStores:function(){this.logInitStores=b("emptyFunction"),this._log(b("ChatPerfEvent").CHAT_INIT_STORES)},logInitData:function(){this.logInitData=b("emptyFunction"),this._log(b("ChatPerfEvent").CHAT_INIT_DATA)},logInitUI:function(){this.logInitUI=b("emptyFunction"),this._log(b("ChatPerfEvent").CHAT_INIT_UI)},logInitSound:function(){this.logInitSound=b("emptyFunction"),this._log(b("ChatPerfEvent").CHAT_INIT_SOUND)},logDisplayDone:function(){this.logDisplayDone=b("emptyFunction"),this._log(b("ChatPerfEvent").CHAT_DISPLAY_DONE)},logTTI:function(){this.logTTI=b("emptyFunction"),this._log(b("ChatPerfEvent").TTI)},logCHAT_CONVERSATION_TTI:function(){this.logCHAT_CONVERSATION_TTI=b("emptyFunction"),this._log(b("ChatPerfEvent").CHAT_CONVERSATION_TTI)},logSIDEBAR_FROM_CLIENT_TTI:function(){this.logSIDEBAR_FROM_CLIENT_TTI=b("emptyFunction"),this._log(b("ChatPerfEvent").SIDEBAR_FROM_CLIENT_TTI,this._sidebarStartTime)},logSIDEBAR_DISPLAY_DONE:function(){this.logSIDEBAR_DISPLAY_DONE=b("emptyFunction"),this._log(b("ChatPerfEvent").SIDEBAR_DISPLAY_DONE,this._sidebarStartTime)}};e.exports=f}),null);
__d("ChatSidebar",["csx","Arbiter","AsyncRequest","Bootloader","ChatConfig","ChatDispatcher","ChatPerfInstrumentation","ChatSidebarActions","ChatSidebarBotsDispatcher","ChatSidebarBotsStore","ChatSidebarCachedViewport","ChatSidebarPresencePrivacyStore","ChatSidebarStore","ChatSidebarVisibility","CSS","CurrentUser","DOM","DOMDimensions","Event","LitestandClassicPlaceHolders","Parent","PresencePrivacy","PresenceUtil","SidebarAppsInitialVisibility","SidebarType","SidebarWorkTopGroupsVisibility","Style","TimeSlice","URI","ViewportBounds","WWWSiteOrganizationGating","emptyFunction","ge","gkx","ifRequired","onAfterDisplay","onAfterLoadSafe","queryThenMutateDOM","requireWeak"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("ChatSidebarBotsDispatcher").module,i=b("ChatSidebarBotsStore").module,j,k,l,m,n,o,p=!0,q=b("ChatSidebarCachedViewport").viewport;a=b("WWWSiteOrganizationGating").largerBlueBar;var r=a?49:44,s=117,t=40,u=32,v=44,w=30,x=171,y=b("ChatConfig").get("expanded_divebar_width"),z=b("ChatConfig").get("sidebar.hide_buddylist_off_homepage");function A(){return b("ChatSidebarStore").getVisibleType()===b("SidebarType").SIDEBAR}function B(a,b){if(!A())return;b?m.hide():(m.show(),F())}function C(){return!A()||!l?0:y}function D(){b("CSS").removeClass(document.documentElement,"sidebarMode"),z&&new(b("URI"))(window.location.href).getPath()!=="/"&&b("CSS").addClass(document.documentElement,"buddylistOff"),b("ChatSidebarStore").isInitialized()&&(m.hide(),b("CSS").hide(l),b("CSS").hide(k)),b("Arbiter").inform("sidebar/visibility",!1,"state"),b("Arbiter").inform("reflow"),b("ViewportBounds").inform("change")}function E(a){F(a,O._cacheViewport)}function F(a,c){var d;b("queryThenMutateDOM")(function(){c&&c(),(!a||a.height!==q.height)&&(d=K())},function(){(a==null||a.width!==q.width)&&b("ChatSidebarVisibility").shouldShowSidebar(q,function(a,c){b("ChatSidebarActions").show(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)}),L(d)})}function G(){b("ChatSidebarVisibility").shouldShowSidebar(q,function(a,c){b("ChatSidebarActions").show(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)}),L(K())}function H(a){b("Bootloader").loadModules(["KeyboardShortcuts"],function(c){c.register("q",function(event){if(b("ChatSidebarStore").getVisibleType()!==b("SidebarType").SIDEBAR)return;b("requireWeak")("ChatTypeaheadCore",function(b){b.focusSearchField(a,event)})},{persistOnTransition:!0})},"ChatSidebar")}function I(a){var c=q||b("ChatSidebarVisibility").getViewport(),d=c.height;a&&a.length?(a.forEach(function(a){a&&a!==j&&!b("CSS").hasClass(a,"hidden_elem")&&(d-=b("DOMDimensions").getElementDimensions(a).height)}),o&&(d-=o.getOffset()),n&&(d-=b("DOMDimensions").getElementDimensions(n).height)):(b("ifRequired")("AppsDivebarDisplayController",function(a){a.isVisible()&&(d-=x)},function(){b("SidebarAppsInitialVisibility").visible&&(d-=x)}),b("CurrentUser").isWorkUser()&&(i&&i.hasBots()&&(d-=s),b("SidebarWorkTopGroupsVisibility").visible&&(d-=t*b("SidebarWorkTopGroupsVisibility").numGroups+u),b("gkx")("AT5IvuE7ZC3UHqOIrperWBqnPRJB-4i3O1lK6UHKCeB2Qv_h-q8tQBe-hbIcjbrwQQAUFvheEGQ08bmOBzC0UNM8sHBTeZ77GLtxYXgmBgZI0g")&&(d-=v)),d-=r,d-=w);return Math.max(0,d)}function J(){b("CSS").show(k),b("CSS").show(l),b("CSS").addClass(document.documentElement,"sidebarMode"),b("CSS").removeClass(document.documentElement,"buddylistOff"),m.show(),b("Arbiter").inform("sidebar/visibility",!0,"state"),b("LitestandClassicPlaceHolders").destroy("sidebar"),b("ViewportBounds").inform("change")}function K(){return{body:O.getBodyHeight(),item:m.getItemHeight()}}function L(a){if(!a)return;var c=8,d=Math.floor((a.body-c)/a.item);m.setNumTopFriends(d,p,b("SidebarType").SIDEBAR);p=!1;d=Math.floor(a.body-c);b("Style").set(j,"height",a.body+"px");b("Arbiter").inform("sidebar/resized",d,"state");b("Arbiter").inform("reflow")}function M(){var a;b("queryThenMutateDOM")(function(){a=K()},function(){return L(a)})}function N(){new(b("AsyncRequest"))("/ajax/chat/settings.php").setHandler(b("emptyFunction")).setErrorHandler(b("emptyFunction")).setData({sidebar_mode:b("ChatSidebarStore").isEnabled(),window_id:b("PresenceUtil").getSessionID()}).setAllowCrossPageTransition(!0).send()}var O={init:function(a,c){__p&&__p();O.init=b("emptyFunction"),b("ChatPerfInstrumentation").initDivebar(),b("ChatDispatcher").explicitlyRegisterStore(b("ChatSidebarStore")),b("ChatDispatcher").explicitlyRegisterStore(b("ChatSidebarPresencePrivacyStore")),h&&i&&h.explicitlyRegisterStore(i),b("ChatSidebarActions").loaded(),l=a,m=c,j=b("DOM").find(a,"div.fbChatSidebarBody"),k=b("DOM").find(a,"._51x_"),n=b("DOM").find(a,"._5qqe"),b("Event").listen(window,"resize",function(){var a=babelHelpers["extends"]({},q)||{};E(a)}),b("Arbiter").subscribe("page_transition",function(a,c){b("ChatSidebarVisibility").shouldShowSidebar(q,function(a,d){d=document.documentElement||"";z&&c.uri.getPath()!=="/"?b("CSS").addClass(d,"buddylistOff"):b("CSS").removeClass(d,"buddylistOff");b("ChatSidebarActions").show(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)},c.uri)}),b("gkx")("AT6ZCntuwGBL1LBDjniJnuZTki0EgqKZ16N0_aKYu1tUnleN5fWyObM-HMcM9_e2aftsyQ6i7hVPvvzxMu5Zazav")?b("onAfterDisplay")(function(){H(a)}):H(a),m.setScrollContainer(b("Parent").byClass(m.getRoot(),"uiScrollableAreaWrap")),b("Arbiter").subscribe("chat/option-changed",function(a,b){a=b.name;(a==="hide_groups"||a==="hide_admined_pages"||a==="hide_businesses")&&M()}),b("Arbiter").subscribe(["AppsDivebar/show-apps","AppsDivebar/hide-apps","PagesDivebar/show-pages","PagesDivebar/hide-pages"],M),b("Arbiter").subscribe("sidebar/typeahead/active",B),b("PresencePrivacy").subscribe("privacy-user-presence-changed",function(){F(),b("ChatSidebarActions").userPresenceChanged()}),b("PresencePrivacy").subscribe("privacy-changed",function(){F(),b("ChatSidebarActions").privacyChanged()}),b("ChatSidebarStore").addListener(function(){var a=b("ChatSidebarStore").getState(),c=b("ChatSidebarStore").getPrevState();if(a.visible!==c.visible)switch(a.visible){case b("SidebarType").SIDEBAR:J();break;case b("SidebarType").BUDDYLIST:D();break}a.enabled!==c.enabled&&N()}),i&&i.addListener(function(){return M()}),b("gkx")("AT4xuZ6KicTRHJ7-VVo2al5OuIgAH2UnbvppZwmWOFgaXXw1Df_vJXJR_TJQJ8YKN1RjtB4EWptwOe1mw8W6tT1FjYsXDZ_wxr3ljwpzw17dng")?(G(),b("onAfterLoadSafe")(function(){if(q.needsRefresh){var a=b("ChatSidebarStore").getState().visible===b("SidebarType").SIDEBAR;E();b("onAfterLoadSafe")(function(){a!==(b("ChatSidebarStore").getState().visible===b("SidebarType").SIDEBAR)&&b("Bootloader").loadModules(["ChatReliabilityInstrumentation"],function(a){a.logERROR("sidebar flashed")},"ChatSidebar")})}})):E(),b("onAfterLoadSafe")(function(){b("Bootloader").loadModules(["ChatImpressionLogger"],function(a){a.init(m)},"ChatSidebar")}),b("ViewportBounds").addPersistentRight(C),b("Arbiter").inform("sidebar/initialized",O,"state"),b("ChatSidebarActions").init(),b("ChatPerfInstrumentation").logSIDEBAR_DISPLAY_DONE()},ensureLoaded:function(){__p&&__p();if(!b("ChatSidebarStore").isEnabled())return;if(b("ChatSidebarStore").isLoaded())return;if(b("ge")("pagelet_sidebar"))return;b("Bootloader").loadModules(["UIPagelet"],function(a){var c=b("DOM").create("div",{id:"pagelet_sidebar"});b("DOM").appendContent(document.body,c);a.loadFromEndpoint("SidebarPagelet","pagelet_sidebar")},"ChatSidebar");b("ChatSidebarActions").loaded()},hide:function(){if(!b("ChatSidebarStore").isEnabled())return;b("ChatSidebarActions").disable()},unhide:function(){if(b("ChatSidebarStore").isEnabled())return;b("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(a,c){b("ChatSidebarActions").enable(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)})},_cacheViewport:function(){q=b("ChatSidebarVisibility").getViewport()},getBodyHeight:function(){return b("gkx")("AT6ezxCFIuDr3f155YU0cVompttkL6-4ye5A4xnJR5wWiQ5IOmLV0d94XM9VgwajF9248OtJTIz0cnvOn5PCMW2_")?I():I(Array.from(k.childNodes))}};O.init=b("TimeSlice").guard(O.init,"ChatSidebar init");e.exports=O}),null);