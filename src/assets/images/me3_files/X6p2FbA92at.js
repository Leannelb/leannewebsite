if (self.CavalryLogger) { CavalryLogger.start_js(["parr8"]); }

__d("VideoPlayerWebVttSubtitleStream",["BlobFactory","DOM","Event","SubRipText","XHRRequest","getCrossOriginTransport","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("Event").EventHandlerRef;var g=a.URL||a.webkitURL;function c(a,c){this.$2=b("emptyFunction"),this.$3={},this.$4=b("emptyFunction"),this.$5={},this.$6=[],this.$12=function(){var a=this.$1.textTracks[0].activeCues;a&&a.length&&a[0].text?this.$2([a[0].text]):this.$2([])}.bind(this),this.$1=a,this.$7(c)}c.prototype.setSubtitleUpdatedHandler=function(a){this.$2=a;return this};c.prototype.setSubtitleReadyHandler=function(a){this.$4=a;return this};c.prototype.setSubtitlesStyleLeftAlignmentUpdatedHandler=function(a){return this};c.prototype.remove=function(){this.$6.forEach(function(a){return a.remove()}),this.$6=[]};c.prototype.$7=function(a){if(a in this.$3){this.$8(this.$3[a]);return}if(!g||!b("BlobFactory").isSupported())return;new(b("XHRRequest"))(a).setTransportBuilder(b("getCrossOriginTransport")).setMethod("GET").setResponseHandler(function(b){this.$3[a]=this.$9(b),this.$8(this.$3[a])}.bind(this)).send()};c.prototype.$10=function(){Array.prototype.forEach.call(this.$1.textTracks,function(a){return a.mode="hidden"})};c.prototype.$8=function(a){var c=b("DOM").create("track",{kind:"captions",src:a});b("Event").listen(c,"load",function(){this.$4()}.bind(this));b("DOM").appendContent(this.$1,c);this.$10();this.$6.push(b("Event").listen(this.$1,"timeupdate",function(){this.$13(a)}.bind(this)))};c.prototype.$11=function(a){return a.oncuechange!==undefined};c.prototype.$9=function(a){a=new(b("SubRipText"))(a);var c=b("BlobFactory").getBlob([a.renderVTT()],{type:"text/vtt"});c=g.createObjectURL(c);this.$5[c]=a;return c};c.prototype.$13=function(a){var b=this.$1.currentTime;this.$2(this.$5[a].getSubtitles(b))};e.exports=c}),null);